# パフォーマンス最適化 進捗状況とTODOリスト
performance_optimization:
  title: パフォーマンス最適化
  completed_items:
    - description: "- [x] PPTXパーサーの最適化"
      subtasks:
        - description: "- [x] キャッシュ機能の実装"
          subtasks:
            - description: "- [x] ファイルハッシュベースのキャッシュ"
            - description: "- [x] ハードリンクによるディスク使用量の最適化"
        - description: "- [x] LibreOffice変換の最適化"
          subtasks:
            - description: "- [x] 最適化されたPDF出力オプション"
            - description: "- [x] 環境変数の適切な設定"
        - description: "- [x] PDF→PNG変換の最適化"
          subtasks:
            - description: "- [x] 並列処理の導入"
            - description: "- [x] 出力フォーマットとDPIの最適化"
        - description: "- [x] パース処理の最適化"
          subtasks:
            - description: "- [x] 不要な中間ファイルの削除"
            - description: "- [x] エラーハンドリングの改善"
    - description: "- [x] ベンチマークスクリプトの基本実装"
      subtasks:
        - description: "- [x] 処理時間計測機能"
        - description: "- [x] ファイルサイズ情報収集"
        - description: "- [x] エラーケーステストの基本機能"
    - description: "- [x] ベンチマークテスト"
      subtasks:
        - description: "- [x] テストデータの準備"
          subtasks:
            - description: "- [x] 小規模PPTX（1-5スライド）"
            - description: "- [x] 中規模PPTX（10-20スライド）"
            - description: "- [x] 大規模PPTX（50+スライド）"
            - description: "- [x] 画像重視PPTX"
            - description: "- [x] テキスト重視PPTX"
        - description: "- [x] パフォーマンス計測の拡張"
          subtasks:
            - description: "- [x] 処理時間の計測"
            - description: "- [x] メモリ使用量の計測（psutilを使用）"
            - description: "- [x] CPU使用率の計測（psutilを使用）"
            - description: "- [x] ディスクI/Oの計測（psutilを使用）"
    - description: "- [x] エラーケーステスト"
      subtasks:
        - description: "- [x] 異常なPPTXファイルの処理"
          subtasks:
            - description: "- [x] 破損したPPTXファイル"
            - description: "- [x] 不正なフォーマット"
            - description: "- [x] 巨大なファイル"
        - description: "- [x] ネットワーク関連"
          subtasks:
            - description: "- [x] 遅延時の挙動確認"
            - description: "- [x] タイムアウト処理"
        - description: "- [x] リソース制限"
          subtasks:
            - description: "- [x] メモリ制限時の挙動"
            - description: "- [x] ディスク容量制限時の挙動"
            - description: "- [x] CPU負荷時の挙動"
    - description: "- [x] ドキュメント更新"
      subtasks:
        - description: "- [x] 機能ドキュメント"
        - description: "- [x] 運用ドキュメント"
        - description: "- [x] トラブルシューティング"
    - description: "- [x] 追加の最適化（必要に応じて）"
      subtasks:
        - description: "- [x] キャッシュ戦略の改善"
        - description: "- [x] 並列処理の最適化"
        - description: "- [x] メモリ使用量の最適化"
        - description: "- [x] エラーハンドリングの強化"
    - description: "- [x] テスト実行と検証"
      subtasks:
        - description: "- [x] エラーケーステストの実行"
        - description: "- [x] 統合テストの実行"
        - description: "- [x] 負荷テスト"
  ongoing_tasks: # feature/performance-optimizationブランチと重複する可能性のある項目
    - description: "- [ ] PPTXパーサーの最適化（継続）"
      priority: high
    - description: "- [ ] スライドAPIの改善"
      priority: high
    - description: "- [ ] クエリパラメータによるサーバーサイドフィルタリング"
      priority: medium
    - description: "- [ ] PPTXファイル処理の速度・メモリ効率改善（API/フロント）" # 「今後のタスク」から移動
      priority: highest

# PPT翻訳アプリケーション タスクリスト
application_tasks:
  title: PPT翻訳アプリケーション タスクリスト
  completed_features:
    - description: "- [x] Python実装とDockerによるVercelデプロイ計画"
    - description: "- [x] 設定ファイルのCommonJS形式への統一と各種調整"
    - description: "- [x] APIとUIの改善"
      subtasks:
        - description: "- [x] APIルーティングのビルド状況ログ確認"
        - description: "- [x] API競合解消のためのRoute Handler移行"
        - description: "- [x] バッチワーカーのTSX統一（React Inkを使用したTUIツール）"
        - description: "- [x] formidable型定義の整備"
        - description: "- [x] UI・パフォーマンス改善（LazyImage, useQueryCache, フォントマッピングとテキストレイアウト調整）"
        - description: "- [x] フォントマッピングユーティリティ作成"
        - description: "- [x] テキストレイアウト調整ヘルパー関数"
    - description: "- [x] モジュール形式の問題解決 (ESM/CommonJS混在解消)"
    - description: "- [x] 翻訳履歴機能の拡張"
      subtasks:
        - description: "- [x] Prismaスキーマ修正・マイグレーション"
        - description: "- [x] /api/history API拡張"
        - description: "- [x] /api/history/[id] 詳細API新規作成"
        - description: "- [x] 履歴一覧UIの改善"
        - description: "- [x] 詳細表示機能の追加"
        - description: "- [x] フィルタリング・ソート機能の実装"
    - description: "- [x] テスト関連 (初期実装完了分)"
      subtasks:
        - description: "- [x] 認証テストの実装"
        - description: "- [x] テストデータの準備 (初期)"
        - description: "- [x] テスト環境の安定化 (初期)"
        - description: "- [x] UI要素の識別子追加 (初期)"
        - description: "- [x] 段階的テスト実装 (初期)"
        - description: "- [x] テスト実行環境の改善 (初期)"
        - description: "- [x] UIコンポーネントのユニットテスト追加 (Dialog, Textarea, Separator, Skeleton)"
        - description: "- [x] ユーティリティ関数のテスト追加 (activity-logger, file-utils)"
        - description: "- [x] API関連テスト追加 (history API)"
        - description: "- [x] フックテスト追加 (useApi, useIntersectionObserver)"
    - description: "- [x] ファイルアップロード機能 (基本)"
      subtasks:
        - description: "- [x] ドラッグ＆ドロップサポート"
        - description: "- [x] ファイル形式バリデーション"
        - description: "- [x] ファイルサイズ制限"
        - description: "- [x] アップロード進捗表示"
        - description: "- [x] エラーハンドリング"
    - description: "- [x] PPTXファイル処理エラー修正 (初期)"
      subtasks:
        - description: "- [x] クライアントとサーバー間のリクエストデータの不一致修正"

  # MVPに直結する機能と、それを支える基盤
  mvp_and_core_infrastructure:
    - description: "- [ ] 翻訳テキストの位置ずれ修正（fix/text-position-alignmentブランチ）"
      priority: highest
      subtasks:
        - description: "- [ ] PPTX生成時のテキストボックス位置・サイズ・フォント・autofit等の再計算・調整"
        - description: "- [ ] PPTXジェネレーターの修正"
    - description: "- [ ] バッチ翻訳機能の実装"
      priority: high # MVP後だが重要
      subtasks:
        - description: "- [ ] 複数ファイルの一括アップロード"
        - description: "- [ ] バックグラウンド処理の実装"
        - description: "- [ ] 進捗状況の表示"

  # テストとCI/CD (品質と開発効率の担保)
  testing_and_cicd:
    title: テストとCI/CD
    # feature/test-coverage-improvementブランチ より
    - description: "- [ ] テストカバレッジ向上" # この項目自体は抽象的なので未完了扱いでよいか確認
      priority: high
      subtasks:
        - description: "- [x] SWCの設定最適化 (TypeScript, デコレータ, ダイナミックインポート, ソースマップ)"
        - description: "- [x] Jestの設定改善 (モジュールマッピング, カバレッジレポート, タイムアウト)"
        - description: "- [x] テスト実行スクリプトの整備 (カバレッジレポート生成, CI/CD用コマンド)"
    # テストインフラストラクチャの改善 (優先度：最高)
    - description: "- [ ] テストデータ管理の整備" # この項目自体は抽象的なので未完了扱いでよいか確認
      priority: highest
      subtasks:
        - description: "- [x] テストデータファクトリーの実装"
          subtasks:
            - description: "- [x] ユーザーデータファクトリー"
            - description: "- [x] 翻訳履歴データファクトリー"
            - description: "- [x] クレジットログファクトリー"
            - description: "- [x] アクティビティログファクトリー"
        - description: "- [x] テスト用DBセットアップの自動化"
          subtasks:
            - description: "- [x] マイグレーションスクリプトの最適化"
            - description: "- [x] シードデータの自動投入"
            - description: "- [x] テスト後のクリーンアップ処理"
        - description: "- [x] モックデータの整備"
          subtasks:
            - description: "- [x] PPTXファイルのモックデータ"
            - description: "- [x] APIレスポンスのモックデータ"
            - description: "- [x] 外部サービス連携のモックデータ"
    - description: "- [ ] ファクトリーを使用したテストケースの実装"
      priority: high
      subtasks:
        - description: "- [ ] ユーザー管理APIテスト (作成, 更新, 削除)"
        - description: "- [ ] 翻訳履歴APIテスト (作成, 一覧取得, 詳細取得) - 一部完了、拡充"
        - description: "- [ ] クレジット管理APIテスト (付与, 消費, 履歴)"
        - description: "- [ ] アクティビティログAPIテスト (記録, 取得, フィルタリング)"
    - description: "- [ ] CI/CD統合と環境整備" # この項目自体は抽象的なので未完了扱いでよいか確認
      priority: highest
      subtasks:
        - description: "- [x] テスト実行環境の整備 (Jest, Cypress設定最適化, レポート生成)"
        - description: "- [x] テストスクリプトの整備 (ユニット, E2E, カバレッジコマンド)"
        - description: "- [ ] GitHub Actionsワークフロー設定（進行中）"
          subtasks:
            - description: "- [x] プレビューデプロイの自動化 (Vercel CLI, PRコメント, Slack通知)"
            - description: "- [ ] テスト自動化の実装"
              priority: highest
              subtasks:
                - description: "- [ ] ユニットテストワークフロー (Jest実行, カバレッジ, 結果コメント, バッジ)"
                - description: "- [ ] E2Eテストワークフロー (Cypress環境, 実行タイミング, 結果保存, デバッグ情報)"
            - description: "- [ ] コード品質チェックの導入"
              priority: high
              subtasks:
                - description: "- [ ] ESLint実行設定 (カスタムルール, 自動修正, PRコメント)"
                - description: "- [ ] Prettier実行設定 (フォーマット統一, 自動フォーマット)"
                - description: "- [ ] TypeScript型チェック (厳格化, エラー報告)"
                - description: "- [ ] パフォーマンスチェック (バンドルサイズ, メトリクス計測, 閾値監視)"
            - description: "- [ ] ステージング環境の設定準備"
              priority: high
              subtasks:
                - description: "- [ ] Vercel Stagingプロジェクト作成 (設定複製, 環境変数, ドメイン)"
                - description: "- [ ] デプロイメントワークフロー (mainマージ時自動デプロイ, 検証, ヘルスチェック)"
                - description: "- [ ] データベース環境の準備 (ステージングDB, マイグレーション, テストデータ)"
                - description: "- [ ] モニタリングの設定 (ログ収集, アラート, ダッシュボード)"
        - description: "- [ ] テストデータベース環境の構築 (PostgreSQLコンテナ, 環境変数, マイグレーション自動実行)"
          priority: high
        - description: "- [ ] テスト実行の最適化 (並列実行, キャッシュ活用, 時間短縮)"
          priority: high
    - description: "- [ ] テストコードの品質向上"
      priority: medium
      subtasks:
        - description: "- [ ] テストコードのリファクタリング"
        - description: "- [ ] 共通処理のユーティリティ関数化"
        - description: "- [ ] テストケースのドキュメント化"
        - description: "- [ ] テストコードのレビュープロセス確立"
    - description: "- [ ] テストケースの拡充"
      priority: medium
      subtasks:
        - description: "- [ ] プロフィール編集機能のテスト"
        - description: "- [ ] 設定変更機能のテスト"
        - description: "- [ ] エラー状態のテスト"
        - description: "- [ ] 境界値テスト"
        - description: "- [ ] パフォーマンステスト (アプリケーションレベル)"

  # その他の機能拡張
  additional_features:
    title: その他の機能拡張
    - description: "- [ ] API連携機能の実装"
      priority: medium
      subtasks:
        - description: "- [ ] 外部サービスとの連携インターフェース"
        - description: "- [ ] APIキー管理"
        - description: "- [ ] 使用量の監視"
    - description: "- [ ] 請求書生成機能の実装"
      priority: medium
      subtasks:
        - description: "- [ ] 請求書テンプレートの作成"
        - description: "- [ ] PDF生成機能"
        - description: "- [ ] メール送信機能"
    - description: "- [ ] 統計・分析機能の実装"
      priority: medium
      subtasks:
        - description: "- [ ] 使用状況ダッシュボード"
        - description: "- [ ] グラフ表示"
        - description: "- [ ] エクスポート機能"
    - description: "- [ ] RLS（Row Level Security）の実装"
      priority: medium # Supabase連携と並行または後
      subtasks:
        - description: "- [ ] テーブルごとのポリシー設定"
        - description: "- [ ] ロールベースのアクセス制御"
        - description: "- [ ] 監査ログの自動記録"
    - description: "- [ ] モバイル対応テスト"
      priority: medium
      subtasks:
        - description: "- [ ] レスポンシブデザインのテスト"
        - description: "- [ ] タッチ操作のテスト"
        - description: "- [ ] モバイル特有の問題の検出"
    - description: "- [ ] Supabase連携計画"
      priority: high # インフラ変更は影響大
      subtasks:
        - description: "- [ ] Phase 1 - 基本設定とデータベース移行 (プロジェクトセットアップ, スキーマ移行, 認証連携)"
        - description: "- [ ] Phase 2 - ストレージとRLS実装 (ファイルストレージ設定, RLSポリシー実装)"
        - description: "- [ ] Phase 3 - リアルタイム機能と最適化 (リアルタイム更新, エッジ関数活用)"
    - description: "- [ ] ブログ機能の実装"
      priority: low
    - description: "- [ ] 多言語対応の拡充"
      priority: low
    - description: "- [ ] カスタムテーマ機能"
      priority: low
    - description: "- [ ] APIドキュメントの整備 (Swagger/OpenAPI)"
      priority: low