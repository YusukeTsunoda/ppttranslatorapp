# 型定義情報リスト

このドキュメントは、PPT翻訳アプリの主要な型定義と設計方針をまとめたものです。  
型の追加・変更時は必ずこのファイルも更新してください。

---

## 型設計の基本方針

- 型定義は`types/`ディレクトリ、または`prisma/schema.prisma`で一元管理する
- enumやユニオン型はアプリ全体で一貫性を持たせる
- APIリクエスト/レスポンス、DBモデル、UI Propsなど、用途ごとに型を分離し、必要に応じて共通型をimportして使う
- 型の変更時は、必ず型定義ファイルとこのドキュメントを更新する
- 型エラーが出た場合は、型定義ファイルと実装の両方を見直す

---

## 主要な型定義

### enum型

```ts
export type Language = 'ja' | 'en' | 'zh' | 'ko' | 'fr' | 'de' | 'es' | 'it' | 'ru' | 'pt';
export type UserRole = 'USER' | 'ADMIN';
export type FileStatus = 'PROCESSING' | 'READY' | 'ERROR';
export type TranslationStatus = 'PROCESSING' | 'COMPLETED' | 'FAILED';
export type BatchJobStatus = 'PENDING' | 'PROCESSING' | 'COMPLETED' | 'FAILED' | 'CANCELLED';
```

### モデル型

```ts
export interface User {
  id: string;
  name?: string;
  email: string;
  role: UserRole;
  createdAt: string;
  updatedAt: string;
}

export interface File {
  id: string;
  userId: string;
  originalName: string;
  status: FileStatus;
}

export interface TranslationHistory {
  id: string;
  userId: string;
  fileId: string;
  status: TranslationStatus;
  creditsUsed: number;
  sourceLang: Language;
  targetLang: Language;
}

export interface BatchJob {
  id: string;
  userId: string;
  status: BatchJobStatus;
  totalFiles: number;
  processedFiles: number;
  failedFiles: number;
  options?: any;
  results?: any;
  errorDetails?: any;
  createdAt: string;
  updatedAt: string;
  startedAt?: string;
  completedAt?: string;
  key?: string;
  isActive: boolean;
  lastUsed?: string;
}

export interface ApiKey {
  id: string;
  userId: string;
  name: string;
  key: string;
  lastUsed?: string;
  createdAt: string;
  updatedAt: string;
  expiresAt?: string;
  isRevoked: boolean;
  permissions?: any;
}
```

### PPTX関連の型定義

```ts
// スライド内のテキスト要素の位置情報
export interface Position {
  x: number;
  y: number;
  width: number;
  height: number;
}

// テキスト要素のスタイル情報
export interface TextStyle {
  fontSize?: number;
  fontFamily?: string;
  color?: string;
  bold?: boolean;
  italic?: boolean;
}

// スライド内の個々のテキスト要素
export interface TextElement {
  text: string;
  position: Position;
  fontInfo?: any; // フォント情報（サイズ、種類、スタイルなど）
  id?: string; // 要素のID
  type?: string; // テキストタイプ
}

// 1枚のスライドの全情報
export interface SlideContent {
  index: number;
  textElements: TextElement[];
  imagePath: string;
}

// PPTXファイル全体の解析結果
export interface PPTXParseResult {
  slides: SlideContent[];
  metadata: {
    totalSlides: number;
    title: string;
    lastModified: string;
  };
}
```

### ブラウザAPI拡張インターフェース

```ts
// Chrome向けのPerformance型拡張
interface MemoryInfo {
  jsHeapSizeLimit: number;
  totalJSHeapSize: number;
  usedJSHeapSize: number;
}

interface ExtendedPerformance extends Performance {
  memory?: MemoryInfo;
}

interface ExtendedWindow extends Window {
  performance: ExtendedPerformance;
}
```

### APIリクエスト/レスポンス型

```ts
export interface TranslationRequest {
  fileId: string;
  sourceLang: Language;
  targetLang: Language;
}

export interface TranslationResponse {
  status: TranslationStatus;
  translatedFileUrl?: string;
  errorMessage?: string;
}

export interface ParseAPIResponse {
  success: boolean;
  data?: PPTXParseResult;
  error?: string;
}
```

---

## 型定義の運用ルール

- 型の追加・変更時は、必ずこのリストと型定義ファイルを更新すること
- 型エラーが出た場合は、型定義と実装の両方を見直すこと
- 型定義の一貫性を保つため、enumやユニオン型は必ず共通ファイルからimportして使うこと
- ブラウザ固有APIを使用する場合は適切な型拡張インターフェースを定義すること
- 標準のTypeScript型定義にないプロパティを使用する場合は、拡張インターフェースを定義すること

--- 