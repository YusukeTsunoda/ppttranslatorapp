# フロントエンド設計仕様書

## 技術スタック
- **フレームワーク**: Next.js 14.0（App Router）
- **言語**: TypeScript 5.0（strict mode）
- **UIライブラリ**: React 18.0
- **スタイリング**: 
  - Tailwind CSS 3.3
  - CSS Modules
  - CSS Variables
- **コンポーネントライブラリ**: 
  - shadcn/ui 1.0
  - Radix UI
  - Lucide Icons
- **状態管理**: 
  - React Context API
  - SWR 2.0
  - Zustand（複雑な状態管理用）
- **フォーム管理**: 
  - React Hook Form
  - Zod（バリデーション）
- **アニメーション**: 
  - Framer Motion
  - CSS Transitions

## アーキテクチャ設計

### ディレクトリ構造
```
app/
├── (auth)/                # 認証関連ページ
│   ├── login/             # ログインページ
│   ├── register/          # 登録ページ
│   ├── forgot-password/   # パスワードリセット
│   └── layout.tsx         # 認証ページ共通レイアウト
├── (dashboard)/           # ダッシュボード関連ページ
│   ├── translate/         # 翻訳ページ
│   ├── history/           # 履歴ページ
│   ├── settings/          # 設定ページ
│   ├── team/              # チーム管理ページ
│   └── layout.tsx         # ダッシュボード共通レイアウト
├── (marketing)/           # マーケティング関連ページ
│   ├── pricing/           # 料金ページ
│   ├── features/          # 機能紹介ページ
│   ├── blog/              # ブログページ
│   └── layout.tsx         # マーケティング共通レイアウト
├── api/                   # APIルート
├── globals.css            # グローバルスタイル
└── layout.tsx             # ルートレイアウト

components/
├── ui/                    # 基本UIコンポーネント
│   ├── button.tsx
│   ├── card.tsx
│   ├── dialog.tsx
│   └── ...
├── auth/                  # 認証関連コンポーネント
│   ├── login-form.tsx
│   ├── register-form.tsx
│   └── ...
├── dashboard/             # ダッシュボード関連コンポーネント
│   ├── sidebar.tsx
│   ├── header.tsx
│   └── ...
├── translate/             # 翻訳関連コンポーネント
│   ├── file-uploader.tsx
│   ├── slide-viewer.tsx
│   ├── translation-editor.tsx
│   └── ...
└── marketing/             # マーケティング関連コンポーネント
    ├── hero.tsx
    ├── feature-card.tsx
    └── ...

lib/
├── hooks/                 # カスタムフック
│   ├── use-translation.ts
│   ├── use-auth.ts
│   └── ...
├── utils/                 # ユーティリティ関数
├── api/                   # APIクライアント
└── context/               # Reactコンテキスト
```

## コンポーネント設計

### アトミックデザイン原則
- **Atoms**: 基本的なUIコンポーネント（Button, Input, Icon）
- **Molecules**: 複数のAtomsを組み合わせたコンポーネント（FormField, Card）
- **Organisms**: 特定の機能を持つ複雑なコンポーネント（Header, Sidebar）
- **Templates**: ページレイアウト（DashboardLayout, AuthLayout）
- **Pages**: 完全なページコンポーネント

### コンポーネント実装ガイドライン
- **単一責任の原則**: 各コンポーネントは1つの責任のみを持つ
- **Props型定義**: すべてのpropsに明示的な型定義
- **デフォルト値**: 適切なデフォルト値の設定
- **エラーハンドリング**: 堅牢なエラー処理
- **アクセシビリティ**: ARIA属性、キーボードナビゲーション対応
- **テスト容易性**: テスト可能な設計

## 状態管理戦略

### グローバル状態
- **認証状態**: ユーザー情報、認証状態
- **アプリ設定**: テーマ、言語設定
- **通知**: システム通知、エラーメッセージ

### ローカル状態
- **フォーム状態**: React Hook Form
- **UI状態**: コンポーネント内のuseState
- **一時データ**: ページ内でのみ使用するデータ

### データフェッチング
- **SWR**: データ取得、キャッシュ、再検証
- **Suspense対応**: データロード中の表示
- **エラーバウンダリ**: エラーハンドリング
- **楽観的更新**: ユーザー体験向上

## レスポンシブデザイン

### ブレイクポイント
- **sm**: 640px
- **md**: 768px
- **lg**: 1024px
- **xl**: 1280px
- **2xl**: 1536px

### モバイルファースト
- 基本的にモバイル向けデザインから実装
- メディアクエリで大きい画面サイズに対応

### レイアウト戦略
- Flexbox/Gridの適切な使い分け
- コンテナクエリの活用
- 動的なレイアウト調整

## パフォーマンス最適化

### 画像最適化
- next/imageの活用
- WebP/AVIF形式の使用
- 適切なサイズと解像度

### コード分割
- 動的インポート
- ルートベースの分割
- コンポーネントの遅延ロード

### レンダリング最適化
- メモ化（useMemo, useCallback）
- 仮想化リスト
- 不要な再レンダリングの防止

## アクセシビリティ

### 基本対応
- セマンティックHTML
- キーボードナビゲーション
- スクリーンリーダー対応
- フォーカス管理

### WCAG 2.1 AA準拠
- コントラスト比
- テキストサイズ
- 代替テキスト
- フォーム要素のラベル

## 国際化（i18n）

### 多言語対応
- next-intlの使用
- 言語ファイルの構造
- 動的な言語切り替え

### 文化的配慮
- 日付/時刻形式
- 数値形式
- 方向性（RTL対応）

## テーマ設計

### ダークモード
- CSS変数による実装
- システム設定との連携
- ユーザー設定の保存

### カラーシステム
- 基本カラー
- アクセントカラー
- セマンティックカラー（成功、警告、エラー）
- コントラスト比の確保

## アニメーションとトランジション

### 使用原則
- 目的を持ったアニメーション
- パフォーマンスへの配慮
- アクセシビリティ（減らしたモーション）

### 実装方法
- CSS Transitions
- Framer Motion
- FLIP技術

## エラーハンドリング

### ユーザーフレンドリーなエラー表示
- トースト通知
- インラインエラーメッセージ
- エラーページ

### エラー回復
- 自動リトライ
- フォールバックUI
- オフライン対応

## プレビュー表示の仕様

- サーバーから取得した各テキストの `position`（x, y, width, height）情報を利用し、スライド画像上に枠やハイライトを重ねて表示する。
- 画像の表示サイズとposition情報をスケーリングして、正しい位置・サイズで枠を描画する。
- 選択・ホバー時は枠の色や太さを変えて強調表示する。