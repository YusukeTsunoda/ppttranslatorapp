# **翻訳アプリ 技術設計書**

## **1. 概要**
本ドキュメントは、翻訳アプリの技術的な設計を定義し、開発の指針となる情報を提供する。本アプリは、RAGを活用したカスタム翻訳機能を持ち、クラウドベースでスケーラブルなシステムとして設計する。

---

## **2. アーキテクチャ設計**

### **2.1 システム構成**
本アプリは、以下のコンポーネントから構成される。

1. **フロントエンド**（React + Next.js + TailwindCSS）
   - ユーザーインターフェースの提供
   - 翻訳結果の表示・編集
   - ユーザー管理、サブスクリプション管理
2. **バックエンド**（Node.js + Express / FastAPI）
   - APIエンドポイントの提供
   - 翻訳処理のハンドリング
   - 認証・認可（JWT / OAuth2）
3. **データベース**（PostgreSQL / MongoDB）
   - ユーザー管理、翻訳履歴の保存
   - 用語辞書、翻訳メモリの管理
4. **翻訳エンジン**（Claude API / Google Cloud Translation / DeepL API）
   - 外部翻訳エンジンとの統合
5. **クラウドインフラ**（AWS / GCP / Azure）
   - API Gateway、負荷分散（Load Balancer）
   - Lambda / Cloud Functions によるサーバーレス処理
   - S3 / Cloud Storage によるファイル保存

### **2.2 アーキテクチャ図**
```
[フロントエンド] → [API Gateway] → [バックエンド] → [データベース]
                                 ↓
                       [翻訳エンジンAPI]
```

---

## **3. データベース設計**

### **3.1 テーブル構成**
| テーブル名 | 説明 |
|------------|------|
| users | ユーザー情報（ID、メール、パスワード、サブスクプランなど） |
| translations | 翻訳履歴（原文、訳文、使用したエンジン、日付など） |
| glossary | ユーザーごとの登録用語辞書（原語、訳語、優先度など） |
| files | アップロードされた文書情報（ファイル名、形式、保存パスなど） |
| payments | 課金情報（ユーザーID、プラン、支払い履歴など） |

---

## **4. API仕様**

### **4.1 API エンドポイント一覧**
| メソッド | エンドポイント | 概要 |
|----------|-------------|------|
| POST | /auth/signup | ユーザー登録 |
| POST | /auth/login | ログイン（JWT発行） |
| GET | /translations | 翻訳履歴取得 |
| POST | /translate | 翻訳リクエスト（ファイル or テキスト） |
| POST | /glossary | 用語辞書の登録・更新 |
| GET | /glossary | ユーザー辞書取得 |
| GET | /plans | サブスクリプションプラン情報取得 |
| POST | /payments | 決済処理 |

---

## **5. 開発・運用フロー**

### **5.1 開発プロセス**
1. **要件定義**（完了）
2. **技術設計**（本ドキュメント）
3. **プロトタイプ開発**（フロントエンド + APIモック）
4. **バックエンド開発**（認証、翻訳API、データベース）
5. **インフラ構築**（クラウドデプロイ、スケーリング対応）
6. **結合テスト**（API + フロントエンド）
7. **ベータ版リリース**（ユーザーテスト）
8. **正式リリース**（課金システム有効化）
9. **運用・保守**（ログ監視、定期バックアップ）

### **5.2 運用フロー**
- **翻訳APIのモニタリング**（APIレスポンス監視）
- **データバックアップ**（翻訳履歴・用語集は1日1回自動バックアップ）
- **スケールアウト**（高負荷時の自動サーバー増強）
- **バージョン管理**（GitHub + CI/CD による自動デプロイ）

---

## **6. セキュリティ設計**

### **6.1 認証・認可**
| 項目 | 詳細 |
|------|------|
| 認証方式 | JWT（JSON Web Token）によるセッション管理 |
| 2要素認証（2FA） | オプションで提供（Eメール / Authenticatorアプリ） |
| アクセス制御 | RBAC（ロールベースアクセス制御） |

### **6.2 データ保護**
| 項目 | 詳細 |
|------|------|
| 通信の暗号化 | HTTPS（TLS 1.2以上） |
| データの暗号化 | AES-256で保存 |
| プライバシー管理 | 翻訳データは処理後に即時削除（オプションで履歴保持可能） |

### **6.3 ログ管理**
| 項目 | 詳細 |
|------|------|
| 監査ログ | すべてのAPIリクエスト・レスポンスを記録 |
| モニタリング | クラウド監視ツール（AWS CloudWatch / GCP Monitoring）を利用 |

---

## **7. 参考情報**
- **競合アプリの技術仕様**（DeepL、Google Translate など）
- **API利用コスト試算**（Claude API の従量課金モデルを考慮）
- **クラウド環境の選定**（AWS Lambda / GCP Cloud Functions などのサーバーレス構成）

---

以上、翻訳アプリの技術設計書とする。

