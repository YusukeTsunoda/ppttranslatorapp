73c09bc27db8614cc16a1867b65afc04
'use strict';
Object.defineProperty(exports, '__esModule', {
    value: true
});
exports.test = exports.serialize = exports.default = void 0;
var _markup = require('./lib/markup');
/**
 * Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ const ELEMENT_NODE = 1;
const TEXT_NODE = 3;
const COMMENT_NODE = 8;
const FRAGMENT_NODE = 11;
const ELEMENT_REGEXP = /^((HTML|SVG)\w*)?Element$/;
const testHasAttribute = (val)=>{
    try {
        return typeof val.hasAttribute === 'function' && val.hasAttribute('is');
    } catch  {
        return false;
    }
};
const testNode = (val)=>{
    const constructorName = val.constructor.name;
    const { nodeType, tagName } = val;
    const isCustomElement = typeof tagName === 'string' && tagName.includes('-') || testHasAttribute(val);
    return nodeType === ELEMENT_NODE && (ELEMENT_REGEXP.test(constructorName) || isCustomElement) || nodeType === TEXT_NODE && constructorName === 'Text' || nodeType === COMMENT_NODE && constructorName === 'Comment' || nodeType === FRAGMENT_NODE && constructorName === 'DocumentFragment';
};
const test = (val)=>{
    var _val$constructor;
    return (val === null || val === void 0 ? void 0 : (_val$constructor = val.constructor) === null || _val$constructor === void 0 ? void 0 : _val$constructor.name) && testNode(val);
};
exports.test = test;
function nodeIsText(node) {
    return node.nodeType === TEXT_NODE;
}
function nodeIsComment(node) {
    return node.nodeType === COMMENT_NODE;
}
function nodeIsFragment(node) {
    return node.nodeType === FRAGMENT_NODE;
}
const serialize = (node, config, indentation, depth, refs, printer)=>{
    if (nodeIsText(node)) {
        return (0, _markup.printText)(node.data, config);
    }
    if (nodeIsComment(node)) {
        return (0, _markup.printComment)(node.data, config);
    }
    const type = nodeIsFragment(node) ? 'DocumentFragment' : node.tagName.toLowerCase();
    if (++depth > config.maxDepth) {
        return (0, _markup.printElementAsLeaf)(type, config);
    }
    return (0, _markup.printElement)(type, (0, _markup.printProps)(nodeIsFragment(node) ? [] : Array.from(node.attributes).map((attr)=>attr.name).sort(), nodeIsFragment(node) ? {} : Array.from(node.attributes).reduce((props, attribute)=>{
        props[attribute.name] = attribute.value;
        return props;
    }, {}), config, indentation + config.indent, depth, refs, printer), (0, _markup.printChildren)(Array.prototype.slice.call(node.childNodes || node.children), config, indentation + config.indent, depth, refs, printer), config, indentation);
};
exports.serialize = serialize;
const plugin = {
    serialize,
    test
};
var _default = plugin;
exports.default = _default;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95dXN1a2V0c3Vub2RhL0RvY3VtZW50cy9jdXJzb3IvcHB0dHJhbnNsYXRvcmFwcC9ub2RlX21vZHVsZXMvcHJldHR5LWZvcm1hdC9idWlsZC9wbHVnaW5zL0RPTUVsZW1lbnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMudGVzdCA9IGV4cG9ydHMuc2VyaWFsaXplID0gZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX21hcmt1cCA9IHJlcXVpcmUoJy4vbGliL21hcmt1cCcpO1xuXG4vKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5jb25zdCBFTEVNRU5UX05PREUgPSAxO1xuY29uc3QgVEVYVF9OT0RFID0gMztcbmNvbnN0IENPTU1FTlRfTk9ERSA9IDg7XG5jb25zdCBGUkFHTUVOVF9OT0RFID0gMTE7XG5jb25zdCBFTEVNRU5UX1JFR0VYUCA9IC9eKChIVE1MfFNWRylcXHcqKT9FbGVtZW50JC87XG5cbmNvbnN0IHRlc3RIYXNBdHRyaWJ1dGUgPSB2YWwgPT4ge1xuICB0cnkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsLmhhc0F0dHJpYnV0ZSA9PT0gJ2Z1bmN0aW9uJyAmJiB2YWwuaGFzQXR0cmlidXRlKCdpcycpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbmNvbnN0IHRlc3ROb2RlID0gdmFsID0+IHtcbiAgY29uc3QgY29uc3RydWN0b3JOYW1lID0gdmFsLmNvbnN0cnVjdG9yLm5hbWU7XG4gIGNvbnN0IHtub2RlVHlwZSwgdGFnTmFtZX0gPSB2YWw7XG4gIGNvbnN0IGlzQ3VzdG9tRWxlbWVudCA9XG4gICAgKHR5cGVvZiB0YWdOYW1lID09PSAnc3RyaW5nJyAmJiB0YWdOYW1lLmluY2x1ZGVzKCctJykpIHx8XG4gICAgdGVzdEhhc0F0dHJpYnV0ZSh2YWwpO1xuICByZXR1cm4gKFxuICAgIChub2RlVHlwZSA9PT0gRUxFTUVOVF9OT0RFICYmXG4gICAgICAoRUxFTUVOVF9SRUdFWFAudGVzdChjb25zdHJ1Y3Rvck5hbWUpIHx8IGlzQ3VzdG9tRWxlbWVudCkpIHx8XG4gICAgKG5vZGVUeXBlID09PSBURVhUX05PREUgJiYgY29uc3RydWN0b3JOYW1lID09PSAnVGV4dCcpIHx8XG4gICAgKG5vZGVUeXBlID09PSBDT01NRU5UX05PREUgJiYgY29uc3RydWN0b3JOYW1lID09PSAnQ29tbWVudCcpIHx8XG4gICAgKG5vZGVUeXBlID09PSBGUkFHTUVOVF9OT0RFICYmIGNvbnN0cnVjdG9yTmFtZSA9PT0gJ0RvY3VtZW50RnJhZ21lbnQnKVxuICApO1xufTtcblxuY29uc3QgdGVzdCA9IHZhbCA9PiB7XG4gIHZhciBfdmFsJGNvbnN0cnVjdG9yO1xuXG4gIHJldHVybiAoXG4gICAgKHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHZvaWQgMFxuICAgICAgPyB2b2lkIDBcbiAgICAgIDogKF92YWwkY29uc3RydWN0b3IgPSB2YWwuY29uc3RydWN0b3IpID09PSBudWxsIHx8XG4gICAgICAgIF92YWwkY29uc3RydWN0b3IgPT09IHZvaWQgMFxuICAgICAgPyB2b2lkIDBcbiAgICAgIDogX3ZhbCRjb25zdHJ1Y3Rvci5uYW1lKSAmJiB0ZXN0Tm9kZSh2YWwpXG4gICk7XG59O1xuXG5leHBvcnRzLnRlc3QgPSB0ZXN0O1xuXG5mdW5jdGlvbiBub2RlSXNUZXh0KG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IFRFWFRfTk9ERTtcbn1cblxuZnVuY3Rpb24gbm9kZUlzQ29tbWVudChub2RlKSB7XG4gIHJldHVybiBub2RlLm5vZGVUeXBlID09PSBDT01NRU5UX05PREU7XG59XG5cbmZ1bmN0aW9uIG5vZGVJc0ZyYWdtZW50KG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IEZSQUdNRU5UX05PREU7XG59XG5cbmNvbnN0IHNlcmlhbGl6ZSA9IChub2RlLCBjb25maWcsIGluZGVudGF0aW9uLCBkZXB0aCwgcmVmcywgcHJpbnRlcikgPT4ge1xuICBpZiAobm9kZUlzVGV4dChub2RlKSkge1xuICAgIHJldHVybiAoMCwgX21hcmt1cC5wcmludFRleHQpKG5vZGUuZGF0YSwgY29uZmlnKTtcbiAgfVxuXG4gIGlmIChub2RlSXNDb21tZW50KG5vZGUpKSB7XG4gICAgcmV0dXJuICgwLCBfbWFya3VwLnByaW50Q29tbWVudCkobm9kZS5kYXRhLCBjb25maWcpO1xuICB9XG5cbiAgY29uc3QgdHlwZSA9IG5vZGVJc0ZyYWdtZW50KG5vZGUpXG4gICAgPyAnRG9jdW1lbnRGcmFnbWVudCdcbiAgICA6IG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuXG4gIGlmICgrK2RlcHRoID4gY29uZmlnLm1heERlcHRoKSB7XG4gICAgcmV0dXJuICgwLCBfbWFya3VwLnByaW50RWxlbWVudEFzTGVhZikodHlwZSwgY29uZmlnKTtcbiAgfVxuXG4gIHJldHVybiAoMCwgX21hcmt1cC5wcmludEVsZW1lbnQpKFxuICAgIHR5cGUsXG4gICAgKDAsIF9tYXJrdXAucHJpbnRQcm9wcykoXG4gICAgICBub2RlSXNGcmFnbWVudChub2RlKVxuICAgICAgICA/IFtdXG4gICAgICAgIDogQXJyYXkuZnJvbShub2RlLmF0dHJpYnV0ZXMpXG4gICAgICAgICAgICAubWFwKGF0dHIgPT4gYXR0ci5uYW1lKVxuICAgICAgICAgICAgLnNvcnQoKSxcbiAgICAgIG5vZGVJc0ZyYWdtZW50KG5vZGUpXG4gICAgICAgID8ge31cbiAgICAgICAgOiBBcnJheS5mcm9tKG5vZGUuYXR0cmlidXRlcykucmVkdWNlKChwcm9wcywgYXR0cmlidXRlKSA9PiB7XG4gICAgICAgICAgICBwcm9wc1thdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGUudmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gcHJvcHM7XG4gICAgICAgICAgfSwge30pLFxuICAgICAgY29uZmlnLFxuICAgICAgaW5kZW50YXRpb24gKyBjb25maWcuaW5kZW50LFxuICAgICAgZGVwdGgsXG4gICAgICByZWZzLFxuICAgICAgcHJpbnRlclxuICAgICksXG4gICAgKDAsIF9tYXJrdXAucHJpbnRDaGlsZHJlbikoXG4gICAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChub2RlLmNoaWxkTm9kZXMgfHwgbm9kZS5jaGlsZHJlbiksXG4gICAgICBjb25maWcsXG4gICAgICBpbmRlbnRhdGlvbiArIGNvbmZpZy5pbmRlbnQsXG4gICAgICBkZXB0aCxcbiAgICAgIHJlZnMsXG4gICAgICBwcmludGVyXG4gICAgKSxcbiAgICBjb25maWcsXG4gICAgaW5kZW50YXRpb25cbiAgKTtcbn07XG5cbmV4cG9ydHMuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuY29uc3QgcGx1Z2luID0ge1xuICBzZXJpYWxpemUsXG4gIHRlc3Rcbn07XG52YXIgX2RlZmF1bHQgPSBwbHVnaW47XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbiJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInRlc3QiLCJzZXJpYWxpemUiLCJkZWZhdWx0IiwiX21hcmt1cCIsInJlcXVpcmUiLCJFTEVNRU5UX05PREUiLCJURVhUX05PREUiLCJDT01NRU5UX05PREUiLCJGUkFHTUVOVF9OT0RFIiwiRUxFTUVOVF9SRUdFWFAiLCJ0ZXN0SGFzQXR0cmlidXRlIiwidmFsIiwiaGFzQXR0cmlidXRlIiwidGVzdE5vZGUiLCJjb25zdHJ1Y3Rvck5hbWUiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJub2RlVHlwZSIsInRhZ05hbWUiLCJpc0N1c3RvbUVsZW1lbnQiLCJpbmNsdWRlcyIsIl92YWwkY29uc3RydWN0b3IiLCJub2RlSXNUZXh0Iiwibm9kZSIsIm5vZGVJc0NvbW1lbnQiLCJub2RlSXNGcmFnbWVudCIsImNvbmZpZyIsImluZGVudGF0aW9uIiwiZGVwdGgiLCJyZWZzIiwicHJpbnRlciIsInByaW50VGV4dCIsImRhdGEiLCJwcmludENvbW1lbnQiLCJ0eXBlIiwidG9Mb3dlckNhc2UiLCJtYXhEZXB0aCIsInByaW50RWxlbWVudEFzTGVhZiIsInByaW50RWxlbWVudCIsInByaW50UHJvcHMiLCJBcnJheSIsImZyb20iLCJhdHRyaWJ1dGVzIiwibWFwIiwiYXR0ciIsInNvcnQiLCJyZWR1Y2UiLCJwcm9wcyIsImF0dHJpYnV0ZSIsImluZGVudCIsInByaW50Q2hpbGRyZW4iLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJjaGlsZE5vZGVzIiwiY2hpbGRyZW4iLCJwbHVnaW4iLCJfZGVmYXVsdCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFFQUEsT0FBT0MsY0FBYyxDQUFDQyxTQUFTLGNBQWM7SUFDM0NDLE9BQU87QUFDVDtBQUNBRCxRQUFRRSxJQUFJLEdBQUdGLFFBQVFHLFNBQVMsR0FBR0gsUUFBUUksT0FBTyxHQUFHLEtBQUs7QUFFMUQsSUFBSUMsVUFBVUMsUUFBUTtBQUV0Qjs7Ozs7Q0FLQyxHQUNELE1BQU1DLGVBQWU7QUFDckIsTUFBTUMsWUFBWTtBQUNsQixNQUFNQyxlQUFlO0FBQ3JCLE1BQU1DLGdCQUFnQjtBQUN0QixNQUFNQyxpQkFBaUI7QUFFdkIsTUFBTUMsbUJBQW1CQyxDQUFBQTtJQUN2QixJQUFJO1FBQ0YsT0FBTyxPQUFPQSxJQUFJQyxZQUFZLEtBQUssY0FBY0QsSUFBSUMsWUFBWSxDQUFDO0lBQ3BFLEVBQUUsT0FBTTtRQUNOLE9BQU87SUFDVDtBQUNGO0FBRUEsTUFBTUMsV0FBV0YsQ0FBQUE7SUFDZixNQUFN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