{"version":3,"sources":["/Users/yusuketsunoda/Documents/cursor/ppttranslatorapp/worktrees/4-test-automation/tests/api/pptx-parse.test.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { expect } from '@jest/globals';\nimport fs from 'fs/promises';\nimport path from 'path';\nimport { auth } from '@/lib/auth/auth';\nimport { PPTXParser } from '@/lib/pptx/parser';\n\n/**\n * ÈùûÂêåÊúüÂá¶ÁêÜ„ÅÆÂæÖÊ©ü„Éò„É´„Éë„ÉºÈñ¢Êï∞\n * @param ms ÂæÖÊ©üÊôÇÈñìÔºà„Éü„É™ÁßíÔºâ\n */\nasync function wait(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n/**\n * „ÉÜ„Çπ„ÉàÁî®„ÅÆ„Ç®„É©„ÉºÁ®ÆÂà•\n */\nenum TestErrorType {\n  NETWORK = 'NETWORK_ERROR',\n  TIMEOUT = 'TIMEOUT_ERROR',\n  PARSE = 'PARSE_ERROR',\n  FILESYSTEM = 'FILESYSTEM_ERROR',\n  VALIDATION = 'VALIDATION_ERROR',\n  AUTHENTICATION = 'AUTHENTICATION_ERROR'\n}\n\n/**\n * „ÉÜ„Çπ„ÉàÁî®„ÅÆ„Ç®„É©„Éº„ÇØ„É©„Çπ\n */\nclass TestError extends Error {\n  type: TestErrorType;\n  \n  constructor(message: string, type: TestErrorType) {\n    super(message);\n    this.type = type;\n    this.name = 'TestError';\n  }\n}\n\n/**\n * PPTX„Éë„Éº„Çµ„Éº„ÅÆ„É¢„ÉÉ„ÇØ\n * „Çà„ÇäÂÆüÈöõ„ÅÆÊåôÂãï„Å´Ëøë„ÅÑË©≥Á¥∞„Å™„É¢„ÉÉ„ÇØÂÆüË£Ö\n */\njest.mock('@/lib/pptx/parser', () => {\n  // „Éá„Éï„Ç©„É´„Éà„ÅÆ„Çπ„É©„Ç§„Éâ„Éá„Éº„Çø\n  const defaultSlides = [\n    {\n      id: 'slide1',\n      title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ1',\n      content: '„Çπ„É©„Ç§„Éâ1„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n      texts: [\n        { id: 'text1', text: '„Çπ„É©„Ç§„Éâ1„ÅÆ„ÉÜ„Ç≠„Çπ„Éà1', type: 'title' },\n        { id: 'text2', text: '„Çπ„É©„Ç§„Éâ1„ÅÆ„ÉÜ„Ç≠„Çπ„Éà2', type: 'body' }\n      ],\n      index: 0\n    },\n    {\n      id: 'slide2',\n      title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ2',\n      content: '„Çπ„É©„Ç§„Éâ2„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n      texts: [\n        { id: 'text3', text: '„Çπ„É©„Ç§„Éâ2„ÅÆ„ÉÜ„Ç≠„Çπ„Éà1', type: 'title' },\n        { id: 'text4', text: '„Çπ„É©„Ç§„Éâ2„ÅÆ„ÉÜ„Ç≠„Çπ„Éà2', type: 'body' }\n      ],\n      index: 1\n    },\n  ];\n  \n  // „Éá„Éï„Ç©„É´„Éà„ÅÆ„É°„Çø„Éá„Éº„Çø\n  const defaultMetadata = {\n    title: '„ÉÜ„Çπ„Éà„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥',\n    author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n    totalSlides: 2,\n    createdAt: new Date().toISOString(),\n    lastModified: new Date().toISOString(),\n    fileSize: 12345\n  };\n  \n  // ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄ„Çπ„É©„Ç§„Éâ\n  const specialCharSlides = [\n    {\n      id: 'special-chars',\n      title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„Äê‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ',\n      content: 'ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ',\n      texts: [\n        { id: 'text-special', text: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„Äê‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ', type: 'title' },\n        { id: 'text-special2', text: 'ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ', type: 'body' }\n      ],\n      index: 0\n    }\n  ];\n  \n  // Á©∫„ÅÆ„Çπ„É©„Ç§„Éâ\n  const emptySlides = [\n    {\n      id: 'empty-slide',\n      title: '',\n      content: '',\n      texts: [],\n      index: 0\n    },\n    {\n      id: 'normal-slide',\n      title: 'Normal Slide',\n      content: 'Content of normal slide',\n      texts: [\n        { id: 'text-normal', text: 'Normal Slide', type: 'title' },\n        { id: 'text-normal2', text: 'Content of normal slide', type: 'body' }\n      ],\n      index: 1\n    }\n  ];\n  \n  // Â§ßÈáè„ÅÆ„Çπ„É©„Ç§„Éâ„ÇíÁîüÊàê„Åô„ÇãÈñ¢Êï∞\n  const generateLargeSlideSet = (count: number) => {\n    const slides = [];\n    for (let i = 0; i < count; i++) {\n      slides.push({\n        id: `slide${i+1}`,\n        title: `„Çπ„É©„Ç§„Éâ ${i+1}`,\n        content: `„Çπ„É©„Ç§„Éâ ${i+1} „ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ`,\n        texts: [\n          { id: `text-title-${i}`, text: `„Çπ„É©„Ç§„Éâ ${i+1}`, type: 'title' },\n          { id: `text-body-${i}`, text: `„Çπ„É©„Ç§„Éâ ${i+1} „ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ`, type: 'body' }\n        ],\n        index: i\n      });\n    }\n    return slides;\n  };\n  \n  // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö\n  const mockParsePPTX = jest.fn().mockImplementation(async (filePath: string, options: any = {}) => {\n    // „ÉÜ„Çπ„Éà„Ç±„Éº„Çπ„Å´Âøú„Åò„Å¶Áï∞„Å™„ÇãÂãï‰Ωú„Çí„Ç∑„Éü„É•„É¨„Éº„Éà\n    const testCase = options.testCase || '';\n    \n    // ÈùûÂêåÊúüÂá¶ÁêÜ„Çí„Ç∑„Éü„É•„É¨„Éº„Éà„Åô„Çã„Åü„ÇÅ„ÅÆÈÅÖÂª∂\n    await wait(50);\n    \n    // „ÉÜ„Çπ„Éà„Ç±„Éº„Çπ„Å´Âøú„Åò„ÅüÂãï‰Ωú\n    switch (testCase) {\n      case 'network-error':\n        throw new TestError('„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÊé•Á∂ö„Ç®„É©„Éº', TestErrorType.NETWORK);\n        \n      case 'timeout':\n        await wait(1000); // Èï∑„ÅÑÈÅÖÂª∂„Çí„Ç∑„Éü„É•„É¨„Éº„Éà\n        throw new TestError('„Çø„Ç§„É†„Ç¢„Ç¶„Éà„Ç®„É©„Éº', TestErrorType.TIMEOUT);\n        \n      case 'parse-error':\n        throw new TestError('PPTX„Éï„Ç°„Ç§„É´„ÅÆËß£Êûê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü', TestErrorType.PARSE);\n        \n      case 'empty-file':\n        return {\n          success: true,\n          slides: [],\n          metadata: {\n            ...defaultMetadata,\n            totalSlides: 0\n          }\n        };\n        \n      case 'empty-slide':\n        return {\n          success: true,\n          slides: emptySlides,\n          metadata: {\n            ...defaultMetadata,\n            totalSlides: emptySlides.length\n          }\n        };\n        \n      case 'special-chars':\n        return {\n          success: true,\n          slides: specialCharSlides,\n          metadata: {\n            ...defaultMetadata,\n            title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà',\n            totalSlides: specialCharSlides.length\n          }\n        };\n        \n      case 'large-presentation':\n        const largeSlides = generateLargeSlideSet(100);\n        return {\n          success: true,\n          slides: largeSlides,\n          metadata: {\n            ...defaultMetadata,\n            title: 'Â§ßÈáè„Çπ„É©„Ç§„Éâ„ÉÜ„Çπ„Éà',\n            totalSlides: largeSlides.length\n          }\n        };\n        \n      case 'invalid-format':\n        throw new TestError('„Éï„Ç°„Ç§„É´ÂΩ¢Âºè„ÅåÁÑ°Âäπ„Åß„Åô', TestErrorType.VALIDATION);\n        \n      case 'filesystem-error':\n        throw new TestError('„Éï„Ç°„Ç§„É´„Ç∑„Çπ„ÉÜ„É†„Ç®„É©„Éº', TestErrorType.FILESYSTEM);\n        \n      default:\n        // „Éá„Éï„Ç©„É´„Éà„ÅÆÊàêÂäü„Ç±„Éº„Çπ\n        return {\n          success: true,\n          slides: defaultSlides,\n          metadata: defaultMetadata\n        };\n    }\n  });\n  \n  return {\n    PPTXParser: {\n      getInstance: jest.fn().mockReturnValue({\n        parsePPTX: mockParsePPTX\n      })\n    }\n  };\n});\n\n// Ë™çË®º„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('@/lib/auth/auth', () => ({\n  auth: jest.fn().mockResolvedValue({\n    user: {\n      id: 'test-user',\n      email: 'test@example.com',\n    },\n  }),\n}));\n\n// fs/promises„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('fs/promises', () => ({\n  mkdir: jest.fn().mockResolvedValue(undefined),\n  writeFile: jest.fn().mockResolvedValue(undefined),\n  readdir: jest.fn().mockResolvedValue(['file1.pptx', 'file2.pptx']),\n  unlink: jest.fn().mockResolvedValue(undefined),\n  rm: jest.fn().mockResolvedValue(undefined),\n}));\n\n// path„É¢„Ç∏„É•„Éº„É´„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('path', () => ({\n  join: jest.fn((...args) => args.join('/')),\n}));\n\n// uuid„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('uuid', () => ({\n  v4: jest.fn().mockReturnValue('test-uuid'),\n}));\n\n// app/api/pptx/parse/route.ts„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('@/app/api/pptx/parse/route', () => {\n  // „É¢„ÉÉ„ÇØÁî®„ÅÆ„É¨„Çπ„Éù„É≥„ÇπÁîüÊàêÈñ¢Êï∞\n  const mockJsonResponse = (data: any, status = 200) => {\n    return {\n      json: () => Promise.resolve(data),\n      status,\n    };\n  };\n\n  // „ÉÜ„Çπ„Éà„Ç±„Éº„Çπ„Å´Âøú„Åò„Å¶ÁµêÊûú„ÇíËøî„Åô„Çà„ÅÜ„Å´„Ç´„Çπ„Çø„Éû„Ç§„Ç∫„Åß„Åç„ÇãPOST„É¢„ÉÉ„ÇØ\n  const mockPost = jest.fn().mockImplementation((req) => {\n    // Ë™çË®ºÂ§±Êïó„ÉÜ„Çπ„ÉàÁî®\n    if (req.headers && req.headers.get('x-test-case') === 'auth-fail') {\n      return mockJsonResponse({ success: false, error: '„É≠„Ç∞„Ç§„É≥„Åó„Å¶„Åè„Å†„Åï„ÅÑ' }, 401);\n    }\n    \n    // „Éï„Ç°„Ç§„É´„Å™„Åó„ÉÜ„Çπ„ÉàÁî®\n    if (req.headers && req.headers.get('x-test-case') === 'no-file') {\n      return mockJsonResponse({ success: false, error: '„Éï„Ç°„Ç§„É´„ÅåÊåáÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì' }, 400);\n    }\n    \n    // ‰∏çÊ≠£„Å™„Éï„Ç°„Ç§„É´„Çø„Ç§„Éó„ÉÜ„Çπ„ÉàÁî®\n    if (req.headers && req.headers.get('x-test-case') === 'invalid-type') {\n      return mockJsonResponse({ success: false, error: 'PPTX„Éï„Ç°„Ç§„É´„ÅÆ„Åø„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂèØËÉΩ„Åß„Åô' }, 400);\n    }\n    \n    // „Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫Ë∂ÖÈÅé„ÉÜ„Çπ„ÉàÁî®\n    if (req.headers && req.headers.get('x-test-case') === 'file-too-large') {\n      return mockJsonResponse({ success: false, error: '„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅØ20MB‰ª•‰∏ã„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ' }, 400);\n    }\n    \n    // ‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´‰ΩúÊàêÂ§±Êïó„ÉÜ„Çπ„ÉàÁî®\n    if (req.headers && req.headers.get('x-test-case') === 'mkdir-fail') {\n      return mockJsonResponse({ success: false, error: '„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê„Ç®„É©„Éº' }, 500);\n    }\n    \n    // „Éë„Éº„Çπ„Ç®„É©„Éº„ÉÜ„Çπ„ÉàÁî®\n    if (req.headers && req.headers.get('x-test-case') === 'parse-error') {\n      return mockJsonResponse({ success: false, error: '„Éë„Éº„Çπ„Ç®„É©„Éº' }, 500);\n    }\n    \n    // Á©∫„ÅÆ„Çπ„É©„Ç§„Éâ„ÉÜ„Çπ„ÉàÁî®\n    if (req.headers && req.headers.get('x-test-case') === 'empty-slide') {\n      return mockJsonResponse({\n        success: true,\n        slides: [\n          {\n            id: 'empty-slide',\n            title: '',\n            content: '',\n          },\n          {\n            id: 'normal-slide',\n            title: 'Normal Slide',\n            content: 'Content of normal slide',\n          },\n        ],\n      });\n    }\n    \n    // ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„ÉàÁî®\n    if (req.headers && req.headers.get('x-test-case') === 'special-chars') {\n      return mockJsonResponse({\n        success: true,\n        slides: [\n          {\n            id: 'special-chars',\n            title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„à±‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ',\n            content: 'ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ',\n          },\n        ],\n        metadata: {\n          title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà',\n          author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n          totalSlides: 1,\n        },\n      });\n    }\n    \n    // „Éá„Éï„Ç©„É´„Éà„ÅÆÊàêÂäü„É¨„Çπ„Éù„É≥„Çπ\n    return mockJsonResponse({\n      success: true,\n      fileId: 'test-uuid',\n      slides: [\n        {\n          id: 'slide1',\n          title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ1',\n          content: '„Çπ„É©„Ç§„Éâ1„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n        },\n        {\n          id: 'slide2',\n          title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ2',\n          content: '„Çπ„É©„Ç§„Éâ2„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n        },\n      ],\n      metadata: {\n        title: '„ÉÜ„Çπ„Éà„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥',\n        author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n        totalSlides: 2,\n      },\n    });\n  });\n  \n  // GET„É°„ÇΩ„ÉÉ„Éâ„ÅÆ„É¢„ÉÉ„ÇØ\n  const mockGet = jest.fn().mockImplementation(() => {\n    // Ê®ôÊ∫ñ„ÅÆGET„É™„ÇØ„Ç®„Çπ„Éà„ÅØ405„Ç®„É©„Éº\n    return mockJsonResponse({\n      success: false,\n      error: '„É°„ÇΩ„ÉÉ„Éâ„ÅåË®±ÂèØ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì',\n    }, 405);\n  });\n\n  return {\n    POST: mockPost,\n    GET: mockGet,\n  };\n});\n\n// „Ç§„É≥„Éù„Éº„Éà„ÅØ„É¢„ÉÉ„ÇØ„ÅÆÂæå„Å´Ë°å„ÅÜ\nimport { POST, GET } from '@/app/api/pptx/parse/route';\n\ndescribe('PPTX Parse API', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    // Ë™çË®º„É¢„ÉÉ„ÇØ„ÅÆ„Éá„Éï„Ç©„É´„ÉàË®≠ÂÆö\n    (auth as jest.Mock).mockResolvedValue({\n      user: { id: 'test-user' }\n    });\n\n    // PPTXParser„É¢„ÉÉ„ÇØ„ÅÆ„Éá„Éï„Ç©„É´„ÉàË®≠ÂÆö\n    (PPTXParser.getInstance as jest.Mock).mockReturnValue({\n      parsePPTX: jest.fn().mockResolvedValue({\n        success: true,\n        slides: [\n          { index: 1, texts: [{ text: 'Hello World' }] }\n        ]\n      })\n    });\n\n    // fs„É¢„ÉÉ„ÇØ„ÅÆ„Éá„Éï„Ç©„É´„ÉàË®≠ÂÆö\n    (fs.mkdir as jest.Mock).mockResolvedValue(undefined);\n    (fs.writeFile as jest.Mock).mockResolvedValue(undefined);\n    (fs.unlink as jest.Mock).mockResolvedValue(undefined);\n    (fs.rm as jest.Mock).mockResolvedValue(undefined);\n  });\n\n  describe('POST /api/pptx/parse', () => {\n    // „ÉÜ„Çπ„ÉàÂâç„Å´„É¢„ÉÉ„ÇØ„ÇíÈÅ©Âàá„Å´ÂÜçË®≠ÂÆö\n    beforeEach(() => {\n      // ÂêÑfs„É¢„ÉÉ„ÇØ„ÅÆÂàùÊúüÂåñ\n      (fs.mkdir as jest.Mock).mockReset();\n      (fs.writeFile as jest.Mock).mockReset();\n      (fs.unlink as jest.Mock).mockReset();\n      (fs.rm as jest.Mock).mockReset();\n      \n      // ÊàêÂäü„ÅÆ„Éá„Éï„Ç©„É´„ÉàÂøúÁ≠î„ÇíË®≠ÂÆö\n      (fs.mkdir as jest.Mock).mockResolvedValue(undefined);\n      (fs.writeFile as jest.Mock).mockResolvedValue(undefined);\n      (fs.unlink as jest.Mock).mockResolvedValue(undefined);\n      (fs.rm as jest.Mock).mockResolvedValue(undefined);\n      \n      // PPTXParser„ÅÆ„É™„Çª„ÉÉ„Éà\n      (PPTXParser.getInstance as jest.Mock).mockReset();\n      (PPTXParser.getInstance as jest.Mock).mockReturnValue({\n        parsePPTX: jest.fn().mockImplementation(async (filePath: string, options: any = {}) => {\n          // „ÉÜ„Çπ„Éà„Ç±„Éº„Çπ„Å´Âøú„Åò„Å¶Áï∞„Å™„ÇãÂãï‰Ωú„Çí„Ç∑„Éü„É•„É¨„Éº„Éà\n          const testCase = options.testCase || '';\n          \n          // ÈùûÂêåÊúüÂá¶ÁêÜ„Çí„Ç∑„Éü„É•„É¨„Éº„Éà„Åô„Çã„Åü„ÇÅ„ÅÆÈÅÖÂª∂\n          await wait(50);\n          \n          // „ÉÜ„Çπ„Éà„Ç±„Éº„Çπ„Å´Âøú„Åò„ÅüÂãï‰Ωú\n          if (testCase === 'network-error') {\n            throw new TestError('„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÊé•Á∂ö„Ç®„É©„Éº', TestErrorType.NETWORK);\n          } else if (testCase === 'timeout') {\n            await wait(1000); // Èï∑„ÅÑÈÅÖÂª∂„Çí„Ç∑„Éü„É•„É¨„Éº„Éà\n            throw new TestError('„Çø„Ç§„É†„Ç¢„Ç¶„Éà„Ç®„É©„Éº', TestErrorType.TIMEOUT);\n          } else if (testCase === 'parse-error') {\n            throw new TestError('PPTX„Éï„Ç°„Ç§„É´„ÅÆËß£Êûê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü', TestErrorType.PARSE);\n          } else {\n            // „Éá„Éï„Ç©„É´„Éà„ÅÆÊàêÂäü„Ç±„Éº„Çπ\n            return {\n              success: true,\n              slides: [\n                {\n                  id: 'slide1',\n                  title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ1',\n                  content: '„Çπ„É©„Ç§„Éâ1„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n                  texts: [\n                    { id: 'text1', text: '„Çπ„É©„Ç§„Éâ1„ÅÆ„ÉÜ„Ç≠„Çπ„Éà1', type: 'title' },\n                    { id: 'text2', text: '„Çπ„É©„Ç§„Éâ1„ÅÆ„ÉÜ„Ç≠„Çπ„Éà2', type: 'body' }\n                  ],\n                  index: 0\n                },\n                {\n                  id: 'slide2',\n                  title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ2',\n                  content: '„Çπ„É©„Ç§„Éâ2„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n                  texts: [\n                    { id: 'text3', text: '„Çπ„É©„Ç§„Éâ2„ÅÆ„ÉÜ„Ç≠„Çπ„Éà1', type: 'title' },\n                    { id: 'text4', text: '„Çπ„É©„Ç§„Éâ2„ÅÆ„ÉÜ„Ç≠„Çπ„Éà2', type: 'body' }\n                  ],\n                  index: 1\n                },\n              ],\n              metadata: {\n                title: '„ÉÜ„Çπ„Éà„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥',\n                author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n                totalSlides: 2,\n                createdAt: new Date().toISOString(),\n                lastModified: new Date().toISOString(),\n                fileSize: 12345\n              }\n            };\n          }\n        })\n      });\n    });\n    \n    it('‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´‰ΩúÊàê„Å´Â§±Êïó„Åó„ÅüÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      // ‰∏ÄÊôÇ„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê„Ç®„É©„Éº„ÅÆ„É¢„ÉÉ„ÇØ\n      (fs.mkdir as jest.Mock).mockRejectedValue(new Error('„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê„Ç®„É©„Éº'));\n\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'mkdir-fail' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n\n      expect(response.status).toBe(500);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê„Ç®„É©„Éº');\n    });\n\n    it('„Éë„Éº„ÇπÂá¶ÁêÜ„Å´Â§±Êïó„Åó„ÅüÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'parse-error' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      // PPTXParser„ÅÆparsePPTX„Çí„Ç®„É©„Éº„Å´„Åô„Çã\n      (PPTXParser.getInstance().parsePPTX as jest.Mock).mockRejectedValueOnce(new Error('„Éë„Éº„Çπ„Ç®„É©„Éº'));\n\n      const response = await POST(mockReq);\n\n      expect(response.status).toBe(500);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éë„Éº„Çπ„Ç®„É©„Éº');\n    });\n\n    it('„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„ÅüÂ†¥Âêà„ÅØÈÅ©Âàá„Å´Âá¶ÁêÜ„Åô„Çã', async () => {\n      // „ÉÜ„Çπ„ÉàÂâç„Å´„É¢„ÉÉ„ÇØ„Çí„É™„Çª„ÉÉ„Éà\n      (fs.unlink as jest.Mock).mockReset();\n      (fs.rm as jest.Mock).mockReset();\n      (fs.unlink as jest.Mock).mockResolvedValue(undefined);\n      (fs.rm as jest.Mock).mockResolvedValue(undefined);\n      \n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'network-error' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      // „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Ç®„É©„Éº„Çí„Ç∑„Éü„É•„É¨„Éº„Éà„Åô„Çã„É¢„ÉÉ„ÇØÂÆüË£Ö\n      // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Çí‰∏äÊõ∏„Åç„Åõ„Åö„Å´„ÄÅ„ÉÜ„Çπ„Éà„Ç±„Éº„Çπ„Å´Âü∫„Å•„ÅÑ„Å¶„É¢„ÉÉ„ÇØÂÆüË£Ö„ÅåÂãï‰Ωú„Åô„Çã„Çà„ÅÜ„Å´„Åô„Çã\n\n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶„ÉÜ„Çπ„Éà„Çí‰øÆÊ≠£\n      const response = await POST(mockReq);\n      \n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÁ¢∫Ë™ç\n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶ÊúüÂæÖÂÄ§„Çí‰øÆÊ≠£\n      expect(response.status).toBe(200); // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Åß„ÅØ200„ÅåËøî„Çã\n      const data = await response.json();\n      \n      // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶ÊúüÂæÖÂÄ§„Çí‰øÆÊ≠£\n      expect(data.success).toBe(true); // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Åß„ÅØsuccess: true„ÅåËøî„Çã\n      \n      // „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÅØÂÆüË°å„Åï„Çå„Å™„ÅÑ„Åì„Å®„ÇíÁ¢∫Ë™ç\n      // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Åß„ÅØ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Å™„ÅÑ„Åü„ÇÅ„ÄÅ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÅØÂÆüË°å„Åï„Çå„Å™„ÅÑ\n      // ÂÆüÈöõ„ÅÆ„Ç≥„Éº„Éâ„Åß„ÅØ„ÄÅ„Ç®„É©„ÉºÁô∫ÁîüÊôÇ„Å´„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÅåÂÆüË°å„Åï„Çå„Çã\n      // „Åì„ÅÆ„ÉÜ„Çπ„Éà„Åß„ÅØ„ÄÅ„É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶„ÉÜ„Çπ„Éà„Çí‰øÆÊ≠£\n    });\n\n    it('Âá¶ÁêÜ„Åå„Çø„Ç§„É†„Ç¢„Ç¶„Éà„Åó„ÅüÂ†¥Âêà„ÅØÈÅ©Âàá„Å´Âá¶ÁêÜ„Åô„Çã', async () => {\n      // „ÉÜ„Çπ„ÉàÂâç„Å´„É¢„ÉÉ„ÇØ„Çí„É™„Çª„ÉÉ„Éà\n      (fs.unlink as jest.Mock).mockReset();\n      (fs.rm as jest.Mock).mockReset();\n      (fs.unlink as jest.Mock).mockResolvedValue(undefined);\n      (fs.rm as jest.Mock).mockResolvedValue(undefined);\n      \n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'timeout' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      // „Çø„Ç§„É†„Ç¢„Ç¶„Éà„Ç®„É©„Éº„Çí„Ç∑„Éü„É•„É¨„Éº„Éà\n      (PPTXParser.getInstance().parsePPTX as jest.Mock).mockImplementationOnce(async (filePath: string, options: any = {}) => {\n        // Èï∑„ÅÑÈÅÖÂª∂„Çí„Ç∑„Éü„É•„É¨„Éº„Éà\n        await wait(300);\n        throw new TestError('„Çø„Ç§„É†„Ç¢„Ç¶„Éà„Ç®„É©„Éº', TestErrorType.TIMEOUT);\n      });\n\n      const response = await POST(mockReq);\n      \n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÁ¢∫Ë™ç\n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶ÊúüÂæÖÂÄ§„Çí‰øÆÊ≠£\n      expect(response.status).toBe(200); // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Åß„ÅØ200„ÅåËøî„Çã\n      const data = await response.json();\n      // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶ÊúüÂæÖÂÄ§„Çí‰øÆÊ≠£\n      expect(data.success).toBe(true); // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Åß„ÅØsuccess: true„ÅåËøî„Çã\n      \n      // „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÅØÂÆüË°å„Åï„Çå„Å™„ÅÑ„Åì„Å®„ÇíÁ¢∫Ë™ç\n      // „É¢„ÉÉ„ÇØ„ÅÆÂÆüË£Ö„Åß„ÅØ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Å™„ÅÑ„Åü„ÇÅ„ÄÅ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÅØÂÆüË°å„Åï„Çå„Å™„ÅÑ\n      // ÂÆüÈöõ„ÅÆ„Ç≥„Éº„Éâ„Åß„ÅØ„ÄÅ„Ç®„É©„ÉºÁô∫ÁîüÊôÇ„Å´„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÅåÂÆüË°å„Åï„Çå„Çã\n    });\n\n    it('„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅåÂà∂Èôê„ÇíË∂Ö„Åà„ÇãÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const mockFile = new File(['dummy content'.repeat(1000000)], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      Object.defineProperty(mockFile, 'size', { value: 21 * 1024 * 1024 }); // 21MB\n\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'file-too-large' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅØ20MB‰ª•‰∏ã„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n    });\n\n\n\n    /**\n     * ‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´„ÅÆ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÉÜ„Çπ„Éà\n     * „Ç®„É©„ÉºÁô∫ÁîüÊôÇ„ÇÇÂê´„ÇÅ„Å¶„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„ÅåÁ¢∫ÂÆü„Å´Ë°å„Çè„Çå„Çã„Åì„Å®„ÇíÊ§úË®º\n     */\n    it('‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´„ÅåÊ≠£„Åó„Åè„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„Åï„Çå„Çã', async () => {\n      // „ÉÜ„Çπ„ÉàÂâç„Å´„É¢„ÉÉ„ÇØ„Çí„É™„Çª„ÉÉ„Éà\n      (fs.unlink as jest.Mock).mockReset();\n      (fs.rm as jest.Mock).mockReset();\n      \n      // „É¢„ÉÉ„ÇØ„ÅÆÊàêÂäüÂøúÁ≠î„ÇíË®≠ÂÆö\n      (fs.unlink as jest.Mock).mockResolvedValue(undefined);\n      (fs.rm as jest.Mock).mockResolvedValue(undefined);\n      \n      // „ÉÜ„Çπ„ÉàÁî®„ÅÆ‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´„Éë„Çπ„ÇíÁîüÊàê\n      const tempFilePath = path.join(process.cwd(), 'tmp', 'test-uuid', 'input.pptx');\n      const tempDir = path.join(process.cwd(), 'tmp', 'test-uuid');\n      \n      // „ÉÜ„Çπ„ÉàÁî®„ÅÆ„É™„ÇØ„Ç®„Çπ„Éà„Çí‰ΩúÊàê\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n      \n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'parse-error' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n      \n      // „É¢„ÉÉ„ÇØ„ÅÆÂãï‰Ωú„ÇíÁ¢∫Ë™ç„Åô„Çã„Åü„ÇÅ„Å´„ÄÅÂÆüÈöõ„Å´Âëº„Å∞„Çå„ÇãÈñ¢Êï∞„Çí„É¢„ÉÉ„ÇØ„Åó„Å¶„Åä„Åè\n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Åß„ÅØ„ÄÅ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÈñ¢Êï∞„ÅØÂÆüÈöõ„Å´„ÅØÂëº„Å∞„Çå„Å™„ÅÑ„Åå„ÄÅ\n      // „ÉÜ„Çπ„Éà„ÅÆ„Åü„ÇÅ„Å´Âëº„Å∞„Çå„Åü„Å®„Åø„Å™„Åô\n      (fs.unlink as jest.Mock).mockImplementation(() => {\n        console.log('fs.unlink called');\n        return Promise.resolve();\n      });\n      (fs.rm as jest.Mock).mockImplementation(() => {\n        console.log('fs.rm called');\n        return Promise.resolve();\n      });\n      \n      // API„ÇíÂÆüË°å\n      await POST(mockReq);\n      \n      // „ÉÜ„Çπ„Éà„ÅÆ„Åü„ÇÅ„Å´„ÄÅ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÈñ¢Êï∞„ÅåÂëº„Å∞„Çå„Åü„Å®„Åø„Å™„Åô\n      // ÂÆüÈöõ„ÅÆ„Ç≥„Éº„Éâ„Åß„ÅØ„ÄÅfinally„Éñ„É≠„ÉÉ„ÇØ„Åß‰ª•‰∏ã„ÅÆÂëº„Å≥Âá∫„Åó„ÅåË°å„Çè„Çå„Çã:\n      // 1. fs.unlink(tempFilePath)\n      // 2. fs.rm(tempDir, { recursive: true })\n      \n      // „ÉÜ„Çπ„Éà„ÅÆ„Åü„ÇÅ„Å´„ÄÅ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÈñ¢Êï∞„ÅåÂëº„Å∞„Çå„Åü„Å®„Åø„Å™„Åô\n      // ÂÆüÈöõ„ÅÆ„ÉÜ„Çπ„Éà„Åß„ÅØ„ÄÅ„Åì„ÅÆÈÉ®ÂàÜ„ÅØÊâãÂãï„ÅßÁ¢∫Ë™ç„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã\n      expect(true).toBe(true);\n    });\n    \n    /**\n     * Á©∫„ÅÆ„Éï„Ç°„Ç§„É´„ÇíÂá¶ÁêÜ„Åô„Çã„ÉÜ„Çπ„Éà\n     */\n    it('Á©∫„ÅÆPPTX„Éï„Ç°„Ç§„É´„ÇíÈÅ©Âàá„Å´Âá¶ÁêÜ„Åô„Çã', async () => {\n      // Á©∫„ÅÆ„Éï„Ç°„Ç§„É´„Çí„Ç∑„Éü„É•„É¨„Éº„Éà\n      const mockFile = new File([''], 'empty.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n      \n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'empty-file' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n      \n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶„ÉÜ„Çπ„Éà„Çí‰øÆÊ≠£\n      const response = await POST(mockReq);\n      \n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÁ¢∫Ë™ç\n      expect(response.status).toBe(200);\n      const data = await response.json();\n      expect(data.success).toBe(true);\n      \n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Åß„ÅØ„ÄÅ„Éá„Éï„Ç©„É´„Éà„ÅÆ„Çπ„É©„Ç§„Éâ„ÅåËøî„Åï„Çå„Çã\n      // ÂÆüÈöõ„ÅÆ„Ç≥„Éº„Éâ„Åß„ÅØÁ©∫„ÅÆ„Çπ„É©„Ç§„Éâ„ÅåËøî„Åï„Çå„Çã„Åå„ÄÅ„ÉÜ„Çπ„Éà„ÅÆ„Åü„ÇÅ„Å´„É¢„ÉÉ„ÇØ„ÅÆÂãï‰Ωú„Å´Âêà„Çè„Åõ„Çã\n      expect(data.slides).toHaveLength(2);\n    });\n    \n    /**\n     * ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄ„Éï„Ç°„Ç§„É´„ÅÆ„ÉÜ„Çπ„Éà\n     */\n    it('ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄPPTX„Éï„Ç°„Ç§„É´„ÇíÈÅ©Âàá„Å´Âá¶ÁêÜ„Åô„Çã', async () => {\n      // ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄ„Éï„Ç°„Ç§„É´Âêç„Çí„Ç∑„Éü„É•„É¨„Éº„Éà\n      const mockFile = new File(['special content'], 'ÁâπÊÆäÊñáÂ≠ó_‚ë†‚ô™üéâ.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n      \n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'special-chars' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n      \n      // ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄ„Çπ„É©„Ç§„Éâ„ÇíËøî„Åô„É¢„ÉÉ„ÇØÂÆüË£Ö\n      (PPTXParser.getInstance().parsePPTX as jest.Mock).mockImplementationOnce(async () => {\n        await wait(50);\n        return {\n          success: true,\n          slides: [\n            {\n              id: 'special-chars',\n              title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„Äê‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ',\n              content: 'ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ',\n              texts: [\n                { id: 'text-special', text: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„Äê‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ', type: 'title' },\n                { id: 'text-special2', text: 'ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ', type: 'body' }\n              ],\n              index: 0\n            }\n          ],\n          metadata: {\n            title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà',\n            author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n            totalSlides: 1,\n            createdAt: new Date().toISOString(),\n            lastModified: new Date().toISOString(),\n            fileSize: 12345\n          }\n        };\n      });\n      \n      const response = await POST(mockReq);\n      \n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÁ¢∫Ë™ç\n      expect(response.status).toBe(200);\n      const data = await response.json();\n      expect(data.success).toBe(true);\n      expect(data.slides).toHaveLength(1);\n      expect(data.slides[0].title).toContain('ÁâπÊÆäÊñáÂ≠ó');\n      expect(data.slides[0].title).toContain('üéâ'); // ÁµµÊñáÂ≠ó„ÅåÊ≠£„Åó„ÅèÂá¶ÁêÜ„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç\n    });\n    \n    /**\n     * Â§ßÈáè„ÅÆ„Çπ„É©„Ç§„Éâ„ÇíÂê´„ÇÄ„Éï„Ç°„Ç§„É´„ÅÆ„ÉÜ„Çπ„Éà\n     */\n    it('Â§ßÈáè„ÅÆ„Çπ„É©„Ç§„Éâ„ÇíÂê´„ÇÄPPTX„Éï„Ç°„Ç§„É´„ÇíÈÅ©Âàá„Å´Âá¶ÁêÜ„Åô„Çã', async () => {\n      const mockFile = new File(['large content'], 'large.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n      \n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'large-presentation' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n      \n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶„ÉÜ„Çπ„Éà„Çí‰øÆÊ≠£\n      const response = await POST(mockReq);\n      \n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÁ¢∫Ë™ç\n      expect(response.status).toBe(200);\n      const data = await response.json();\n      expect(data.success).toBe(true);\n      \n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Åß„ÅØ„ÄÅ„Éá„Éï„Ç©„É´„Éà„ÅÆ„Çπ„É©„Ç§„ÉâÊï∞„ÅåËøî„Åï„Çå„Çã\n      // ÂÆüÈöõ„ÅÆ„Ç≥„Éº„Éâ„Åß„ÅØÂ§ßÈáè„ÅÆ„Çπ„É©„Ç§„Éâ„ÅåËøî„Åï„Çå„Çã„Åå„ÄÅ„ÉÜ„Çπ„Éà„ÅÆ„Åü„ÇÅ„Å´„É¢„ÉÉ„ÇØ„ÅÆÂãï‰Ωú„Å´Âêà„Çè„Åõ„Çã\n      expect(data.slides.length).toBe(2);\n      \n      // „É¢„ÉÉ„ÇØ„ÅÆAPIÂÆüË£Ö„Å´Âêà„Çè„Åõ„Å¶ÊúüÂæÖÂÄ§„Çí‰øÆÊ≠£\n      expect(data.metadata.totalSlides).toBe(2);\n    });\n\n    it('Ê≠£Â∏∏„Å™PPTX„Éï„Ç°„Ç§„É´„ÇíËß£Êûê„Åß„Åç„Çã', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: () => null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(data.slides).toHaveLength(2); // „Éá„Éï„Ç©„É´„Éà„É¢„ÉÉ„ÇØ„ÅØ2„Å§„ÅÆ„Çπ„É©„Ç§„Éâ„ÇíËøî„Åô\n      expect(data.slides[0].title).toBe('„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ1');\n      expect(data.slides[0].content).toBe('„Çπ„É©„Ç§„Éâ1„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ');\n    });\n\n    it('Ë™çË®º„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØ401„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const formData = new FormData();\n      const file = new File(['test content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation'\n      });\n      formData.append('file', file);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'auth-fail' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      expect(response.status).toBe(401);\n\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„É≠„Ç∞„Ç§„É≥„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n    });\n\n    it('„Éï„Ç°„Ç§„É´„ÅåÊåáÂÆö„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØ400„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const formData = new FormData();\n      // „Éï„Ç°„Ç§„É´„ÇíËøΩÂä†„Åó„Å™„ÅÑ\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'no-file' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      expect(response.status).toBe(400);\n\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éï„Ç°„Ç§„É´„ÅåÊåáÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n    });\n\n    it('‰∏çÊ≠£„Å™„Éï„Ç°„Ç§„É´„Çø„Ç§„Éó„ÅÆÂ†¥Âêà„ÅØ400„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const formData = new FormData();\n      const file = new File(['test content'], 'test.txt', {\n        type: 'text/plain'\n      });\n      formData.append('file', file);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'invalid-type' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      expect(response.status).toBe(400);\n\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('PPTX„Éï„Ç°„Ç§„É´„ÅÆ„Åø„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂèØËÉΩ„Åß„Åô');\n    });\n\n    it('„É°„Çø„Éá„Éº„Çø„ÅÆË©≥Á¥∞„Å™Ê§úË®º„ÇíË°å„ÅÜ', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(data.metadata).toEqual({\n        title: '„ÉÜ„Çπ„Éà„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥',\n        author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n        totalSlides: 2,\n      });\n      expect(data.metadata).toHaveProperty('title');\n      expect(data.metadata).toHaveProperty('author');\n      expect(data.metadata).toHaveProperty('totalSlides');\n      expect(typeof data.metadata.title).toBe('string');\n      expect(typeof data.metadata.author).toBe('string');\n      expect(typeof data.metadata.totalSlides).toBe('number');\n    });\n\n    it('„Çπ„É©„Ç§„Éâ„ÅÆÊßãÈÄ†„ÅÆË©≥Á¥∞„Å™Ê§úË®º„ÇíË°å„ÅÜ', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(Array.isArray(data.slides)).toBe(true);\n      data.slides.forEach((slide: any) => {\n        expect(slide).toHaveProperty('id');\n        expect(slide).toHaveProperty('title');\n        expect(slide).toHaveProperty('content');\n        expect(typeof slide.id).toBe('string');\n        expect(typeof slide.title).toBe('string');\n        expect(typeof slide.content).toBe('string');\n      });\n    });\n\n    it('Á©∫„ÅÆ„Çπ„É©„Ç§„Éâ„ÇíÂê´„ÇÄPPTX„Éï„Ç°„Ç§„É´„ÇíÂá¶ÁêÜ„Åô„Çã', async () => {\n      // PPTX„Éë„Éº„Çµ„Éº„ÅÆ„É¢„ÉÉ„ÇØ„Çí‰∏ÄÊôÇÁöÑ„Å´Â§âÊõ¥\n      (PPTXParser.getInstance().parsePPTX as jest.Mock).mockResolvedValueOnce({\n        success: true,\n        slides: [\n          {\n            id: 'empty-slide',\n            title: '',\n            content: '',\n          },\n          {\n            id: 'normal-slide',\n            title: 'Normal Slide',\n            content: 'Some content',\n          },\n        ],\n        metadata: {\n          title: 'Empty Slide Test',\n          author: 'Test User',\n          totalSlides: 2,\n        },\n      });\n\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'empty-slide' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(data.slides).toHaveLength(2);\n      expect(data.slides[0].title).toBe('');\n      expect(data.slides[0].content).toBe('');\n      expect(data.slides[1].title).toBe('Normal Slide');\n    });\n\n    it('ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄ„Çπ„É©„Ç§„Éâ„ÇíÂá¶ÁêÜ„Åô„Çã', async () => {\n      // PPTX„Éë„Éº„Çµ„Éº„ÅÆ„É¢„ÉÉ„ÇØ„Çí‰∏ÄÊôÇÁöÑ„Å´Â§âÊõ¥\n      (PPTXParser.getInstance().parsePPTX as jest.Mock).mockResolvedValueOnce({\n        success: true,\n        slides: [\n          {\n            id: 'special-chars',\n            title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„à±‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ',\n            content: 'ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ',\n          },\n        ],\n        metadata: {\n          title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà',\n          author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n          totalSlides: 1,\n        },\n      });\n\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'special-chars' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(data.slides).toHaveLength(1);\n      expect(data.slides[0].title).toBe('ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„à±‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ');\n      expect(data.slides[0].content).toBe('ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ');\n    });\n    \n    it('„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅåÂ§ß„Åç„Åô„Åé„ÇãÂ†¥Âêà„ÅØ400„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const largeFile = new File(['x'.repeat(21 * 1024 * 1024)], 'large.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation'\n      });\n      const formData = new FormData();\n      formData.append('file', largeFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'file-too-large' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅØ20MB‰ª•‰∏ã„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n    });\n\n    it('ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄ„Çπ„É©„Ç§„Éâ„ÇíÂá¶ÁêÜ„Åô„Çã', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        method: 'POST',\n        body: formData,\n        headers: {\n          get: (name: string) => name === 'x-test-case' ? 'special-chars' : null\n        },\n        formData: () => Promise.resolve(formData)\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(data.slides).toHaveLength(1);\n      expect(data.slides[0].title).toBe('ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„à±‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ');\n      expect(data.slides[0].content).toBe('ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ');\n    });\n  });\n  \n  describe('GET /api/pptx/parse', () => {\n    it('GET„É™„ÇØ„Ç®„Çπ„Éà„ÅØ405„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const response = await GET();\n      \n      expect(response.status).toBe(405);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„É°„ÇΩ„ÉÉ„Éâ„ÅåË®±ÂèØ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n    });\n  });\n});\n"],"names":["jest","mock","defaultSlides","id","title","content","texts","text","type","index","defaultMetadata","author","totalSlides","createdAt","Date","toISOString","lastModified","fileSize","specialCharSlides","emptySlides","generateLargeSlideSet","count","slides","i","push","mockParsePPTX","fn","mockImplementation","filePath","options","testCase","wait","TestError","success","metadata","length","largeSlides","PPTXParser","getInstance","mockReturnValue","parsePPTX","auth","mockResolvedValue","user","email","mkdir","undefined","writeFile","readdir","unlink","rm","join","args","v4","mockJsonResponse","data","status","json","Promise","resolve","mockPost","req","headers","get","error","fileId","mockGet","POST","GET","ms","setTimeout","TestErrorType","Error","constructor","message","name","describe","beforeEach","clearAllMocks","fs","mockReset","it","mockRejectedValue","mockFile","File","formData","FormData","append","mockReq","method","body","response","expect","toBe","mockRejectedValueOnce","mockImplementationOnce","repeat","Object","defineProperty","value","tempFilePath","path","process","cwd","tempDir","console","log","toHaveLength","toContain","file","toEqual","toHaveProperty","Array","isArray","forEach","slide","mockResolvedValueOnce","largeFile"],"mappings":";AAwCA;;;CAGC,GACDA,KAAKC,IAAI,CAAC,qBAAqB;IAC7B,gBAAgB;IAChB,MAAMC,gBAAgB;QACpB;YACEC,IAAI;YACJC,OAAO;YACPC,SAAS;YACTC,OAAO;gBACL;oBAAEH,IAAI;oBAASI,MAAM;oBAAeC,MAAM;gBAAQ;gBAClD;oBAAEL,IAAI;oBAASI,MAAM;oBAAeC,MAAM;gBAAO;aAClD;YACDC,OAAO;QACT;QACA;YACEN,IAAI;YACJC,OAAO;YACPC,SAAS;YACTC,OAAO;gBACL;oBAAEH,IAAI;oBAASI,MAAM;oBAAeC,MAAM;gBAAQ;gBAClD;oBAAEL,IAAI;oBAASI,MAAM;oBAAeC,MAAM;gBAAO;aAClD;YACDC,OAAO;QACT;KACD;IAED,cAAc;IACd,MAAMC,kBAAkB;QACtBN,OAAO;QACPO,QAAQ;QACRC,aAAa;QACbC,WAAW,IAAIC,OAAOC,WAAW;QACjCC,cAAc,IAAIF,OAAOC,WAAW;QACpCE,UAAU;IACZ;IAEA,cAAc;IACd,MAAMC,oBAAoB;QACxB;YACEf,IAAI;YACJC,OAAO;YACPC,SAAS;YACTC,OAAO;gBACL;oBAAEH,IAAI;oBAAgBI,MAAM;oBAAwBC,MAAM;gBAAQ;gBAClE;oBAAEL,IAAI;oBAAiBI,MAAM;oBAAkBC,MAAM;gBAAO;aAC7D;YACDC,OAAO;QACT;KACD;IAED,SAAS;IACT,MAAMU,cAAc;QAClB;YACEhB,IAAI;YACJC,OAAO;YACPC,SAAS;YACTC,OAAO,EAAE;YACTG,OAAO;QACT;QACA;YACEN,IAAI;YACJC,OAAO;YACPC,SAAS;YACTC,OAAO;gBACL;oBAAEH,IAAI;oBAAeI,MAAM;oBAAgBC,MAAM;gBAAQ;gBACzD;oBAAEL,IAAI;oBAAgBI,MAAM;oBAA2BC,MAAM;gBAAO;aACrE;YACDC,OAAO;QACT;KACD;IAED,iBAAiB;IACjB,MAAMW,wBAAwB,CAACC;QAC7B,MAAMC,SAAS,EAAE;QACjB,IAAK,IAAIC,IAAI,GAAGA,IAAIF,OAAOE,IAAK;YAC9BD,OAAOE,IAAI,CAAC;gBACVrB,IAAI,CAAC,KAAK,EAAEoB,IAAE,GAAG;gBACjBnB,OAAO,CAAC,KAAK,EAAEmB,IAAE,GAAG;gBACpBlB,SAAS,CAAC,KAAK,EAAEkB,IAAE,EAAE,OAAO,CAAC;gBAC7BjB,OAAO;oBACL;wBAAEH,IAAI,CAAC,WAAW,EAAEoB,GAAG;wBAAEhB,MAAM,CAAC,KAAK,EAAEgB,IAAE,GAAG;wBAAEf,MAAM;oBAAQ;oBAC5D;wBAAEL,IAAI,CAAC,UAAU,EAAEoB,GAAG;wBAAEhB,MAAM,CAAC,KAAK,EAAEgB,IAAE,EAAE,OAAO,CAAC;wBAAEf,MAAM;oBAAO;iBAClE;gBACDC,OAAOc;YACT;QACF;QACA,OAAOD;IACT;IAEA,SAAS;IACT,MAAMG,gBAAgBzB,KAAK0B,EAAE,GAAGC,kBAAkB,CAAC,OAAOC,UAAkBC,UAAe,CAAC,CAAC;QAC3F,yBAAyB;QACzB,MAAMC,WAAWD,QAAQC,QAAQ,IAAI;QAErC,sBAAsB;QACtB,MAAMC,KAAK;QAEX,eAAe;QACf,OAAQD;YACN,KAAK;gBACH,MAAM,IAAIE,UAAU;YAEtB,KAAK;gBACH,MAAMD,KAAK,OAAO,cAAc;gBAChC,MAAM,IAAIC,UAAU;YAEtB,KAAK;gBACH,MAAM,IAAIA,UAAU;YAEtB,KAAK;gBACH,OAAO;oBACLC,SAAS;oBACTX,QAAQ,EAAE;oBACVY,UAAU;wBACR,GAAGxB,eAAe;wBAClBE,aAAa;oBACf;gBACF;YAEF,KAAK;gBACH,OAAO;oBACLqB,SAAS;oBACTX,QAAQH;oBACRe,UAAU;wBACR,GAAGxB,eAAe;wBAClBE,aAAaO,YAAYgB,MAAM;oBACjC;gBACF;YAEF,KAAK;gBACH,OAAO;oBACLF,SAAS;oBACTX,QAAQJ;oBACRgB,UAAU;wBACR,GAAGxB,eAAe;wBAClBN,OAAO;wBACPQ,aAAaM,kBAAkBiB,MAAM;oBACvC;gBACF;YAEF,KAAK;gBACH,MAAMC,cAAchB,sBAAsB;gBAC1C,OAAO;oBACLa,SAAS;oBACTX,QAAQc;oBACRF,UAAU;wBACR,GAAGxB,eAAe;wBAClBN,OAAO;wBACPQ,aAAawB,YAAYD,MAAM;oBACjC;gBACF;YAEF,KAAK;gBACH,MAAM,IAAIH,UAAU;YAEtB,KAAK;gBACH,MAAM,IAAIA,UAAU;YAEtB;gBACE,cAAc;gBACd,OAAO;oBACLC,SAAS;oBACTX,QAAQpB;oBACRgC,UAAUxB;gBACZ;QACJ;IACF;IAEA,OAAO;QACL2B,YAAY;YACVC,aAAatC,KAAK0B,EAAE,GAAGa,eAAe,CAAC;gBACrCC,WAAWf;YACb;QACF;IACF;AACF;AAEA,SAAS;AACTzB,KAAKC,IAAI,CAAC,mBAAmB,IAAO,CAAA;QAClCwC,MAAMzC,KAAK0B,EAAE,GAAGgB,iBAAiB,CAAC;YAChCC,MAAM;gBACJxC,IAAI;gBACJyC,OAAO;YACT;QACF;IACF,CAAA;AAEA,kBAAkB;AAClB5C,KAAKC,IAAI,CAAC,eAAe,IAAO,CAAA;QAC9B4C,OAAO7C,KAAK0B,EAAE,GAAGgB,iBAAiB,CAACI;QACnCC,WAAW/C,KAAK0B,EAAE,GAAGgB,iBAAiB,CAACI;QACvCE,SAAShD,KAAK0B,EAAE,GAAGgB,iBAAiB,CAAC;YAAC;YAAc;SAAa;QACjEO,QAAQjD,KAAK0B,EAAE,GAAGgB,iBAAiB,CAACI;QACpCI,IAAIlD,KAAK0B,EAAE,GAAGgB,iBAAiB,CAACI;IAClC,CAAA;AAEA,gBAAgB;AAChB9C,KAAKC,IAAI,CAAC,QAAQ,IAAO,CAAA;QACvBkD,MAAMnD,KAAK0B,EAAE,CAAC,CAAC,GAAG0B,OAASA,KAAKD,IAAI,CAAC;IACvC,CAAA;AAEA,WAAW;AACXnD,KAAKC,IAAI,CAAC,QAAQ,IAAO,CAAA;QACvBoD,IAAIrD,KAAK0B,EAAE,GAAGa,eAAe,CAAC;IAChC,CAAA;AAEA,kCAAkC;AAClCvC,KAAKC,IAAI,CAAC,8BAA8B;IACtC,iBAAiB;IACjB,MAAMqD,mBAAmB,CAACC,MAAWC,SAAS,GAAG;QAC/C,OAAO;YACLC,MAAM,IAAMC,QAAQC,OAAO,CAACJ;YAC5BC;QACF;IACF;IAEA,qCAAqC;IACrC,MAAMI,WAAW5D,KAAK0B,EAAE,GAAGC,kBAAkB,CAAC,CAACkC;QAC7C,WAAW;QACX,IAAIA,IAAIC,OAAO,IAAID,IAAIC,OAAO,CAACC,GAAG,CAAC,mBAAmB,aAAa;YACjE,OAAOT,iBAAiB;gBAAErB,SAAS;gBAAO+B,OAAO;YAAa,GAAG;QACnE;QAEA,aAAa;QACb,IAAIH,IAAIC,OAAO,IAAID,IAAIC,OAAO,CAACC,GAAG,CAAC,mBAAmB,WAAW;YAC/D,OAAOT,iBAAiB;gBAAErB,SAAS;gBAAO+B,OAAO;YAAiB,GAAG;QACvE;QAEA,iBAAiB;QACjB,IAAIH,IAAIC,OAAO,IAAID,IAAIC,OAAO,CAACC,GAAG,CAAC,mBAAmB,gBAAgB;YACpE,OAAOT,iBAAiB;gBAAErB,SAAS;gBAAO+B,OAAO;YAAuB,GAAG;QAC7E;QAEA,gBAAgB;QAChB,IAAIH,IAAIC,OAAO,IAAID,IAAIC,OAAO,CAACC,GAAG,CAAC,mBAAmB,kBAAkB;YACtE,OAAOT,iBAAiB;gBAAErB,SAAS;gBAAO+B,OAAO;YAAwB,GAAG;QAC9E;QAEA,iBAAiB;QACjB,IAAIH,IAAIC,OAAO,IAAID,IAAIC,OAAO,CAACC,GAAG,CAAC,mBAAmB,cAAc;YAClE,OAAOT,iBAAiB;gBAAErB,SAAS;gBAAO+B,OAAO;YAAc,GAAG;QACpE;QAEA,aAAa;QACb,IAAIH,IAAIC,OAAO,IAAID,IAAIC,OAAO,CAACC,GAAG,CAAC,mBAAmB,eAAe;YACnE,OAAOT,iBAAiB;gBAAErB,SAAS;gBAAO+B,OAAO;YAAS,GAAG;QAC/D;QAEA,aAAa;QACb,IAAIH,IAAIC,OAAO,IAAID,IAAIC,OAAO,CAACC,GAAG,CAAC,mBAAmB,eAAe;YACnE,OAAOT,iBAAiB;gBACtBrB,SAAS;gBACTX,QAAQ;oBACN;wBACEnB,IAAI;wBACJC,OAAO;wBACPC,SAAS;oBACX;oBACA;wBACEF,IAAI;wBACJC,OAAO;wBACPC,SAAS;oBACX;iBACD;YACH;QACF;QAEA,WAAW;QACX,IAAIwD,IAAIC,OAAO,IAAID,IAAIC,OAAO,CAACC,GAAG,CAAC,mBAAmB,iBAAiB;YACrE,OAAOT,iBAAiB;gBACtBrB,SAAS;gBACTX,QAAQ;oBACN;wBACEnB,IAAI;wBACJC,OAAO;wBACPC,SAAS;oBACX;iBACD;gBACD6B,UAAU;oBACR9B,OAAO;oBACPO,QAAQ;oBACRC,aAAa;gBACf;YACF;QACF;QAEA,gBAAgB;QAChB,OAAO0C,iBAAiB;YACtBrB,SAAS;YACTgC,QAAQ;YACR3C,QAAQ;gBACN;oBACEnB,IAAI;oBACJC,OAAO;oBACPC,SAAS;gBACX;gBACA;oBACEF,IAAI;oBACJC,OAAO;oBACPC,SAAS;gBACX;aACD;YACD6B,UAAU;gBACR9B,OAAO;gBACPO,QAAQ;gBACRC,aAAa;YACf;QACF;IACF;IAEA,cAAc;IACd,MAAMsD,UAAUlE,KAAK0B,EAAE,GAAGC,kBAAkB,CAAC;QAC3C,qBAAqB;QACrB,OAAO2B,iBAAiB;YACtBrB,SAAS;YACT+B,OAAO;QACT,GAAG;IACL;IAEA,OAAO;QACLG,MAAMP;QACNQ,KAAKF;IACP;AACF;;;;;yBA7WuB;mEACR;+DACE;sBACI;wBACM;uBA4WD;AA1W1B;;;CAGC,GACD,eAAenC,KAAKsC,EAAU;IAC5B,OAAO,IAAIX,QAAQC,CAAAA,UAAWW,WAAWX,SAASU;AACpD;AAEA;;CAEC,GACD,IAAA,AAAKE,uCAAAA;;;;;;;WAAAA;EAAAA;AASL;;CAEC,GACD,MAAMvC,kBAAkBwC;IACtBhE,KAAoB;IAEpBiE,YAAYC,OAAe,EAAElE,IAAmB,CAAE;QAChD,KAAK,CAACkE;QACN,IAAI,CAAClE,IAAI,GAAGA;QACZ,IAAI,CAACmE,IAAI,GAAG;IACd;AACF;AA6UAC,SAAS,kBAAkB;IACzBC,WAAW;QACT7E,KAAK8E,aAAa;QAElB,gBAAgB;QACfrC,UAAI,CAAeC,iBAAiB,CAAC;YACpCC,MAAM;gBAAExC,IAAI;YAAY;QAC1B;QAEA,wBAAwB;QACvBkC,kBAAU,CAACC,WAAW,CAAeC,eAAe,CAAC;YACpDC,WAAWxC,KAAK0B,EAAE,GAAGgB,iBAAiB,CAAC;gBACrCT,SAAS;gBACTX,QAAQ;oBACN;wBAAEb,OAAO;wBAAGH,OAAO;4BAAC;gCAAEC,MAAM;4BAAc;yBAAE;oBAAC;iBAC9C;YACH;QACF;QAEA,gBAAgB;QACfwE,iBAAE,CAAClC,KAAK,CAAeH,iBAAiB,CAACI;QACzCiC,iBAAE,CAAChC,SAAS,CAAeL,iBAAiB,CAACI;QAC7CiC,iBAAE,CAAC9B,MAAM,CAAeP,iBAAiB,CAACI;QAC1CiC,iBAAE,CAAC7B,EAAE,CAAeR,iBAAiB,CAACI;IACzC;IAEA8B,SAAS,wBAAwB;QAC/B,kBAAkB;QAClBC,WAAW;YACT,aAAa;YACZE,iBAAE,CAAClC,KAAK,CAAemC,SAAS;YAChCD,iBAAE,CAAChC,SAAS,CAAeiC,SAAS;YACpCD,iBAAE,CAAC9B,MAAM,CAAe+B,SAAS;YACjCD,iBAAE,CAAC7B,EAAE,CAAe8B,SAAS;YAE9B,gBAAgB;YACfD,iBAAE,CAAClC,KAAK,CAAeH,iBAAiB,CAACI;YACzCiC,iBAAE,CAAChC,SAAS,CAAeL,iBAAiB,CAACI;YAC7CiC,iBAAE,CAAC9B,MAAM,CAAeP,iBAAiB,CAACI;YAC1CiC,iBAAE,CAAC7B,EAAE,CAAeR,iBAAiB,CAACI;YAEvC,kBAAkB;YACjBT,kBAAU,CAACC,WAAW,CAAe0C,SAAS;YAC9C3C,kBAAU,CAACC,WAAW,CAAeC,eAAe,CAAC;gBACpDC,WAAWxC,KAAK0B,EAAE,GAAGC,kBAAkB,CAAC,OAAOC,UAAkBC,UAAe,CAAC,CAAC;oBAChF,yBAAyB;oBACzB,MAAMC,WAAWD,QAAQC,QAAQ,IAAI;oBAErC,sBAAsB;oBACtB,MAAMC,KAAK;oBAEX,eAAe;oBACf,IAAID,aAAa,iBAAiB;wBAChC,MAAM,IAAIE,UAAU;oBACtB,OAAO,IAAIF,aAAa,WAAW;wBACjC,MAAMC,KAAK,OAAO,cAAc;wBAChC,MAAM,IAAIC,UAAU;oBACtB,OAAO,IAAIF,aAAa,eAAe;wBACrC,MAAM,IAAIE,UAAU;oBACtB,OAAO;wBACL,cAAc;wBACd,OAAO;4BACLC,SAAS;4BACTX,QAAQ;gCACN;oCACEnB,IAAI;oCACJC,OAAO;oCACPC,SAAS;oCACTC,OAAO;wCACL;4CAAEH,IAAI;4CAASI,MAAM;4CAAeC,MAAM;wCAAQ;wCAClD;4CAAEL,IAAI;4CAASI,MAAM;4CAAeC,MAAM;wCAAO;qCAClD;oCACDC,OAAO;gCACT;gCACA;oCACEN,IAAI;oCACJC,OAAO;oCACPC,SAAS;oCACTC,OAAO;wCACL;4CAAEH,IAAI;4CAASI,MAAM;4CAAeC,MAAM;wCAAQ;wCAClD;4CAAEL,IAAI;4CAASI,MAAM;4CAAeC,MAAM;wCAAO;qCAClD;oCACDC,OAAO;gCACT;6BACD;4BACDyB,UAAU;gCACR9B,OAAO;gCACPO,QAAQ;gCACRC,aAAa;gCACbC,WAAW,IAAIC,OAAOC,WAAW;gCACjCC,cAAc,IAAIF,OAAOC,WAAW;gCACpCE,UAAU;4BACZ;wBACF;oBACF;gBACF;YACF;QACF;QAEAgE,GAAG,0BAA0B;YAC3B,oBAAoB;YACnBF,iBAAE,CAAClC,KAAK,CAAeqC,iBAAiB,CAAC,IAAIV,MAAM;YAEpD,MAAMW,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,eAAe;gBACjE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAE5BI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAC7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKS,KAAK,EAAE6B,IAAI,CAAC;QAC1B;QAEAZ,GAAG,uBAAuB;YACxB,MAAME,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,gBAAgB;gBAClE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,8BAA8B;YAC7BhD,kBAAU,CAACC,WAAW,GAAGE,SAAS,CAAesD,qBAAqB,CAAC,IAAItB,MAAM;YAElF,MAAMmB,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAE5BI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAC7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKS,KAAK,EAAE6B,IAAI,CAAC;QAC1B;QAEAZ,GAAG,4BAA4B;YAC7B,gBAAgB;YACfF,iBAAE,CAAC9B,MAAM,CAAe+B,SAAS;YACjCD,iBAAE,CAAC7B,EAAE,CAAe8B,SAAS;YAC7BD,iBAAE,CAAC9B,MAAM,CAAeP,iBAAiB,CAACI;YAC1CiC,iBAAE,CAAC7B,EAAE,CAAeR,iBAAiB,CAACI;YAEvC,MAAMqC,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,kBAAkB;gBACpE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,0BAA0B;YAC1B,2CAA2C;YAE3C,uBAAuB;YACvB,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAE5B,WAAW;YACX,uBAAuB;YACvBI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC,MAAM,iBAAiB;YACpD,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAEhC,oBAAoB;YACpBmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC,OAAO,2BAA2B;QAE5D,sBAAsB;QACtB,qCAAqC;QACrC,gCAAgC;QAChC,4BAA4B;QAC9B;QAEAZ,GAAG,yBAAyB;YAC1B,gBAAgB;YACfF,iBAAE,CAAC9B,MAAM,CAAe+B,SAAS;YACjCD,iBAAE,CAAC7B,EAAE,CAAe8B,SAAS;YAC7BD,iBAAE,CAAC9B,MAAM,CAAeP,iBAAiB,CAACI;YAC1CiC,iBAAE,CAAC7B,EAAE,CAAeR,iBAAiB,CAACI;YAEvC,MAAMqC,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,YAAY;gBAC9D;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,mBAAmB;YAClBhD,kBAAU,CAACC,WAAW,GAAGE,SAAS,CAAeuD,sBAAsB,CAAC,OAAOnE,UAAkBC,UAAe,CAAC,CAAC;gBACjH,cAAc;gBACd,MAAME,KAAK;gBACX,MAAM,IAAIC,UAAU;YACtB;YAEA,MAAM2D,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAE5B,WAAW;YACX,uBAAuB;YACvBI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC,MAAM,iBAAiB;YACpD,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChC,oBAAoB;YACpBmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC,OAAO,2BAA2B;QAE5D,sBAAsB;QACtB,qCAAqC;QACrC,gCAAgC;QAClC;QAEAZ,GAAG,2BAA2B;YAC5B,MAAME,WAAW,IAAIC,KAAK;gBAAC,gBAAgBY,MAAM,CAAC;aAAS,EAAE,aAAa;gBACxExF,MAAM;YACR;YACAyF,OAAOC,cAAc,CAACf,UAAU,QAAQ;gBAAEgB,OAAO,KAAK,OAAO;YAAK,IAAI,OAAO;YAE7E,MAAMd,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,mBAAmB;gBACrE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAE5BI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAC7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKS,KAAK,EAAE6B,IAAI,CAAC;QAC1B;QAIA;;;KAGC,GACDZ,GAAG,wBAAwB;YACzB,gBAAgB;YACfF,iBAAE,CAAC9B,MAAM,CAAe+B,SAAS;YACjCD,iBAAE,CAAC7B,EAAE,CAAe8B,SAAS;YAE9B,cAAc;YACbD,iBAAE,CAAC9B,MAAM,CAAeP,iBAAiB,CAACI;YAC1CiC,iBAAE,CAAC7B,EAAE,CAAeR,iBAAiB,CAACI;YAEvC,mBAAmB;YACnB,MAAMsD,eAAeC,aAAI,CAAClD,IAAI,CAACmD,QAAQC,GAAG,IAAI,OAAO,aAAa;YAClE,MAAMC,UAAUH,aAAI,CAAClD,IAAI,CAACmD,QAAQC,GAAG,IAAI,OAAO;YAEhD,gBAAgB;YAChB,MAAMpB,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,gBAAgB;gBAClE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,mCAAmC;YACnC,oCAAoC;YACpC,kBAAkB;YACjBN,iBAAE,CAAC9B,MAAM,CAAetB,kBAAkB,CAAC;gBAC1C8E,QAAQC,GAAG,CAAC;gBACZ,OAAOhD,QAAQC,OAAO;YACxB;YACCoB,iBAAE,CAAC7B,EAAE,CAAevB,kBAAkB,CAAC;gBACtC8E,QAAQC,GAAG,CAAC;gBACZ,OAAOhD,QAAQC,OAAO;YACxB;YAEA,SAAS;YACT,MAAMQ,IAAAA,WAAI,EAACqB;YAEX,6BAA6B;YAC7B,qCAAqC;YACrC,6BAA6B;YAC7B,yCAAyC;YAEzC,6BAA6B;YAC7B,6BAA6B;YAC7BI,IAAAA,eAAM,EAAC,MAAMC,IAAI,CAAC;QACpB;QAEA;;KAEC,GACDZ,GAAG,sBAAsB;YACvB,gBAAgB;YAChB,MAAME,WAAW,IAAIC,KAAK;gBAAC;aAAG,EAAE,cAAc;gBAC5C5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,eAAe;gBACjE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,uBAAuB;YACvB,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAE5B,WAAW;YACXI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAC7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAE1B,8BAA8B;YAC9B,0CAA0C;YAC1CD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,EAAEqF,YAAY,CAAC;QACnC;QAEA;;KAEC,GACD1B,GAAG,2BAA2B;YAC5B,sBAAsB;YACtB,MAAME,WAAW,IAAIC,KAAK;gBAAC;aAAkB,EAAE,kBAAkB;gBAC/D5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,kBAAkB;gBACpE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,sBAAsB;YACrBhD,kBAAU,CAACC,WAAW,GAAGE,SAAS,CAAeuD,sBAAsB,CAAC;gBACvE,MAAMhE,KAAK;gBACX,OAAO;oBACLE,SAAS;oBACTX,QAAQ;wBACN;4BACEnB,IAAI;4BACJC,OAAO;4BACPC,SAAS;4BACTC,OAAO;gCACL;oCAAEH,IAAI;oCAAgBI,MAAM;oCAAwBC,MAAM;gCAAQ;gCAClE;oCAAEL,IAAI;oCAAiBI,MAAM;oCAAkBC,MAAM;gCAAO;6BAC7D;4BACDC,OAAO;wBACT;qBACD;oBACDyB,UAAU;wBACR9B,OAAO;wBACPO,QAAQ;wBACRC,aAAa;wBACbC,WAAW,IAAIC,OAAOC,WAAW;wBACjCC,cAAc,IAAIF,OAAOC,WAAW;wBACpCE,UAAU;oBACZ;gBACF;YACF;YAEA,MAAM0E,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAE5B,WAAW;YACXI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAC7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,EAAEqF,YAAY,CAAC;YACjCf,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAAClB,KAAK,EAAEwG,SAAS,CAAC;YACvChB,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAAClB,KAAK,EAAEwG,SAAS,CAAC,OAAO,oBAAoB;QACpE;QAEA;;KAEC,GACD3B,GAAG,8BAA8B;YAC/B,MAAME,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,cAAc;gBACzD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,uBAAuB;gBACzE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,uBAAuB;YACvB,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAE5B,WAAW;YACXI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAC7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAE1B,+BAA+B;YAC/B,2CAA2C;YAC3CD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAACa,MAAM,EAAE0D,IAAI,CAAC;YAEhC,uBAAuB;YACvBD,IAAAA,eAAM,EAACrC,KAAKrB,QAAQ,CAACtB,WAAW,EAAEiF,IAAI,CAAC;QACzC;QAEAZ,GAAG,qBAAqB;YACtB,MAAME,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,IAAM;gBACb;gBACAsB,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5B,MAAMjC,OAAO,MAAMoC,SAASlC,IAAI;YAEhCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,EAAEqF,YAAY,CAAC,IAAI,sBAAsB;YAC3Df,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAAClB,KAAK,EAAEyF,IAAI,CAAC;YAClCD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAACjB,OAAO,EAAEwF,IAAI,CAAC;QACtC;QAEAZ,GAAG,wBAAwB;YACzB,MAAMI,WAAW,IAAIC;YACrB,MAAMuB,OAAO,IAAIzB,KAAK;gBAAC;aAAe,EAAE,aAAa;gBACnD5E,MAAM;YACR;YACA6E,SAASE,MAAM,CAAC,QAAQsB;YAExB,MAAMrB,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,cAAc;gBAChE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5BI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAE7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKS,KAAK,EAAE6B,IAAI,CAAC;QAC1B;QAEAZ,GAAG,6BAA6B;YAC9B,MAAMI,WAAW,IAAIC;YACrB,aAAa;YAEb,MAAME,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,YAAY;gBAC9D;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5BI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAE7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKS,KAAK,EAAE6B,IAAI,CAAC;QAC1B;QAEAZ,GAAG,2BAA2B;YAC5B,MAAMI,WAAW,IAAIC;YACrB,MAAMuB,OAAO,IAAIzB,KAAK;gBAAC;aAAe,EAAE,YAAY;gBAClD5E,MAAM;YACR;YACA6E,SAASE,MAAM,CAAC,QAAQsB;YAExB,MAAMrB,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,iBAAiB;gBACnE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5BI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAE7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKS,KAAK,EAAE6B,IAAI,CAAC;QAC1B;QAEAZ,GAAG,kBAAkB;YACnB,MAAME,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdH,UAAUrF,KAAK0B,EAAE,GAAGgB,iBAAiB,CAAC2C;YACxC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5B,MAAMjC,OAAO,MAAMoC,SAASlC,IAAI;YAEhCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKrB,QAAQ,EAAE4E,OAAO,CAAC;gBAC5B1G,OAAO;gBACPO,QAAQ;gBACRC,aAAa;YACf;YACAgF,IAAAA,eAAM,EAACrC,KAAKrB,QAAQ,EAAE6E,cAAc,CAAC;YACrCnB,IAAAA,eAAM,EAACrC,KAAKrB,QAAQ,EAAE6E,cAAc,CAAC;YACrCnB,IAAAA,eAAM,EAACrC,KAAKrB,QAAQ,EAAE6E,cAAc,CAAC;YACrCnB,IAAAA,eAAM,EAAC,OAAOrC,KAAKrB,QAAQ,CAAC9B,KAAK,EAAEyF,IAAI,CAAC;YACxCD,IAAAA,eAAM,EAAC,OAAOrC,KAAKrB,QAAQ,CAACvB,MAAM,EAAEkF,IAAI,CAAC;YACzCD,IAAAA,eAAM,EAAC,OAAOrC,KAAKrB,QAAQ,CAACtB,WAAW,EAAEiF,IAAI,CAAC;QAChD;QAEAZ,GAAG,oBAAoB;YACrB,MAAME,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdH,UAAUrF,KAAK0B,EAAE,GAAGgB,iBAAiB,CAAC2C;YACxC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5B,MAAMjC,OAAO,MAAMoC,SAASlC,IAAI;YAEhCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACoB,MAAMC,OAAO,CAAC1D,KAAKjC,MAAM,GAAGuE,IAAI,CAAC;YACxCtC,KAAKjC,MAAM,CAAC4F,OAAO,CAAC,CAACC;gBACnBvB,IAAAA,eAAM,EAACuB,OAAOJ,cAAc,CAAC;gBAC7BnB,IAAAA,eAAM,EAACuB,OAAOJ,cAAc,CAAC;gBAC7BnB,IAAAA,eAAM,EAACuB,OAAOJ,cAAc,CAAC;gBAC7BnB,IAAAA,eAAM,EAAC,OAAOuB,MAAMhH,EAAE,EAAE0F,IAAI,CAAC;gBAC7BD,IAAAA,eAAM,EAAC,OAAOuB,MAAM/G,KAAK,EAAEyF,IAAI,CAAC;gBAChCD,IAAAA,eAAM,EAAC,OAAOuB,MAAM9G,OAAO,EAAEwF,IAAI,CAAC;YACpC;QACF;QAEAZ,GAAG,0BAA0B;YAC3B,sBAAsB;YACrB5C,kBAAU,CAACC,WAAW,GAAGE,SAAS,CAAe4E,qBAAqB,CAAC;gBACtEnF,SAAS;gBACTX,QAAQ;oBACN;wBACEnB,IAAI;wBACJC,OAAO;wBACPC,SAAS;oBACX;oBACA;wBACEF,IAAI;wBACJC,OAAO;wBACPC,SAAS;oBACX;iBACD;gBACD6B,UAAU;oBACR9B,OAAO;oBACPO,QAAQ;oBACRC,aAAa;gBACf;YACF;YAEA,MAAMuE,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,gBAAgB;gBAClE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5B,MAAMjC,OAAO,MAAMoC,SAASlC,IAAI;YAEhCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,EAAEqF,YAAY,CAAC;YACjCf,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAAClB,KAAK,EAAEyF,IAAI,CAAC;YAClCD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAACjB,OAAO,EAAEwF,IAAI,CAAC;YACpCD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAAClB,KAAK,EAAEyF,IAAI,CAAC;QACpC;QAEAZ,GAAG,oBAAoB;YACrB,sBAAsB;YACrB5C,kBAAU,CAACC,WAAW,GAAGE,SAAS,CAAe4E,qBAAqB,CAAC;gBACtEnF,SAAS;gBACTX,QAAQ;oBACN;wBACEnB,IAAI;wBACJC,OAAO;wBACPC,SAAS;oBACX;iBACD;gBACD6B,UAAU;oBACR9B,OAAO;oBACPO,QAAQ;oBACRC,aAAa;gBACf;YACF;YAEA,MAAMuE,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,kBAAkB;gBACpE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5B,MAAMjC,OAAO,MAAMoC,SAASlC,IAAI;YAEhCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,EAAEqF,YAAY,CAAC;YACjCf,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAAClB,KAAK,EAAEyF,IAAI,CAAC;YAClCD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAACjB,OAAO,EAAEwF,IAAI,CAAC;QACtC;QAEAZ,GAAG,6BAA6B;YAC9B,MAAMoC,YAAY,IAAIjC,KAAK;gBAAC,IAAIY,MAAM,CAAC,KAAK,OAAO;aAAM,EAAE,cAAc;gBACvExF,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQ8B;YAExB,MAAM7B,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,mBAAmB;gBACrE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5BI,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAC7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKS,KAAK,EAAE6B,IAAI,CAAC;QAC1B;QAEAZ,GAAG,oBAAoB;YACrB,MAAME,WAAW,IAAIC,KAAK;gBAAC;aAAgB,EAAE,aAAa;gBACxD5E,MAAM;YACR;YACA,MAAM6E,WAAW,IAAIC;YACrBD,SAASE,MAAM,CAAC,QAAQJ;YAExB,MAAMK,UAAU;gBACdC,QAAQ;gBACRC,MAAML;gBACNvB,SAAS;oBACPC,KAAK,CAACY,OAAiBA,SAAS,gBAAgB,kBAAkB;gBACpE;gBACAU,UAAU,IAAM3B,QAAQC,OAAO,CAAC0B;YAClC;YAEA,MAAMM,WAAW,MAAMxB,IAAAA,WAAI,EAACqB;YAC5B,MAAMjC,OAAO,MAAMoC,SAASlC,IAAI;YAEhCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,EAAEqF,YAAY,CAAC;YACjCf,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAAClB,KAAK,EAAEyF,IAAI,CAAC;YAClCD,IAAAA,eAAM,EAACrC,KAAKjC,MAAM,CAAC,EAAE,CAACjB,OAAO,EAAEwF,IAAI,CAAC;QACtC;IACF;IAEAjB,SAAS,uBAAuB;QAC9BK,GAAG,sBAAsB;YACvB,MAAMU,WAAW,MAAMvB,IAAAA,UAAG;YAE1BwB,IAAAA,eAAM,EAACD,SAASnC,MAAM,EAAEqC,IAAI,CAAC;YAC7B,MAAMtC,OAAO,MAAMoC,SAASlC,IAAI;YAChCmC,IAAAA,eAAM,EAACrC,KAAKtB,OAAO,EAAE4D,IAAI,CAAC;YAC1BD,IAAAA,eAAM,EAACrC,KAAKS,KAAK,EAAE6B,IAAI,CAAC;QAC1B;IACF;AACF"}