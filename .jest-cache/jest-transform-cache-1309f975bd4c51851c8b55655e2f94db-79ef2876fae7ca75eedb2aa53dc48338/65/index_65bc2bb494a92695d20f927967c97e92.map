{"version":3,"sources":["/Users/yusuketsunoda/Documents/cursor/ppttranslatorapp/node_modules/jest-environment-jsdom/build/index.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.default = exports.TestEnvironment = void 0;\nfunction _jsdom() {\n  const data = require('jsdom');\n  _jsdom = function () {\n    return data;\n  };\n  return data;\n}\nfunction _fakeTimers() {\n  const data = require('@jest/fake-timers');\n  _fakeTimers = function () {\n    return data;\n  };\n  return data;\n}\nfunction _jestMock() {\n  const data = require('jest-mock');\n  _jestMock = function () {\n    return data;\n  };\n  return data;\n}\nfunction _jestUtil() {\n  const data = require('jest-util');\n  _jestUtil = function () {\n    return data;\n  };\n  return data;\n}\n/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// The `Window` interface does not have an `Error.stackTraceLimit` property, but\n// `JSDOMEnvironment` assumes it is there.\nfunction isString(value) {\n  return typeof value === 'string';\n}\nclass JSDOMEnvironment {\n  dom;\n  fakeTimers;\n  fakeTimersModern;\n  global;\n  errorEventListener;\n  moduleMocker;\n  customExportConditions = ['browser'];\n  _configuredExportConditions;\n  constructor(config, context) {\n    const {projectConfig} = config;\n    const virtualConsole = new (_jsdom().VirtualConsole)();\n    virtualConsole.sendTo(context.console, {\n      omitJSDOMErrors: true\n    });\n    virtualConsole.on('jsdomError', error => {\n      context.console.error(error);\n    });\n    this.dom = new (_jsdom().JSDOM)(\n      typeof projectConfig.testEnvironmentOptions.html === 'string'\n        ? projectConfig.testEnvironmentOptions.html\n        : '<!DOCTYPE html>',\n      {\n        pretendToBeVisual: true,\n        resources:\n          typeof projectConfig.testEnvironmentOptions.userAgent === 'string'\n            ? new (_jsdom().ResourceLoader)({\n                userAgent: projectConfig.testEnvironmentOptions.userAgent\n              })\n            : undefined,\n        runScripts: 'dangerously',\n        url: 'http://localhost/',\n        virtualConsole,\n        ...projectConfig.testEnvironmentOptions\n      }\n    );\n    const global = (this.global = this.dom.window);\n    if (global == null) {\n      throw new Error('JSDOM did not return a Window object');\n    }\n\n    // @ts-expect-error - for \"universal\" code (code should use `globalThis`)\n    global.global = global;\n\n    // Node's error-message stack size is limited at 10, but it's pretty useful\n    // to see more than that when a test fails.\n    this.global.Error.stackTraceLimit = 100;\n    (0, _jestUtil().installCommonGlobals)(global, projectConfig.globals);\n\n    // TODO: remove this ASAP, but it currently causes tests to run really slow\n    global.Buffer = Buffer;\n\n    // Report uncaught errors.\n    this.errorEventListener = event => {\n      if (userErrorListenerCount === 0 && event.error != null) {\n        process.emit('uncaughtException', event.error);\n      }\n    };\n    global.addEventListener('error', this.errorEventListener);\n\n    // However, don't report them as uncaught if the user listens to 'error' event.\n    // In that case, we assume the might have custom error handling logic.\n    const originalAddListener = global.addEventListener.bind(global);\n    const originalRemoveListener = global.removeEventListener.bind(global);\n    let userErrorListenerCount = 0;\n    global.addEventListener = function (...args) {\n      if (args[0] === 'error') {\n        userErrorListenerCount++;\n      }\n      return originalAddListener.apply(this, args);\n    };\n    global.removeEventListener = function (...args) {\n      if (args[0] === 'error') {\n        userErrorListenerCount--;\n      }\n      return originalRemoveListener.apply(this, args);\n    };\n    if ('customExportConditions' in projectConfig.testEnvironmentOptions) {\n      const {customExportConditions} = projectConfig.testEnvironmentOptions;\n      if (\n        Array.isArray(customExportConditions) &&\n        customExportConditions.every(isString)\n      ) {\n        this._configuredExportConditions = customExportConditions;\n      } else {\n        throw new Error(\n          'Custom export conditions specified but they are not an array of strings'\n        );\n      }\n    }\n    this.moduleMocker = new (_jestMock().ModuleMocker)(global);\n    this.fakeTimers = new (_fakeTimers().LegacyFakeTimers)({\n      config: projectConfig,\n      global: global,\n      moduleMocker: this.moduleMocker,\n      timerConfig: {\n        idToRef: id => id,\n        refToId: ref => ref\n      }\n    });\n    this.fakeTimersModern = new (_fakeTimers().ModernFakeTimers)({\n      config: projectConfig,\n      global: global\n    });\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  async setup() {}\n  async teardown() {\n    if (this.fakeTimers) {\n      this.fakeTimers.dispose();\n    }\n    if (this.fakeTimersModern) {\n      this.fakeTimersModern.dispose();\n    }\n    if (this.global != null) {\n      if (this.errorEventListener) {\n        this.global.removeEventListener('error', this.errorEventListener);\n      }\n      this.global.close();\n    }\n    this.errorEventListener = null;\n    // @ts-expect-error: this.global not allowed to be `null`\n    this.global = null;\n    this.dom = null;\n    this.fakeTimers = null;\n    this.fakeTimersModern = null;\n  }\n  exportConditions() {\n    return this._configuredExportConditions ?? this.customExportConditions;\n  }\n  getVmContext() {\n    if (this.dom) {\n      return this.dom.getInternalVMContext();\n    }\n    return null;\n  }\n}\nexports.default = JSDOMEnvironment;\nconst TestEnvironment = JSDOMEnvironment;\nexports.TestEnvironment = TestEnvironment;\n"],"names":["Object","defineProperty","exports","value","default","TestEnvironment","_jsdom","data","require","_fakeTimers","_jestMock","_jestUtil","isString","JSDOMEnvironment","dom","fakeTimers","fakeTimersModern","global","errorEventListener","moduleMocker","customExportConditions","_configuredExportConditions","constructor","config","context","projectConfig","virtualConsole","VirtualConsole","sendTo","console","omitJSDOMErrors","on","error","JSDOM","testEnvironmentOptions","html","pretendToBeVisual","resources","userAgent","ResourceLoader","undefined","runScripts","url","window","Error","stackTraceLimit","installCommonGlobals","globals","Buffer","event","userErrorListenerCount","process","emit","addEventListener","originalAddListener","bind","originalRemoveListener","removeEventListener","args","apply","Array","isArray","every","ModuleMocker","LegacyFakeTimers","timerConfig","idToRef","id","refToId","ref","ModernFakeTimers","setup","teardown","dispose","close","exportConditions","getVmContext","getInternalVMContext"],"mappings":"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"}