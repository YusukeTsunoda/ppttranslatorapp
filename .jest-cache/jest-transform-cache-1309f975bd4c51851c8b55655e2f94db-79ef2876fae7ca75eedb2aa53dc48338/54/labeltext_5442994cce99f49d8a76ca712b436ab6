2f01bee198eb39232225b3501e338f61
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.queryByLabelText = exports.queryAllByLabelText = exports.getByLabelText = exports.getAllByLabelText = exports.findByLabelText = exports.findAllByLabelText = void 0;
var _config = require("../config");
var _helpers = require("../helpers");
var _labelHelpers = require("../label-helpers");
var _allUtils = require("./all-utils");
function queryAllLabels(container) {
    return Array.from(container.querySelectorAll('label,input')).map((node)=>{
        return {
            node,
            textToMatch: (0, _labelHelpers.getLabelContent)(node)
        };
    }).filter(({ textToMatch })=>textToMatch !== null);
}
const queryAllLabelsByText = (container, text, { exact = true, trim, collapseWhitespace, normalizer } = {})=>{
    const matcher = exact ? _allUtils.matches : _allUtils.fuzzyMatches;
    const matchNormalizer = (0, _allUtils.makeNormalizer)({
        collapseWhitespace,
        trim,
        normalizer
    });
    const textToMatchByLabels = queryAllLabels(container);
    return textToMatchByLabels.filter(({ node, textToMatch })=>matcher(textToMatch, node, text, matchNormalizer)).map(({ node })=>node);
};
const queryAllByLabelText = (container, text, { selector = '*', exact = true, collapseWhitespace, trim, normalizer } = {})=>{
    (0, _helpers.checkContainerType)(container);
    const matcher = exact ? _allUtils.matches : _allUtils.fuzzyMatches;
    const matchNormalizer = (0, _allUtils.makeNormalizer)({
        collapseWhitespace,
        trim,
        normalizer
    });
    const matchingLabelledElements = Array.from(container.querySelectorAll('*')).filter((element)=>{
        return (0, _labelHelpers.getRealLabels)(element).length || element.hasAttribute('aria-labelledby');
    }).reduce((labelledElements, labelledElement)=>{
        const labelList = (0, _labelHelpers.getLabels)(container, labelledElement, {
            selector
        });
        labelList.filter((label)=>Boolean(label.formControl)).forEach((label)=>{
            if (matcher(label.content, label.formControl, text, matchNormalizer) && label.formControl) {
                labelledElements.push(label.formControl);
            }
        });
        const labelsValue = labelList.filter((label)=>Boolean(label.content)).map((label)=>label.content);
        if (matcher(labelsValue.join(' '), labelledElement, text, matchNormalizer)) {
            labelledElements.push(labelledElement);
        }
        if (labelsValue.length > 1) {
            labelsValue.forEach((labelValue, index)=>{
                if (matcher(labelValue, labelledElement, text, matchNormalizer)) {
                    labelledElements.push(labelledElement);
                }
                const labelsFiltered = [
                    ...labelsValue
                ];
                labelsFiltered.splice(index, 1);
                if (labelsFiltered.length > 1) {
                    if (matcher(labelsFiltered.join(' '), labelledElement, text, matchNormalizer)) {
                        labelledElements.push(labelledElement);
                    }
                }
            });
        }
        return labelledElements;
    }, []).concat((0, _allUtils.queryAllByAttribute)('aria-label', container, text, {
        exact,
        normalizer: matchNormalizer
    }));
    return Array.from(new Set(matchingLabelledElements)).filter((element)=>element.matches(selector));
};
// the getAll* query would normally look like this:
// const getAllByLabelText = makeGetAllQuery(
//   queryAllByLabelText,
//   (c, text) => `Unable to find a label with the text of: ${text}`,
// )
// however, we can give a more helpful error message than the generic one,
// so we're writing this one out by hand.
const getAllByLabelText = (container, text, ...rest)=>{
    const els = queryAllByLabelText(container, text, ...rest);
    if (!els.length) {
        const labels = queryAllLabelsByText(container, text, ...rest);
        if (labels.length) {
            const tagNames = labels.map((label)=>getTagNameOfElementAssociatedWithLabelViaFor(container, label)).filter((tagName)=>!!tagName);
            if (tagNames.length) {
                throw (0, _config.getConfig)().getElementError(tagNames.map((tagName)=>`Found a label with the text of: ${text}, however the element associated with this label (<${tagName} />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <${tagName} />, you can use aria-label or aria-labelledby instead.`).join('\n\n'), container);
            } else {
                throw (0, _config.getConfig)().getElementError(`Found a label with the text of: ${text}, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`, container);
            }
        } else {
            throw (0, _config.getConfig)().getElementError(`Unable to find a label with the text of: ${text}`, container);
        }
    }
    return els;
};
function getTagNameOfElementAssociatedWithLabelViaFor(container, label) {
    const htmlFor = label.getAttribute('for');
    if (!htmlFor) {
        return null;
    }
    const element = container.querySelector(`[id="${htmlFor}"]`);
    return element ? element.tagName.toLowerCase() : null;
}
// the reason mentioned above is the same reason we're not using buildQueries
const getMultipleError = (c, text)=>`Found multiple elements with the text of: ${text}`;
const queryByLabelText = exports.queryByLabelText = (0, _allUtils.wrapSingleQueryWithSuggestion)((0, _allUtils.makeSingleQuery)(queryAllByLabelText, getMultipleError), queryAllByLabelText.name, 'query');
const getByLabelText = (0, _allUtils.makeSingleQuery)(getAllByLabelText, getMultipleError);
const findAllByLabelText = exports.findAllByLabelText = (0, _allUtils.makeFindQuery)((0, _allUtils.wrapAllByQueryWithSuggestion)(getAllByLabelText, getAllByLabelText.name, 'findAll'));
const findByLabelText = exports.findByLabelText = (0, _allUtils.makeFindQuery)((0, _allUtils.wrapSingleQueryWithSuggestion)(getByLabelText, getAllByLabelText.name, 'find'));
const getAllByLabelTextWithSuggestions = exports.getAllByLabelText = (0, _allUtils.wrapAllByQueryWithSuggestion)(getAllByLabelText, getAllByLabelText.name, 'getAll');
const getByLabelTextWithSuggestions = exports.getByLabelText = (0, _allUtils.wrapSingleQueryWithSuggestion)(getByLabelText, getAllByLabelText.name, 'get');
const queryAllByLabelTextWithSuggestions = exports.queryAllByLabelText = (0, _allUtils.wrapAllByQueryWithSuggestion)(queryAllByLabelText, queryAllByLabelText.name, 'queryAll');

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95dXN1a2V0c3Vub2RhL0RvY3VtZW50cy9jdXJzb3IvcHB0dHJhbnNsYXRvcmFwcC9ub2RlX21vZHVsZXMvQHRlc3RpbmctbGlicmFyeS9yZWFjdC9ub2RlX21vZHVsZXMvQHRlc3RpbmctbGlicmFyeS9kb20vZGlzdC9xdWVyaWVzL2xhYmVsLXRleHQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnF1ZXJ5QnlMYWJlbFRleHQgPSBleHBvcnRzLnF1ZXJ5QWxsQnlMYWJlbFRleHQgPSBleHBvcnRzLmdldEJ5TGFiZWxUZXh0ID0gZXhwb3J0cy5nZXRBbGxCeUxhYmVsVGV4dCA9IGV4cG9ydHMuZmluZEJ5TGFiZWxUZXh0ID0gZXhwb3J0cy5maW5kQWxsQnlMYWJlbFRleHQgPSB2b2lkIDA7XG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9jb25maWdcIik7XG52YXIgX2hlbHBlcnMgPSByZXF1aXJlKFwiLi4vaGVscGVyc1wiKTtcbnZhciBfbGFiZWxIZWxwZXJzID0gcmVxdWlyZShcIi4uL2xhYmVsLWhlbHBlcnNcIik7XG52YXIgX2FsbFV0aWxzID0gcmVxdWlyZShcIi4vYWxsLXV0aWxzXCIpO1xuZnVuY3Rpb24gcXVlcnlBbGxMYWJlbHMoY29udGFpbmVyKSB7XG4gIHJldHVybiBBcnJheS5mcm9tKGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdsYWJlbCxpbnB1dCcpKS5tYXAobm9kZSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5vZGUsXG4gICAgICB0ZXh0VG9NYXRjaDogKDAsIF9sYWJlbEhlbHBlcnMuZ2V0TGFiZWxDb250ZW50KShub2RlKVxuICAgIH07XG4gIH0pLmZpbHRlcigoe1xuICAgIHRleHRUb01hdGNoXG4gIH0pID0+IHRleHRUb01hdGNoICE9PSBudWxsKTtcbn1cbmNvbnN0IHF1ZXJ5QWxsTGFiZWxzQnlUZXh0ID0gKGNvbnRhaW5lciwgdGV4dCwge1xuICBleGFjdCA9IHRydWUsXG4gIHRyaW0sXG4gIGNvbGxhcHNlV2hpdGVzcGFjZSxcbiAgbm9ybWFsaXplclxufSA9IHt9KSA9PiB7XG4gIGNvbnN0IG1hdGNoZXIgPSBleGFjdCA/IF9hbGxVdGlscy5tYXRjaGVzIDogX2FsbFV0aWxzLmZ1enp5TWF0Y2hlcztcbiAgY29uc3QgbWF0Y2hOb3JtYWxpemVyID0gKDAsIF9hbGxVdGlscy5tYWtlTm9ybWFsaXplcikoe1xuICAgIGNvbGxhcHNlV2hpdGVzcGFjZSxcbiAgICB0cmltLFxuICAgIG5vcm1hbGl6ZXJcbiAgfSk7XG4gIGNvbnN0IHRleHRUb01hdGNoQnlMYWJlbHMgPSBxdWVyeUFsbExhYmVscyhjb250YWluZXIpO1xuICByZXR1cm4gdGV4dFRvTWF0Y2hCeUxhYmVscy5maWx0ZXIoKHtcbiAgICBub2RlLFxuICAgIHRleHRUb01hdGNoXG4gIH0pID0+IG1hdGNoZXIodGV4dFRvTWF0Y2gsIG5vZGUsIHRleHQsIG1hdGNoTm9ybWFsaXplcikpLm1hcCgoe1xuICAgIG5vZGVcbiAgfSkgPT4gbm9kZSk7XG59O1xuY29uc3QgcXVlcnlBbGxCeUxhYmVsVGV4dCA9IChjb250YWluZXIsIHRleHQsIHtcbiAgc2VsZWN0b3IgPSAnKicsXG4gIGV4YWN0ID0gdHJ1ZSxcbiAgY29sbGFwc2VXaGl0ZXNwYWNlLFxuICB0cmltLFxuICBub3JtYWxpemVyXG59ID0ge30pID0+IHtcbiAgKDAsIF9oZWxwZXJzLmNoZWNrQ29udGFpbmVyVHlwZSkoY29udGFpbmVyKTtcbiAgY29uc3QgbWF0Y2hlciA9IGV4YWN0ID8gX2FsbFV0aWxzLm1hdGNoZXMgOiBfYWxsVXRpbHMuZnV6enlNYXRjaGVzO1xuICBjb25zdCBtYXRjaE5vcm1hbGl6ZXIgPSAoMCwgX2FsbFV0aWxzLm1ha2VOb3JtYWxpemVyKSh7XG4gICAgY29sbGFwc2VXaGl0ZXNwYWNlLFxuICAgIHRyaW0sXG4gICAgbm9ybWFsaXplclxuICB9KTtcbiAgY29uc3QgbWF0Y2hpbmdMYWJlbGxlZEVsZW1lbnRzID0gQXJyYXkuZnJvbShjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnKicpKS5maWx0ZXIoZWxlbWVudCA9PiB7XG4gICAgcmV0dXJuICgwLCBfbGFiZWxIZWxwZXJzLmdldFJlYWxMYWJlbHMpKGVsZW1lbnQpLmxlbmd0aCB8fCBlbGVtZW50Lmhhc0F0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5Jyk7XG4gIH0pLnJlZHVjZSgobGFiZWxsZWRFbGVtZW50cywgbGFiZWxsZWRFbGVtZW50KSA9PiB7XG4gICAgY29uc3QgbGFiZWxMaXN0ID0gKDAsIF9sYWJlbEhlbHBlcnMuZ2V0TGFiZWxzKShjb250YWluZXIsIGxhYmVsbGVkRWxlbWVudCwge1xuICAgICAgc2VsZWN0b3JcbiAgICB9KTtcbiAgICBsYWJlbExpc3QuZmlsdGVyKGxhYmVsID0+IEJvb2xlYW4obGFiZWwuZm9ybUNvbnRyb2wpKS5mb3JFYWNoKGxhYmVsID0+IHtcbiAgICAgIGlmIChtYXRjaGVyKGxhYmVsLmNvbnRlbnQsIGxhYmVsLmZvcm1Db250cm9sLCB0ZXh0LCBtYXRjaE5vcm1hbGl6ZXIpICYmIGxhYmVsLmZvcm1Db250cm9sKSB7XG4gICAgICAgIGxhYmVsbGVkRWxlbWVudHMucHVzaChsYWJlbC5mb3JtQ29udHJvbCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgbGFiZWxzVmFsdWUgPSBsYWJlbExpc3QuZmlsdGVyKGxhYmVsID0+IEJvb2xlYW4obGFiZWwuY29udGVudCkpLm1hcChsYWJlbCA9PiBsYWJlbC5jb250ZW50KTtcbiAgICBpZiAobWF0Y2hlcihsYWJlbHNWYWx1ZS5qb2luKCcgJyksIGxhYmVsbGVkRWxlbWVudCwgdGV4dCwgbWF0Y2hOb3JtYWxpemVyKSkge1xuICAgICAgbGFiZWxsZWRFbGVtZW50cy5wdXNoKGxhYmVsbGVkRWxlbWVudCk7XG4gICAgfVxuICAgIGlmIChsYWJlbHNWYWx1ZS5sZW5ndGggPiAxKSB7XG4gICAgICBsYWJlbHNWYWx1ZS5mb3JFYWNoKChsYWJlbFZhbHVlLCBpbmRleCkgPT4ge1xuICAgICAgICBpZiAobWF0Y2hlcihsYWJlbFZhbHVlLCBsYWJlbGxlZEVsZW1lbnQsIHRleHQsIG1hdGNoTm9ybWFsaXplcikpIHtcbiAgICAgICAgICBsYWJlbGxlZEVsZW1lbnRzLnB1c2gobGFiZWxsZWRFbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsYWJlbHNGaWx0ZXJlZCA9IFsuLi5sYWJlbHNWYWx1ZV07XG4gICAgICAgIGxhYmVsc0ZpbHRlcmVkLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIGlmIChsYWJlbHNGaWx0ZXJlZC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgaWYgKG1hdGNoZXIobGFiZWxzRmlsdGVyZWQuam9pbignICcpLCBsYWJlbGxlZEVsZW1lbnQsIHRleHQsIG1hdGNoTm9ybWFsaXplcikpIHtcbiAgICAgICAgICAgIGxhYmVsbGVkRWxlbWVudHMucHVzaChsYWJlbGxlZEVsZW1lbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBsYWJlbGxlZEVsZW1lbnRzO1xuICB9LCBbXSkuY29uY2F0KCgwLCBfYWxsVXRpbHMucXVlcnlBbGxCeUF0dHJpYnV0ZSkoJ2FyaWEtbGFiZWwnLCBjb250YWluZXIsIHRleHQsIHtcbiAgICBleGFjdCxcbiAgICBub3JtYWxpemVyOiBtYXRjaE5vcm1hbGl6ZXJcbiAgfSkpO1xuICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KG1hdGNoaW5nTGFiZWxsZWRFbGVtZW50cykpLmZpbHRlcihlbGVtZW50ID0+IGVsZW1lbnQubWF0Y2hlcyhzZWxlY3RvcikpO1xufTtcblxuLy8gdGhlIGdldEFsbCogcXVlcnkgd291bGQgbm9ybWFsbHkgbG9vayBsaWtlIHRoaXM6XG4vLyBjb25zdCBnZXRBbGxCeUxhYmVsVGV4dCA9IG1ha2VHZXRBbGxRdWVyeShcbi8vICAgcXVlcnlBbGxCeUxhYmVsVGV4dCxcbi8vICAgKGMsIHRleHQpID0+IGBVbmFibGUgdG8gZmluZCBhIGxhYmVsIHdpdGggdGhlIHRleHQgb2Y6ICR7dGV4dH1gLFxuLy8gKVxuLy8gaG93ZXZlciwgd2UgY2FuIGdpdmUgYSBtb3JlIGhlbHBmdWwgZXJyb3IgbWVzc2FnZSB0aGFuIHRoZSBnZW5lcmljIG9uZSxcbi8vIHNvIHdlJ3JlIHdyaXRpbmcgdGhpcyBvbmUgb3V0IGJ5IGhhbmQuXG5jb25zdCBnZXRBbGxCeUxhYmVsVGV4dCA9IChjb250YWluZXIsIHRleHQsIC4uLnJlc3QpID0+IHtcbiAgY29uc3QgZWxzID0gcXVlcnlBbGxCeUxhYmVsVGV4dChjb250YWluZXIsIHRleHQsIC4uLnJlc3QpO1xuICBpZiAoIWVscy5sZW5ndGgpIHtcbiAgICBjb25zdCBsYWJlbHMgPSBxdWVyeUFsbExhYmVsc0J5VGV4dChjb250YWluZXIsIHRleHQsIC4uLnJlc3QpO1xuICAgIGlmIChsYWJlbHMubGVuZ3RoKSB7XG4gICAgICBjb25zdCB0YWdOYW1lcyA9IGxhYmVscy5tYXAobGFiZWwgPT4gZ2V0VGFnTmFtZU9mRWxlbWVudEFzc29jaWF0ZWRXaXRoTGFiZWxWaWFGb3IoY29udGFpbmVyLCBsYWJlbCkpLmZpbHRlcih0YWdOYW1lID0+ICEhdGFnTmFtZSk7XG4gICAgICBpZiAodGFnTmFtZXMubGVuZ3RoKSB7XG4gICAgICAgIHRocm93ICgwLCBfY29uZmlnLmdldENvbmZpZykoKS5nZXRFbGVtZW50RXJyb3IodGFnTmFtZXMubWFwKHRhZ05hbWUgPT4gYEZvdW5kIGEgbGFiZWwgd2l0aCB0aGUgdGV4dCBvZjogJHt0ZXh0fSwgaG93ZXZlciB0aGUgZWxlbWVudCBhc3NvY2lhdGVkIHdpdGggdGhpcyBsYWJlbCAoPCR7dGFnTmFtZX0gLz4pIGlzIG5vbi1sYWJlbGxhYmxlIFtodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9mb3Jtcy5odG1sI2NhdGVnb3J5LWxhYmVsXS4gSWYgeW91IHJlYWxseSBuZWVkIHRvIGxhYmVsIGEgPCR7dGFnTmFtZX0gLz4sIHlvdSBjYW4gdXNlIGFyaWEtbGFiZWwgb3IgYXJpYS1sYWJlbGxlZGJ5IGluc3RlYWQuYCkuam9pbignXFxuXFxuJyksIGNvbnRhaW5lcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyAoMCwgX2NvbmZpZy5nZXRDb25maWcpKCkuZ2V0RWxlbWVudEVycm9yKGBGb3VuZCBhIGxhYmVsIHdpdGggdGhlIHRleHQgb2Y6ICR7dGV4dH0sIGhvd2V2ZXIgbm8gZm9ybSBjb250cm9sIHdhcyBmb3VuZCBhc3NvY2lhdGVkIHRvIHRoYXQgbGFiZWwuIE1ha2Ugc3VyZSB5b3UncmUgdXNpbmcgdGhlIFwiZm9yXCIgYXR0cmlidXRlIG9yIFwiYXJpYS1sYWJlbGxlZGJ5XCIgYXR0cmlidXRlIGNvcnJlY3RseS5gLCBjb250YWluZXIpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyAoMCwgX2NvbmZpZy5nZXRDb25maWcpKCkuZ2V0RWxlbWVudEVycm9yKGBVbmFibGUgdG8gZmluZCBhIGxhYmVsIHdpdGggdGhlIHRleHQgb2Y6ICR7dGV4dH1gLCBjb250YWluZXIpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZWxzO1xufTtcbmZ1bmN0aW9uIGdldFRhZ05hbWVPZkVsZW1lbnRBc3NvY2lhdGVkV2l0aExhYmVsVmlhRm9yKGNvbnRhaW5lciwgbGFiZWwpIHtcbiAgY29uc3QgaHRtbEZvciA9IGxhYmVsLmdldEF0dHJpYnV0ZSgnZm9yJyk7XG4gIGlmICghaHRtbEZvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGVsZW1lbnQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihgW2lkPVwiJHtodG1sRm9yfVwiXWApO1xuICByZXR1cm4gZWxlbWVudCA/IGVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpIDogbnVsbDtcbn1cblxuLy8gdGhlIHJlYXNvbiBtZW50aW9uZWQgYWJvdmUgaXMgdGhlIHNhbWUgcmVhc29uIHdlJ3JlIG5vdCB1c2luZyBidWlsZFF1ZXJpZXNcbmNvbnN0IGdldE11bHRpcGxlRXJyb3IgPSAoYywgdGV4dCkgPT4gYEZvdW5kIG11bHRpcGxlIGVsZW1lbnRzIHdpdGggdGhlIHRleHQgb2Y6ICR7dGV4dH1gO1xuY29uc3QgcXVlcnlCeUxhYmVsVGV4dCA9IGV4cG9ydHMucXVlcnlCeUxhYmVsVGV4dCA9ICgwLCBfYWxsVXRpbHMud3JhcFNpbmdsZVF1ZXJ5V2l0aFN1Z2dlc3Rpb24pKCgwLCBfYWxsVXRpbHMubWFrZVNpbmdsZVF1ZXJ5KShxdWVyeUFsbEJ5TGFiZWxUZXh0LCBnZXRNdWx0aXBsZUVycm9yKSwgcXVlcnlBbGxCeUxhYmVsVGV4dC5uYW1lLCAncXVlcnknKTtcbmNvbnN0IGdldEJ5TGFiZWxUZXh0ID0gKDAsIF9hbGxVdGlscy5tYWtlU2luZ2xlUXVlcnkpKGdldEFsbEJ5TGFiZWxUZXh0LCBnZXRNdWx0aXBsZUVycm9yKTtcbmNvbnN0IGZpbmRBbGxCeUxhYmVsVGV4dCA9IGV4cG9ydHMuZmluZEFsbEJ5TGFiZWxUZXh0ID0gKDAsIF9hbGxVdGlscy5tYWtlRmluZFF1ZXJ5KSgoMCwgX2FsbFV0aWxzLndyYXBBbGxCeVF1ZXJ5V2l0aFN1Z2dlc3Rpb24pKGdldEFsbEJ5TGFiZWxUZXh0LCBnZXRBbGxCeUxhYmVsVGV4dC5uYW1lLCAnZmluZEFsbCcpKTtcbmNvbnN0IGZpbmRCeUxhYmVsVGV4dCA9IGV4cG9ydHMuZmluZEJ5TGFiZWxUZXh0ID0gKDAsIF9hbGxVdGlscy5tYWtlRmluZFF1ZXJ5KSgoMCwgX2FsbFV0aWxzLndyYXBTaW5nbGVRdWVyeVdpdGhTdWdnZXN0aW9uKShnZXRCeUxhYmVsVGV4dCwgZ2V0QWxsQnlMYWJlbFRleHQubmFtZSwgJ2ZpbmQnKSk7XG5jb25zdCBnZXRBbGxCeUxhYmVsVGV4dFdpdGhTdWdnZXN0aW9ucyA9IGV4cG9ydHMuZ2V0QWxsQnlMYWJlbFRleHQgPSAoMCwgX2FsbFV0aWxzLndyYXBBbGxCeVF1ZXJ5V2l0aFN1Z2dlc3Rpb24pKGdldEFsbEJ5TGFiZWxUZXh0LCBnZXRBbGxCeUxhYmVsVGV4dC5uYW1lLCAnZ2V0QWxsJyk7XG5jb25zdCBnZXRCeUxhYmVsVGV4dFdpdGhTdWdnZXN0aW9ucyA9IGV4cG9ydHMuZ2V0QnlMYWJlbFRleHQgPSAoMCwgX2FsbFV0aWxzLndyYXBTaW5nbGVRdWVyeVdpdGhTdWdnZXN0aW9uKShnZXRCeUxhYmVsVGV4dCwgZ2V0QWxsQnlMYWJlbFRleHQubmFtZSwgJ2dldCcpO1xuY29uc3QgcXVlcnlBbGxCeUxhYmVsVGV4dFdpdGhTdWdnZXN0aW9ucyA9IGV4cG9ydHMucXVlcnlBbGxCeUxhYmVsVGV4dCA9ICgwLCBfYWxsVXRpbHMud3JhcEFsbEJ5UXVlcnlXaXRoU3VnZ2VzdGlvbikocXVlcnlBbGxCeUxhYmVsVGV4dCwgcXVlcnlBbGxCeUxhYmVsVGV4dC5uYW1lLCAncXVlcnlBbGwnKTsiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJxdWVyeUJ5TGFiZWxUZXh0IiwicXVlcnlBbGxCeUxhYmVsVGV4dCIsImdldEJ5TGFiZWxUZXh0IiwiZ2V0QWxsQnlMYWJlbFRleHQiLCJmaW5kQnlMYWJlbFRleHQiLCJmaW5kQWxsQnlMYWJlbFRleHQiLCJfY29uZmlnIiwicmVxdWlyZSIsIl9oZWxwZXJzIiwiX2xhYmVsSGVscGVycyIsIl9hbGxVdGlscyIsInF1ZXJ5QWxsTGFiZWxzIiwiY29udGFpbmVyIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIm1hcCIsIm5vZGUiLCJ0ZXh0VG9NYXRjaCIsImdldExhYmVsQ29udGVudCIsImZpbHRlciIsInF1ZXJ5QWxsTGFiZWxzQnlUZXh0IiwidGV4dCIsImV4YWN0IiwidHJpbSIsImNvbGxhcHNlV2hpdGVzcGFjZSIsIm5vcm1hbGl6ZXIiLCJtYXRjaGVyIiwibWF0Y2hlcyIsImZ1enp5TWF0Y2hlcyIsIm1hdGNoTm9ybWFsaXplciIsIm1ha2VOb3JtYWxpemVyIiwidGV4dFRvTWF0Y2hCeUxhYmVscyIsInNlbGVjdG9yIiwiY2hlY2tDb250YWluZXJUeXBlIiwibWF0Y2hpbmdMYWJlbGxlZEVsZW1lbnRzIiwiZWxlbWVudCIsImdldFJlYWxMYWJlbHMiLCJsZW5ndGgiLCJoYXNBdHRyaWJ1dGUiLCJyZWR1Y2UiLCJsYWJlbGxlZEVsZW1lbnRzIiwibGFiZWxsZWRFbGVtZW50IiwibGFiZWxMaXN0IiwiZ2V0TGFiZWxzIiwibGFiZWwiLCJCb29sZWFuIiwiZm9ybUNvbnRyb2wiLCJmb3JFYWNoIiwiY29udGVudCIsInB1c2giLCJsYWJlbHNWYWx1ZSIsImpvaW4iLCJsYWJlbFZhbHVlIiwiaW5kZXgiLCJsYWJlbHNGaWx0ZXJlZCIsInNwbGljZSIsImNvbmNhdCIsInF1ZXJ5QWxsQnlBdHRyaWJ1dGUiLCJTZXQiLCJyZXN0IiwiZWxzIiwibGFiZWxzIiwidGFnTmFtZXMiLCJnZXRUYWdOYW1lT2ZFbGVtZW50QXNzb2NpYXRlZFdpdGhMYWJlbFZpYUZvciIsInRhZ05hbWUiLCJnZXRDb25maWciLCJnZXRFbGVtZW50RXJyb3IiLCJodG1sRm9yIiwiZ2V0QXR0cmlidXRlIiwicXVlcnlTZWxlY3RvciIsInRvTG93ZXJDYXNlIiwiZ2V0TXVsdGlwbGVFcnJvciIsImMiLCJ3cmFwU2luZ2xlUXVlcnlXaXRoU3VnZ2VzdGlvbiIsIm1ha2VTaW5nbGVRdWVyeSIsIm5hbWUiLCJtYWtlRmluZFF1ZXJ5Iiwid3JhcEFsbEJ5UXVlcnlXaXRoU3VnZ2VzdGlvbiIsImdldEFsbEJ5TGFiZWxUZXh0V2l0aFN1Z2dlc3Rpb25zIiwiZ2V0QnlMYWJlbFRleHRXaXRoU3VnZ2VzdGlvbnMiLCJxdWVyeUFsbEJ5TGFiZWxUZXh0V2l0aFN1Z2dlc3Rpb25zIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUVBQSxPQUFPQyxjQUFjLENBQUNDLFNBQVMsY0FBYztJQUMzQ0MsT0FBTztBQUNUO0FBQ0FELFFBQVFFLGdCQUFnQixHQUFHRixRQUFRRyxtQkFBbUIsR0FBR0gsUUFBUUks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