{"version":3,"sources":["/Users/yusuketsunoda/Documents/cursor/ppttranslatorapp/worktrees/cicd-setup/app/api/user/role/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth/auth-options';\nimport { prisma } from '@/lib/db/prisma';\n\nexport const dynamic = 'force-dynamic';\n\nexport async function GET(request: NextRequest) {\n  try {\n    // セッションからユーザーIDを取得\n    const session = await getServerSession(authOptions);\n\n    if (!session?.user?.id) {\n      return NextResponse.json({ isAdmin: false, role: null }, { status: 401 });\n    }\n\n    // ユーザーロールを取得\n    const user = await prisma.user.findUnique({\n      where: { id: session.user.id },\n      select: { role: true },\n    });\n\n    if (!user) {\n      return NextResponse.json({ isAdmin: false, role: null }, { status: 404 });\n    }\n\n    // 管理者かどうかをチェック\n    const isAdmin = user.role === 'ADMIN';\n\n    return NextResponse.json({ isAdmin, role: user.role });\n  } catch (error) {\n    console.error('ユーザーロール取得エラー:', error);\n    return NextResponse.json({ error: 'ユーザーロールの取得に失敗しました' }, { status: 500 });\n  }\n}\n"],"names":["GET","dynamic","request","session","getServerSession","authOptions","user","id","NextResponse","json","isAdmin","role","status","prisma","findUnique","where","select","error","console"],"mappings":";;;;;;;;;;;IAOsBA,GAAG;eAAHA;;IAFTC,OAAO;eAAPA;;;wBAL6B;0BACT;6BACL;wBACL;AAEhB,MAAMA,UAAU;AAEhB,eAAeD,IAAIE,OAAoB;IAC5C,IAAI;YAIGC;QAHL,mBAAmB;QACnB,MAAMA,UAAU,MAAMC,IAAAA,0BAAgB,EAACC,wBAAW;QAElD,IAAI,EAACF,oBAAAA,+BAAAA,gBAAAA,QAASG,IAAI,cAAbH,oCAAAA,cAAeI,EAAE,GAAE;YACtB,OAAOC,oBAAY,CAACC,IAAI,CAAC;gBAAEC,SAAS;gBAAOC,MAAM;YAAK,GAAG;gBAAEC,QAAQ;YAAI;QACzE;QAEA,aAAa;QACb,MAAMN,OAAO,MAAMO,cAAM,CAACP,IAAI,CAACQ,UAAU,CAAC;YACxCC,OAAO;gBAAER,IAAIJ,QAAQG,IAAI,CAACC,EAAE;YAAC;YAC7BS,QAAQ;gBAAEL,MAAM;YAAK;QACvB;QAEA,IAAI,CAACL,MAAM;YACT,OAAOE,oBAAY,CAACC,IAAI,CAAC;gBAAEC,SAAS;gBAAOC,MAAM;YAAK,GAAG;gBAAEC,QAAQ;YAAI;QACzE;QAEA,eAAe;QACf,MAAMF,UAAUJ,KAAKK,IAAI,KAAK;QAE9B,OAAOH,oBAAY,CAACC,IAAI,CAAC;YAAEC;YAASC,MAAML,KAAKK,IAAI;QAAC;IACtD,EAAE,OAAOM,OAAO;QACdC,QAAQD,KAAK,CAAC,iBAAiBA;QAC/B,OAAOT,oBAAY,CAACC,IAAI,CAAC;YAAEQ,OAAO;QAAoB,GAAG;YAAEL,QAAQ;QAAI;IACzE;AACF"}