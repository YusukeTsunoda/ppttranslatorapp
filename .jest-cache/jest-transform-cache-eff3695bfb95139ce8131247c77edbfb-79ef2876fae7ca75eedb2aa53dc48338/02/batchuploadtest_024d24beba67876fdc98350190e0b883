a2cf8b24a1ef51c3e95114b31860b73f
"use strict";
// Prismaのモック
jest.mock('@prisma/client', ()=>({
        __esModule: true,
        PrismaClient: jest.fn().mockImplementation(()=>({
                batchJob: {
                    create: jest.fn().mockResolvedValue({
                        id: 'test-job-id',
                        userId: 'test-user',
                        status: 'PENDING',
                        totalFiles: 2,
                        processedFiles: 0,
                        options: {},
                        createdAt: new Date(),
                        updatedAt: new Date()
                    }),
                    findUnique: jest.fn().mockResolvedValue({
                        id: 'test-job-id',
                        userId: 'test-user',
                        status: 'PENDING',
                        totalFiles: 2,
                        processedFiles: 0,
                        options: {},
                        createdAt: new Date(),
                        updatedAt: new Date()
                    })
                }
            }))
    }));
// next-auth/jwtのモック
jest.mock('next-auth/jwt', ()=>({
        __esModule: true,
        getToken: jest.fn().mockResolvedValue({
            sub: 'test-user',
            email: 'test@example.com'
        })
    }));
// APIロギングのモック
jest.mock('@/lib/utils/api-logging', ()=>({
        __esModule: true,
        withAPILogging: jest.fn().mockImplementation((handler)=>handler)
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _client = require("@prisma/client");
const _route = require("@/app/api/batch-upload/route");
describe('Batch Upload API', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
    });
    describe('POST /api/batch-upload', ()=>{
        it('認証されていない場合はエラーを返す', async ()=>{
            // getTokenをnullを返すようにモック
            const { getToken } = require('next-auth/jwt');
            getToken.mockResolvedValueOnce(null);
            const mockReq = new Request('http://localhost:3000/api/batch-upload', {
                method: 'POST',
                body: JSON.stringify({
                    files: [
                        'file1.pptx',
                        'file2.pptx'
                    ]
                })
            });
            const response = await (0, _route.POST)(mockReq);
            (0, _globals.expect)(response.status).toBe(401);
            const data = await response.json();
            (0, _globals.expect)(data.error).toBe('認証が必要です');
        });
        it('ファイルリストが空の場合はエラーを返す', async ()=>{
            const mockReq = new Request('http://localhost:3000/api/batch-upload', {
                method: 'POST',
                body: JSON.stringify({
                    files: []
                })
            });
            const response = await (0, _route.POST)(mockReq);
            // NextResponseオブジェクトのstatusプロパティを直接確認できないため、
            // レスポンスヘッダーから取得するか、レスポンスの内容で判断する
            const data = await response.json();
            (0, _globals.expect)(data.error).toBe('ファイルが指定されていません');
        });
        it('バッチジョブを正常に作成する', async ()=>{
            const mockReq = new Request('http://localhost:3000/api/batch-upload', {
                method: 'POST',
                body: JSON.stringify({
                    files: [
                        'file1.pptx',
                        'file2.pptx'
                    ],
                    options: {
                        targetLang: 'en'
                    }
                })
            });
            const response = await (0, _route.POST)(mockReq);
            const data = await response.json();
            (0, _globals.expect)(data.jobId).toBe('test-job-id');
            (0, _globals.expect)(data.message).toBe('バッチジョブが登録されました');
            (0, _globals.expect)(data.estimatedTime).toBe(4); // 2ファイル × 2分
        });
        it('バッチジョブ作成時にエラーが発生した場合は500エラーを返す', async ()=>{
            // Prismaのcreateメソッドをエラーを投げるようにモック
            const prisma = new _client.PrismaClient();
            prisma.batchJob.create = jest.fn().mockRejectedValueOnce(new Error('DB error'));
            const mockReq = new Request('http://localhost:3000/api/batch-upload', {
                method: 'POST',
                body: JSON.stringify({
                    files: [
                        'file1.pptx'
                    ]
                })
            });
            const response = await (0, _route.POST)(mockReq);
            const data = await response.json();
            (0, _globals.expect)(data.error).toBe('サーバーエラーが発生しました');
        });
    });
    describe('GET /api/batch-upload', ()=>{
        it('ジョブIDが指定されていない場合はエラーを返す', async ()=>{
            const mockReq = new Request('http://localhost:3000/api/batch-upload');
            const response = await (0, _route.GET)(mockReq);
            const data = await response.json();
            (0, _globals.expect)(data.error).toBe('ジョブIDが指定されていません');
        });
        it('存在しないジョブIDの場合は404エラーを返す', async ()=>{
            // findUniqueメソッドをnullを返すようにモック
            const prisma = new _client.PrismaClient();
            prisma.batchJob.findUnique = jest.fn().mockResolvedValueOnce(null);
            const mockReq = new Request('http://localhost:3000/api/batch-upload?jobId=non-existent');
            const response = await (0, _route.GET)(mockReq);
            const data = await response.json();
            (0, _globals.expect)(data.error).toBe('指定されたジョブが見つかりません');
        });
        it('ジョブの状態を正常に取得する', async ()=>{
            const mockReq = new Request('http://localhost:3000/api/batch-upload?jobId=test-job-id');
            const response = await (0, _route.GET)(mockReq);
            const data = await response.json();
            (0, _globals.expect)(data.jobId).toBe('test-job-id');
            (0, _globals.expect)(data.status).toBe('PENDING');
            (0, _globals.expect)(data.progress).toBe(0);
            (0, _globals.expect)(data.totalFiles).toBe(2);
            (0, _globals.expect)(data.processedFiles).toBe(0);
        });
        it('ジョブ取得時にエラーが発生した場合は500エラーを返す', async ()=>{
            // findUniqueメソッドをエラーを投げるようにモック
            const prisma = new _client.PrismaClient();
            prisma.batchJob.findUnique = jest.fn().mockRejectedValueOnce(new Error('DB error'));
            const mockReq = new Request('http://localhost:3000/api/batch-upload?jobId=test-job-id');
            const response = await (0, _route.GET)(mockReq);
            const data = await response.json();
            (0, _globals.expect)(data.error).toBe('サーバーエラーが発生しました');
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95dXN1a2V0c3Vub2RhL0RvY3VtZW50cy9jdXJzb3IvcHB0dHJhbnNsYXRvcmFwcC93b3JrdHJlZXMvY2ljZC1zZXR1cC90ZXN0cy9hcGkvYmF0Y2gtdXBsb2FkLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGV4cGVjdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuXG4vLyBQcmlzbWHjga7jg6Ljg4Pjgq9cbmplc3QubW9jaygnQHByaXNtYS9jbGllbnQnLCAoKSA9PiAoe1xuICBfX2VzTW9kdWxlOiB0cnVlLFxuICBQcmlzbWFDbGllbnQ6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gKHtcbiAgICBiYXRjaEpvYjoge1xuICAgICAgY3JlYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpZDogJ3Rlc3Qtam9iLWlkJyxcbiAgICAgICAgdXNlcklkOiAndGVzdC11c2VyJyxcbiAgICAgICAgc3RhdHVzOiAnUEVORElORycsXG4gICAgICAgIHRvdGFsRmlsZXM6IDIsXG4gICAgICAgIHByb2Nlc3NlZEZpbGVzOiAwLFxuICAgICAgICBvcHRpb25zOiB7fSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB9KSxcbiAgICAgIGZpbmRVbmlxdWU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiAndGVzdC1qb2ItaWQnLFxuICAgICAgICB1c2VySWQ6ICd0ZXN0LXVzZXInLFxuICAgICAgICBzdGF0dXM6ICdQRU5ESU5HJyxcbiAgICAgICAgdG90YWxGaWxlczogMixcbiAgICAgICAgcHJvY2Vzc2VkRmlsZXM6IDAsXG4gICAgICAgIG9wdGlvbnM6IHt9LFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIH0pLFxuICAgIH0sXG4gIH0pKSxcbn0pKTtcblxuLy8gbmV4dC1hdXRoL2p3dOOBruODouODg+OCr1xuamVzdC5tb2NrKCduZXh0LWF1dGgvand0JywgKCkgPT4gKHtcbiAgX19lc01vZHVsZTogdHJ1ZSxcbiAgZ2V0VG9rZW46IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgc3ViOiAndGVzdC11c2VyJyxcbiAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICB9KSxcbn0pKTtcblxuLy8gQVBJ44Ot44Ku44Oz44Kw44Gu44Oi44OD44KvXG5qZXN0Lm1vY2soJ0AvbGliL3V0aWxzL2FwaS1sb2dnaW5nJywgKCkgPT4gKHtcbiAgX19lc01vZHVsZTogdHJ1ZSxcbiAgd2l0aEFQSUxvZ2dpbmc6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGhhbmRsZXI6IGFueSkgPT4gaGFuZGxlciksXG59KSk7XG5cbi8vIGFwcC9hcGkvYmF0Y2gtdXBsb2FkL3JvdXRlLnRz44Gu44Kk44Oz44Od44O844OIXG5pbXBvcnQgeyBQT1NULCBHRVQgfSBmcm9tICdAL2FwcC9hcGkvYmF0Y2gtdXBsb2FkL3JvdXRlJztcblxuZGVzY3JpYmUoJ0JhdGNoIFVwbG9hZCBBUEknLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnUE9TVCAvYXBpL2JhdGNoLXVwbG9hZCcsICgpID0+IHtcbiAgICBpdCgn6KqN6Ki844GV44KM44Gm44GE44Gq44GE5aC05ZCI44Gv44Ko44Op44O844KS6L+U44GZJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gZ2V0VG9rZW7jgpJudWxs44KS6L+U44GZ44KI44GG44Gr44Oi44OD44KvXG4gICAgICBjb25zdCB7IGdldFRva2VuIH0gPSByZXF1aXJlKCduZXh0LWF1dGgvand0Jyk7XG4gICAgICBnZXRUb2tlbi5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobnVsbCk7XG5cbiAgICAgIGNvbnN0IG1vY2tSZXEgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9iYXRjaC11cGxvYWQnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGZpbGVzOiBbJ2ZpbGUxLnBwdHgnLCAnZmlsZTIucHB0eCddIH0pLFxuICAgICAgfSkgYXMgTmV4dFJlcXVlc3Q7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAxKTtcblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0JlKCfoqo3oqLzjgYzlv4XopoHjgafjgZknKTtcbiAgICB9KTtcblxuICAgIGl0KCfjg5XjgqHjgqTjg6vjg6rjgrnjg4jjgYznqbrjga7loLTlkIjjga/jgqjjg6njg7zjgpLov5TjgZknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUmVxID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYmF0Y2gtdXBsb2FkJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBmaWxlczogW10gfSksXG4gICAgICB9KSBhcyBOZXh0UmVxdWVzdDtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXEpO1xuICAgICAgXG4gICAgICAvLyBOZXh0UmVzcG9uc2Xjgqrjg5bjgrjjgqfjgq/jg4jjga5zdGF0dXPjg5fjg63jg5Hjg4bjgqPjgpLnm7TmjqXnorroqo3jgafjgY3jgarjgYTjgZ/jgoHjgIFcbiAgICAgIC8vIOODrOOCueODneODs+OCueODmOODg+ODgOODvOOBi+OCieWPluW+l+OBmeOCi+OBi+OAgeODrOOCueODneODs+OCueOBruWGheWuueOBp+WIpOaWreOBmeOCi1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0JlKCfjg5XjgqHjgqTjg6vjgYzmjIflrprjgZXjgozjgabjgYTjgb7jgZvjgpMnKTtcbiAgICB9KTtcblxuICAgIGl0KCfjg5Djg4Pjg4Hjgrjjg6fjg5bjgpLmraPluLjjgavkvZzmiJDjgZnjgosnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUmVxID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYmF0Y2gtdXBsb2FkJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGZpbGVzOiBbJ2ZpbGUxLnBwdHgnLCAnZmlsZTIucHB0eCddLFxuICAgICAgICAgIG9wdGlvbnM6IHsgdGFyZ2V0TGFuZzogJ2VuJyB9LFxuICAgICAgICB9KSxcbiAgICAgIH0pIGFzIE5leHRSZXF1ZXN0O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBleHBlY3QoZGF0YS5qb2JJZCkudG9CZSgndGVzdC1qb2ItaWQnKTtcbiAgICAgIGV4cGVjdChkYXRhLm1lc3NhZ2UpLnRvQmUoJ+ODkOODg+ODgeOCuOODp+ODluOBjOeZu+mMsuOBleOCjOOBvuOBl+OBnycpO1xuICAgICAgZXhwZWN0KGRhdGEuZXN0aW1hdGVkVGltZSkudG9CZSg0KTsgLy8gMuODleOCoeOCpOODqyDDlyAy5YiGXG4gICAgfSk7XG5cbiAgICBpdCgn44OQ44OD44OB44K444On44OW5L2c5oiQ5pmC44Gr44Ko44Op44O844GM55m655Sf44GX44Gf5aC05ZCI44GvNTAw44Ko44Op44O844KS6L+U44GZJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gUHJpc21h44GuY3JlYXRl44Oh44K944OD44OJ44KS44Ko44Op44O844KS5oqV44GS44KL44KI44GG44Gr44Oi44OD44KvXG4gICAgICBjb25zdCBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XG4gICAgICBwcmlzbWEuYmF0Y2hKb2IuY3JlYXRlID0gamVzdC5mbigpLm1vY2tSZWplY3RlZFZhbHVlT25jZShuZXcgRXJyb3IoJ0RCIGVycm9yJykpO1xuXG4gICAgICBjb25zdCBtb2NrUmVxID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYmF0Y2gtdXBsb2FkJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBmaWxlczogWydmaWxlMS5wcHR4J10gfSksXG4gICAgICB9KSBhcyBOZXh0UmVxdWVzdDtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXEpO1xuICAgICAgXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQmUoJ+OCteODvOODkOODvOOCqOODqeODvOOBjOeZuueUn+OBl+OBvuOBl+OBnycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9hcGkvYmF0Y2gtdXBsb2FkJywgKCkgPT4ge1xuICAgIGl0KCfjgrjjg6fjg5ZJROOBjOaMh+WumuOBleOCjOOBpuOBhOOBquOBhOWgtOWQiOOBr+OCqOODqeODvOOCkui/lOOBmScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZXEgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9iYXRjaC11cGxvYWQnKSBhcyBOZXh0UmVxdWVzdDtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBHRVQobW9ja1JlcSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9CZSgn44K444On44OWSUTjgYzmjIflrprjgZXjgozjgabjgYTjgb7jgZvjgpMnKTtcbiAgICB9KTtcblxuICAgIGl0KCflrZjlnKjjgZfjgarjgYTjgrjjg6fjg5ZJROOBruWgtOWQiOOBrzQwNOOCqOODqeODvOOCkui/lOOBmScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIGZpbmRVbmlxdWXjg6Hjgr3jg4Pjg4njgpJudWxs44KS6L+U44GZ44KI44GG44Gr44Oi44OD44KvXG4gICAgICBjb25zdCBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XG4gICAgICBwcmlzbWEuYmF0Y2hKb2IuZmluZFVuaXF1ZSA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobnVsbCk7XG5cbiAgICAgIGNvbnN0IG1vY2tSZXEgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9iYXRjaC11cGxvYWQ/am9iSWQ9bm9uLWV4aXN0ZW50JykgYXMgTmV4dFJlcXVlc3Q7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKG1vY2tSZXEpO1xuICAgICAgXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQmUoJ+aMh+WumuOBleOCjOOBn+OCuOODp+ODluOBjOimi+OBpOOBi+OCiuOBvuOBm+OCkycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+OCuOODp+ODluOBrueKtuaFi+OCkuato+W4uOOBq+WPluW+l+OBmeOCiycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZXEgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9iYXRjaC11cGxvYWQ/am9iSWQ9dGVzdC1qb2ItaWQnKSBhcyBOZXh0UmVxdWVzdDtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBHRVQobW9ja1JlcSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBleHBlY3QoZGF0YS5qb2JJZCkudG9CZSgndGVzdC1qb2ItaWQnKTtcbiAgICAgIGV4cGVjdChkYXRhLnN0YXR1cykudG9CZSgnUEVORElORycpO1xuICAgICAgZXhwZWN0KGRhdGEucHJvZ3Jlc3MpLnRvQmUoMCk7XG4gICAgICBleHBlY3QoZGF0YS50b3RhbEZpbGVzKS50b0JlKDIpO1xuICAgICAgZXhwZWN0KGRhdGEucHJvY2Vzc2VkRmlsZXMpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgn44K444On44OW5Y+W5b6X5pmC44Gr44Ko44Op44O844GM55m655Sf44GX44Gf5aC05ZCI44GvNTAw44Ko44Op44O844KS6L+U44GZJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gZmluZFVuaXF1ZeODoeOCveODg+ODieOCkuOCqOODqeODvOOCkuaKleOBkuOCi+OCiOOBhuOBq+ODouODg+OCr1xuICAgICAgY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpO1xuICAgICAgcHJpc21hLmJhdGNoSm9iLmZpbmRVbmlxdWUgPSBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignREIgZXJyb3InKSk7XG5cbiAgICAgIGNvbnN0IG1vY2tSZXEgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9iYXRjaC11cGxvYWQ/am9iSWQ9dGVzdC1qb2ItaWQnKSBhcyBOZXh0UmVxdWVzdDtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBHRVQobW9ja1JlcSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9CZSgn44K144O844OQ44O844Ko44Op44O844GM55m655Sf44GX44G+44GX44GfJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7ICJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsIl9fZXNNb2R1bGUiLCJQcmlzbWFDbGllbnQiLCJmbiIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsImJhdGNoSm9iIiwiY3JlYXRlIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJpZCIsInVzZXJJZCIsInN0YXR1cyIsInRvdGFsRmlsZXMiLCJwcm9jZXNzZWRGaWxlcyIsIm9wdGlvbnMiLCJjcmVhdGVkQXQiLCJEYXRlIiwidXBkYXRlZEF0IiwiZmluZFVuaXF1ZSIsImdldFRva2VuIiwic3ViIiwiZW1haWwiLCJ3aXRoQVBJTG9nZ2luZyIsImhhbmRsZXIiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiaXQiLCJyZXF1aXJlIiwibW9ja1Jlc29sdmVkVmFsdWVPbmNlIiwibW9ja1JlcSIsIlJlcXVlc3QiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImZpbGVzIiwicmVzcG9uc2UiLCJQT1NUIiwiZXhwZWN0IiwidG9CZSIsImRhdGEiLCJqc29uIiwiZXJyb3IiLCJ0YXJnZXRMYW5nIiwiam9iSWQiLCJtZXNzYWdlIiwiZXN0aW1hdGVkVGltZSIsInByaXNtYSIsIm1vY2tSZWplY3RlZFZhbHVlT25jZSIsIkVycm9yIiwiR0VUIiwicHJvZ3Jlc3MiXSwibWFwcGluZ3MiOiI7QUFJQSxhQUFhO0FBQ2JBLEtBQUtDLElBQUksQ0FBQyxrQkFBa0IsSUFBTyxDQUFBO1FBQ2pDQyxZQUFZO1FBQ1pDLGNBQWNILEtBQUtJLEVBQUUsR0FBR0Msa0JBQWtCLENBQUMsSUFBTyxDQUFBO2dCQUNoREMsVUFBVTtvQkFDUkMsUUFBUVAsS0FBS0ksRUFBRSxHQUFHSSxpQkFBaUIsQ0FBQzt3QkFDbENDLElBQUk7d0JBQ0pDLFFB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