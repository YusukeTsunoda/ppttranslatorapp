932ffe9d70ea1f96de6513085958a7f3
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _interop_require_default = require("@swc/helpers/_/_interop_require_default");
const _react = /*#__PURE__*/ _interop_require_default._(require("react"));
const _react1 = require("@testing-library/react");
const _useIntersectionObserver = require("@/lib/hooks/useIntersectionObserver");
// IntersectionObserverのモック
const mockObserve = jest.fn();
const mockDisconnect = jest.fn();
const mockIntersectionObserver = jest.fn().mockImplementation((callback, options)=>({
        observe: mockObserve,
        disconnect: mockDisconnect,
        unobserve: jest.fn(),
        takeRecords: jest.fn(()=>[]),
        root: null,
        rootMargin: '',
        thresholds: []
    }));
// グローバルにIntersectionObserverをモック
global.IntersectionObserver = mockIntersectionObserver;
describe('useIntersectionObserver', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
    });
    it('要素が存在する場合、IntersectionObserverを初期化して監視する', ()=>{
        // モック要素の作成
        const mockRef = {
            current: document.createElement('div')
        };
        const mockCallback = jest.fn();
        const mockOptions = {
            rootMargin: '10px'
        };
        // フックをレンダリング
        (0, _react1.renderHook)(()=>(0, _useIntersectionObserver.useIntersectionObserver)(mockRef, mockCallback, mockOptions));
        // IntersectionObserverが正しく初期化されたか確認
        expect(mockIntersectionObserver).toHaveBeenCalledWith(mockCallback, mockOptions);
        // 要素が監視対象に追加されたか確認
        expect(mockObserve).toHaveBeenCalledWith(mockRef.current);
    });
    it('要素が存在しない場合、IntersectionObserverを初期化しない', ()=>{
        // nullの参照を作成
        const mockRef = {
            current: null
        };
        const mockCallback = jest.fn();
        // フックをレンダリング
        (0, _react1.renderHook)(()=>(0, _useIntersectionObserver.useIntersectionObserver)(mockRef, mockCallback));
        // IntersectionObserverが初期化されていないことを確認
        expect(mockIntersectionObserver).not.toHaveBeenCalled();
        expect(mockObserve).not.toHaveBeenCalled();
    });
    it('アンマウント時にIntersectionObserverを切断する', ()=>{
        // モック要素の作成
        const mockRef = {
            current: document.createElement('div')
        };
        const mockCallback = jest.fn();
        // フックをレンダリングして解除
        const { unmount } = (0, _react1.renderHook)(()=>(0, _useIntersectionObserver.useIntersectionObserver)(mockRef, mockCallback));
        unmount();
        // disconnectが呼ばれたことを確認
        expect(mockDisconnect).toHaveBeenCalled();
    });
    it('依存配列の値が変更された場合、IntersectionObserverを再初期化する', ()=>{
        // モック要素の作成
        const mockRef = {
            current: document.createElement('div')
        };
        const mockCallback1 = jest.fn();
        const mockCallback2 = jest.fn();
        // 初回レンダリング
        const { rerender } = (0, _react1.renderHook)(({ callback })=>(0, _useIntersectionObserver.useIntersectionObserver)(mockRef, callback), {
            initialProps: {
                callback: mockCallback1
            }
        });
        // 再レンダリング（コールバックを変更）
        rerender({
            callback: mockCallback2
        });
        // IntersectionObserverが2回初期化されたことを確認
        expect(mockIntersectionObserver).toHaveBeenCalledTimes(2);
        expect(mockDisconnect).toHaveBeenCalledTimes(1);
        expect(mockObserve).toHaveBeenCalledTimes(2);
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95dXN1a2V0c3Vub2RhL0RvY3VtZW50cy9jdXJzb3IvcHB0dHJhbnNsYXRvcmFwcC93b3JrdHJlZXMvY2ljZC1zZXR1cC90ZXN0cy9ob29rcy91c2VJbnRlcnNlY3Rpb25PYnNlcnZlci50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgcmVuZGVySG9vayB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHsgdXNlSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgfSBmcm9tICdAL2xpYi9ob29rcy91c2VJbnRlcnNlY3Rpb25PYnNlcnZlcic7XG5cbi8vIEludGVyc2VjdGlvbk9ic2VydmVy44Go44Gd44Gu44Kz44O844Or44OQ44OD44Kv5Z6L44Gu5a6a576pXG50eXBlIEludGVyc2VjdGlvbk9ic2VydmVyQ2FsbGJhY2sgPSAoZW50cmllczogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeVtdLCBvYnNlcnZlcjogSW50ZXJzZWN0aW9uT2JzZXJ2ZXIpID0+IHZvaWQ7XG5cbi8vIEludGVyc2VjdGlvbk9ic2VydmVy44Gu44Oi44OD44KvXG5jb25zdCBtb2NrT2JzZXJ2ZSA9IGplc3QuZm4oKTtcbmNvbnN0IG1vY2tEaXNjb25uZWN0ID0gamVzdC5mbigpO1xuY29uc3QgbW9ja0ludGVyc2VjdGlvbk9ic2VydmVyID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgKGNhbGxiYWNrOiBJbnRlcnNlY3Rpb25PYnNlcnZlckNhbGxiYWNrLCBvcHRpb25zPzogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0KSA9PiAoe1xuICAgIG9ic2VydmU6IG1vY2tPYnNlcnZlLFxuICAgIGRpc2Nvbm5lY3Q6IG1vY2tEaXNjb25uZWN0LFxuICAgIHVub2JzZXJ2ZTogamVzdC5mbigpLFxuICAgIHRha2VSZWNvcmRzOiBqZXN0LmZuKCgpID0+IFtdKSxcbiAgICByb290OiBudWxsLFxuICAgIHJvb3RNYXJnaW46ICcnLFxuICAgIHRocmVzaG9sZHM6IFtdLFxuICB9KVxuKTtcblxuLy8g44Kw44Ot44O844OQ44Or44GrSW50ZXJzZWN0aW9uT2JzZXJ2ZXLjgpLjg6Ljg4Pjgq9cbmdsb2JhbC5JbnRlcnNlY3Rpb25PYnNlcnZlciA9IG1vY2tJbnRlcnNlY3Rpb25PYnNlcnZlciBhcyB1bmtub3duIGFzIHR5cGVvZiBJbnRlcnNlY3Rpb25PYnNlcnZlcjtcblxuZGVzY3JpYmUoJ3VzZUludGVyc2VjdGlvbk9ic2VydmVyJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgaXQoJ+imgee0oOOBjOWtmOWcqOOBmeOCi+WgtOWQiOOAgUludGVyc2VjdGlvbk9ic2VydmVy44KS5Yid5pyf5YyW44GX44Gm55uj6KaW44GZ44KLJywgKCkgPT4ge1xuICAgIC8vIOODouODg+OCr+imgee0oOOBruS9nOaIkFxuICAgIGNvbnN0IG1vY2tSZWYgPSB7IGN1cnJlbnQ6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpIH07XG4gICAgY29uc3QgbW9ja0NhbGxiYWNrID0gamVzdC5mbigpO1xuICAgIGNvbnN0IG1vY2tPcHRpb25zID0geyByb290TWFyZ2luOiAnMTBweCcgfTtcblxuICAgIC8vIOODleODg+OCr+OCkuODrOODs+ODgOODquODs+OCsFxuICAgIHJlbmRlckhvb2soKCkgPT4gdXNlSW50ZXJzZWN0aW9uT2JzZXJ2ZXIobW9ja1JlZiBhcyBSZWFjdC5SZWZPYmplY3Q8RWxlbWVudD4sIG1vY2tDYWxsYmFjaywgbW9ja09wdGlvbnMpKTtcblxuICAgIC8vIEludGVyc2VjdGlvbk9ic2VydmVy44GM5q2j44GX44GP5Yid5pyf5YyW44GV44KM44Gf44GL56K66KqNXG4gICAgZXhwZWN0KG1vY2tJbnRlcnNlY3Rpb25PYnNlcnZlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0NhbGxiYWNrLCBtb2NrT3B0aW9ucyk7XG5cbiAgICAvLyDopoHntKDjgYznm6Poppblr77osaHjgavov73liqDjgZXjgozjgZ/jgYvnorroqo1cbiAgICBleHBlY3QobW9ja09ic2VydmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tSZWYuY3VycmVudCk7XG4gIH0pO1xuXG4gIGl0KCfopoHntKDjgYzlrZjlnKjjgZfjgarjgYTloLTlkIjjgIFJbnRlcnNlY3Rpb25PYnNlcnZlcuOCkuWIneacn+WMluOBl+OBquOBhCcsICgpID0+IHtcbiAgICAvLyBudWxs44Gu5Y+C54Wn44KS5L2c5oiQXG4gICAgY29uc3QgbW9ja1JlZiA9IHsgY3VycmVudDogbnVsbCB9O1xuICAgIGNvbnN0IG1vY2tDYWxsYmFjayA9IGplc3QuZm4oKTtcblxuICAgIC8vIOODleODg+OCr+OCkuODrOODs+ODgOODquODs+OCsFxuICAgIHJlbmRlckhvb2soKCkgPT4gdXNlSW50ZXJzZWN0aW9uT2JzZXJ2ZXIobW9ja1JlZiBhcyBSZWFjdC5SZWZPYmplY3Q8RWxlbWVudD4sIG1vY2tDYWxsYmFjaykpO1xuXG4gICAgLy8gSW50ZXJzZWN0aW9uT2JzZXJ2ZXLjgYzliJ3mnJ/ljJbjgZXjgozjgabjgYTjgarjgYTjgZPjgajjgpLnorroqo1cbiAgICBleHBlY3QobW9ja0ludGVyc2VjdGlvbk9ic2VydmVyKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIGV4cGVjdChtb2NrT2JzZXJ2ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgfSk7XG5cbiAgaXQoJ+OCouODs+ODnuOCpuODs+ODiOaZguOBq0ludGVyc2VjdGlvbk9ic2VydmVy44KS5YiH5pat44GZ44KLJywgKCkgPT4ge1xuICAgIC8vIOODouODg+OCr+imgee0oOOBruS9nOaIkFxuICAgIGNvbnN0IG1vY2tSZWYgPSB7IGN1cnJlbnQ6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpIH07XG4gICAgY29uc3QgbW9ja0NhbGxiYWNrID0gamVzdC5mbigpO1xuXG4gICAgLy8g44OV44OD44Kv44KS44Os44Oz44OA44Oq44Oz44Kw44GX44Gm6Kej6ZmkXG4gICAgY29uc3QgeyB1bm1vdW50IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUludGVyc2VjdGlvbk9ic2VydmVyKG1vY2tSZWYgYXMgUmVhY3QuUmVmT2JqZWN0PEVsZW1lbnQ+LCBtb2NrQ2FsbGJhY2spKTtcbiAgICB1bm1vdW50KCk7XG5cbiAgICAvLyBkaXNjb25uZWN044GM5ZG844Gw44KM44Gf44GT44Go44KS56K66KqNXG4gICAgZXhwZWN0KG1vY2tEaXNjb25uZWN0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xuXG4gIGl0KCfkvp3lrZjphY3liJfjga7lgKTjgYzlpInmm7TjgZXjgozjgZ/loLTlkIjjgIFJbnRlcnNlY3Rpb25PYnNlcnZlcuOCkuWGjeWIneacn+WMluOBmeOCiycsICgpID0+IHtcbiAgICAvLyDjg6Ljg4Pjgq/opoHntKDjga7kvZzmiJBcbiAgICBjb25zdCBtb2NrUmVmID0geyBjdXJyZW50OiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSB9O1xuICAgIGNvbnN0IG1vY2tDYWxsYmFjazEgPSBqZXN0LmZuKCk7XG4gICAgY29uc3QgbW9ja0NhbGxiYWNrMiA9IGplc3QuZm4oKTtcblxuICAgIC8vIOWIneWbnuODrOODs+ODgOODquODs+OCsFxuICAgIGNvbnN0IHsgcmVyZW5kZXIgfSA9IHJlbmRlckhvb2soXG4gICAgICAoeyBjYWxsYmFjayB9KSA9PiB1c2VJbnRlcnNlY3Rpb25PYnNlcnZlcihtb2NrUmVmIGFzIFJlYWN0LlJlZk9iamVjdDxFbGVtZW50PiwgY2FsbGJhY2spLFxuICAgICAgeyBpbml0aWFsUHJvcHM6IHsgY2FsbGJhY2s6IG1vY2tDYWxsYmFjazEgfSB9LFxuICAgICk7XG5cbiAgICAvLyDlho3jg6zjg7Pjg4Djg6rjg7PjgrDvvIjjgrPjg7zjg6vjg5Djg4Pjgq/jgpLlpInmm7TvvIlcbiAgICByZXJlbmRlcih7IGNhbGxiYWNrOiBtb2NrQ2FsbGJhY2syIH0pO1xuXG4gICAgLy8gSW50ZXJzZWN0aW9uT2JzZXJ2ZXLjgYwy5Zue5Yid5pyf5YyW44GV44KM44Gf44GT44Go44KS56K66KqNXG4gICAgZXhwZWN0KG1vY2tJbnRlcnNlY3Rpb25PYnNlcnZlcikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgIGV4cGVjdChtb2NrRGlzY29ubmVjdCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChtb2NrT2JzZXJ2ZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbIm1vY2tPYnNlcnZlIiwiamVzdCIsImZuIiwibW9ja0Rpc2Nvbm5lY3QiLCJtb2NrSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJjYWxsYmFjayIsIm9wdGlvbnMiLCJvYnNlcnZlIiwiZGlzY29ubmVjdCIsInVub2JzZXJ2ZSIsInRha2VSZWNvcmRzIiwicm9vdCIsInJvb3RNYXJnaW4iLCJ0aHJlc2hvbGRzIiwiZ2xvYmFsIiwiSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiaXQiLCJtb2NrUmVmIiwiY3VycmVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm1vY2tDYWxsYmFjayIsIm1vY2tPcHRpb25zIiwicmVuZGVySG9vayIsInVzZUludGVyc2VjdGlvbk9ic2VydmVyIiwiZXhwZWN0IiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJub3QiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwidW5tb3VudCIsIm1vY2tDYWxsYmFjazEiLCJtb2NrQ2FsbGJhY2syIiwicmVyZW5kZXIiLCJpbml0aWFsUHJvcHMiLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiXSwibWFwcGluZ3MiOiI7Ozs7O2dFQUFrQjt3QkFDUzt5Q0FDYTtBQUt4QywyQkFBMkI7QUFDM0IsTUFBTUEsY0FBY0MsS0FBS0MsRUFBRTtBQUMzQixNQUFNQyxp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