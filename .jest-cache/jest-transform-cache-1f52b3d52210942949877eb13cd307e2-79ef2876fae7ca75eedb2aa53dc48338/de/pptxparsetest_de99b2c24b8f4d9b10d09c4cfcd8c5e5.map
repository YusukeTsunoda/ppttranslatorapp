{"version":3,"sources":["/Users/yusuketsunoda/Documents/cursor/ppttranslatorapp/worktrees/feature-test-coverage-improvement/tests/api/pptx-parse.test.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { expect } from '@jest/globals';\nimport fs from 'fs/promises';\nimport path from 'path';\n\n// PPTX„Éë„Éº„Çµ„Éº„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('@/lib/pptx/parser', () => ({\n  PPTXParser: {\n    getInstance: jest.fn().mockReturnValue({\n      parsePPTX: jest.fn().mockResolvedValue({\n        success: true,\n        slides: [\n          {\n            id: 'slide1',\n            title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ1',\n            content: '„Çπ„É©„Ç§„Éâ1„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n          },\n          {\n            id: 'slide2',\n            title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ2',\n            content: '„Çπ„É©„Ç§„Éâ2„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n          },\n        ],\n        metadata: {\n          title: '„ÉÜ„Çπ„Éà„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥',\n          author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n          totalSlides: 2,\n        },\n      }),\n    }),\n  },\n}));\n\n// Ë™çË®º„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('@/lib/auth/auth', () => ({\n  auth: jest.fn().mockResolvedValue({\n    user: {\n      id: 'test-user',\n      email: 'test@example.com',\n    },\n  }),\n}));\n\n// fs/promises„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('fs/promises', () => ({\n  mkdir: jest.fn().mockResolvedValue(undefined),\n  writeFile: jest.fn().mockResolvedValue(undefined),\n  readdir: jest.fn().mockResolvedValue(['file1.pptx', 'file2.pptx']),\n  unlink: jest.fn().mockResolvedValue(undefined),\n  rm: jest.fn().mockResolvedValue(undefined),\n}));\n\n// uuid„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('uuid', () => ({\n  v4: jest.fn().mockReturnValue('test-uuid'),\n}));\n\n// app/api/pptx/parse/route.ts„ÅÆ„É¢„ÉÉ„ÇØ\njest.mock('@/app/api/pptx/parse/route', () => {\n  // „É¢„ÉÉ„ÇØÁî®„ÅÆ„É¨„Çπ„Éù„É≥„ÇπÁîüÊàêÈñ¢Êï∞\n  const mockJsonResponse = (data: any, status = 200) => {\n    return {\n      json: () => Promise.resolve(data),\n      status,\n    };\n  };\n\n  return {\n    POST: jest.fn().mockImplementation(async (req) => {\n      const formData = await req.formData();\n      const file = formData.get('file');\n\n      if (!file) {\n        return mockJsonResponse({ success: false, error: '„Éï„Ç°„Ç§„É´„ÅåÊåáÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì' }, 400);\n      }\n\n      if (file.type !== 'application/vnd.openxmlformats-officedocument.presentationml.presentation') {\n        return mockJsonResponse({ success: false, error: 'PPTX„Éï„Ç°„Ç§„É´„ÅÆ„Åø„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂèØËÉΩ„Åß„Åô' }, 400);\n      }\n\n      return mockJsonResponse({\n        success: true,\n        fileId: 'test-uuid',\n        slides: [\n          {\n            id: 'slide1',\n            title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ1',\n            content: '„Çπ„É©„Ç§„Éâ1„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n          },\n          {\n            id: 'slide2',\n            title: '„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ2',\n            content: '„Çπ„É©„Ç§„Éâ2„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ',\n          },\n        ],\n        metadata: {\n          title: '„ÉÜ„Çπ„Éà„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥',\n          author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n          totalSlides: 2,\n        },\n      });\n    }),\n    GET: jest.fn().mockImplementation(() => {\n      return mockJsonResponse({\n        success: true,\n        message: 'PPTX„Éë„Éº„Çµ„ÉºAPI„ÅØÊ≠£Â∏∏„Å´Âãï‰Ωú„Åó„Å¶„ÅÑ„Åæ„Åô',\n      });\n    }),\n  };\n});\n\n// „Ç§„É≥„Éù„Éº„Éà„ÅØ„É¢„ÉÉ„ÇØ„ÅÆÂæå„Å´Ë°å„ÅÜ\nimport { POST, GET } from '@/app/api/pptx/parse/route';\nimport { auth } from '@/lib/auth/auth';\nimport { PPTXParser } from '@/lib/pptx/parser';\nimport fs from 'fs/promises';\n\ndescribe('PPTX Parse API', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('POST /api/pptx/parse', () => {\n    it('Ë™çË®º„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      // Ë™çË®º„É¢„ÉÉ„ÇØ„ÇíÊú™Ë™çË®ºÁä∂ÊÖã„Å´Ë®≠ÂÆö\n      (auth as jest.Mock).mockResolvedValueOnce(null);\n\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n\n      expect(response.status).toBe(401);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„É≠„Ç∞„Ç§„É≥„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n    });\n\n    it('„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅåÂà∂Èôê„ÇíË∂Ö„Åà„ÇãÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const mockFile = new File(['dummy content'.repeat(1000000)], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      Object.defineProperty(mockFile, 'size', { value: 21 * 1024 * 1024 }); // 21MB\n\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅØ20MB‰ª•‰∏ã„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n    });\n\n    it('‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´‰ΩúÊàê„Å´Â§±Êïó„Åó„ÅüÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      // mkdir„Çí„Ç®„É©„Éº„Å´„Åô„Çã\n      (fs.mkdir as jest.Mock).mockRejectedValueOnce(new Error('„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê„Ç®„É©„Éº'));\n\n      const response = await POST(mockReq);\n\n      expect(response.status).toBe(500);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê„Ç®„É©„Éº');\n    });\n\n    it('„Éë„Éº„ÇπÂá¶ÁêÜ„Å´Â§±Êïó„Åó„ÅüÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      // „Éë„Éº„ÇπÂá¶ÁêÜ„Çí„Ç®„É©„Éº„Å´„Åô„Çã\n      (PPTXParser.getInstance().parsePPTX as jest.Mock).mockRejectedValueOnce(new Error('„Éë„Éº„Çπ„Ç®„É©„Éº'));\n\n      const response = await POST(mockReq);\n\n      expect(response.status).toBe(500);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éë„Éº„Çπ„Ç®„É©„Éº');\n    });\n\n    it('‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´„ÅåÊ≠£„Åó„Åè„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„Åï„Çå„Çã', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      await POST(mockReq);\n\n      // ‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´„Å®„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆÂâäÈô§„ÅåÂëº„Å∞„Çå„Åü„Åì„Å®„ÇíÁ¢∫Ë™ç\n      expect(fs.unlink).toHaveBeenCalled();\n      expect(fs.rm).toHaveBeenCalledWith(expect.stringContaining('test-uuid'), { recursive: true });\n    });\n\n    it('ÊúâÂäπ„Å™PPTX„Éï„Ç°„Ç§„É´„Çí„Éë„Éº„Çπ„Åô„Çã', async () => {\n      // FormData„Å®File„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„É¢„ÉÉ„ÇØ\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      // „É™„ÇØ„Ç®„Çπ„Éà„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„É¢„ÉÉ„ÇØ\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      // API„Éè„É≥„Éâ„É©„ÇíÂëº„Å≥Âá∫„Åô\n      const response = await POST(mockReq);\n\n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÊ§úË®º\n      expect(response.status).toBe(200);\n\n      // „É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÇíÂèñÂæó\n      const data = await response.json();\n\n      // „É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÇíÊ§úË®º\n      expect(data.success).toBe(true);\n      expect(data.fileId).toBe('test-uuid');\n      expect(data.slides).toHaveLength(2);\n      expect(data.slides[0].title).toBe('„ÉÜ„Çπ„Éà„Çπ„É©„Ç§„Éâ1');\n      expect(data.metadata.title).toBe('„ÉÜ„Çπ„Éà„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥');\n    });\n\n    it('„Éï„Ç°„Ç§„É´„ÅåÊåáÂÆö„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      // Á©∫„ÅÆFormData„Çí‰ΩúÊàê\n      const formData = new FormData();\n\n      // „É™„ÇØ„Ç®„Çπ„Éà„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„É¢„ÉÉ„ÇØ\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      // API„Éè„É≥„Éâ„É©„ÇíÂëº„Å≥Âá∫„Åô\n      const response = await POST(mockReq);\n\n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÊ§úË®º\n      expect(response.status).toBe(400);\n\n      // „É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÇíÂèñÂæó\n      const data = await response.json();\n\n      // „É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÇíÊ§úË®º\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('„Éï„Ç°„Ç§„É´„ÅåÊåáÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n    });\n\n    it('ÁÑ°Âäπ„Å™„Éï„Ç°„Ç§„É´„Çø„Ç§„Éó„ÅÆÂ†¥Âêà„ÅØ„Ç®„É©„Éº„ÇíËøî„Åô', async () => {\n      // ÁÑ°Âäπ„Å™„Éï„Ç°„Ç§„É´„Çø„Ç§„Éó„ÅÆFile„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí‰ΩúÊàê\n      const mockFile = new File(['dummy content'], 'test.txt', {\n        type: 'text/plain',\n      });\n\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      // „É™„ÇØ„Ç®„Çπ„Éà„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„É¢„ÉÉ„ÇØ\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      // API„Éè„É≥„Éâ„É©„ÇíÂëº„Å≥Âá∫„Åô\n      const response = await POST(mockReq);\n\n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÊ§úË®º\n      expect(response.status).toBe(400);\n\n      // „É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÇíÂèñÂæó\n      const data = await response.json();\n\n      // „É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÇíÊ§úË®º\n      expect(data.success).toBe(false);\n      expect(data.error).toBe('PPTX„Éï„Ç°„Ç§„É´„ÅÆ„Åø„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂèØËÉΩ„Åß„Åô');\n    });\n\n    it('„É°„Çø„Éá„Éº„Çø„ÅÆË©≥Á¥∞„Å™Ê§úË®º„ÇíË°å„ÅÜ', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(data.metadata).toEqual({\n        title: '„ÉÜ„Çπ„Éà„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥',\n        author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n        totalSlides: 2,\n      });\n      expect(data.metadata).toHaveProperty('title');\n      expect(data.metadata).toHaveProperty('author');\n      expect(data.metadata).toHaveProperty('totalSlides');\n      expect(typeof data.metadata.title).toBe('string');\n      expect(typeof data.metadata.author).toBe('string');\n      expect(typeof data.metadata.totalSlides).toBe('number');\n    });\n\n    it('„Çπ„É©„Ç§„Éâ„ÅÆÊßãÈÄ†„ÅÆË©≥Á¥∞„Å™Ê§úË®º„ÇíË°å„ÅÜ', async () => {\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(Array.isArray(data.slides)).toBe(true);\n      data.slides.forEach((slide: any) => {\n        expect(slide).toHaveProperty('id');\n        expect(slide).toHaveProperty('title');\n        expect(slide).toHaveProperty('content');\n        expect(typeof slide.id).toBe('string');\n        expect(typeof slide.title).toBe('string');\n        expect(typeof slide.content).toBe('string');\n      });\n    });\n\n    it('Á©∫„ÅÆ„Çπ„É©„Ç§„Éâ„ÇíÂê´„ÇÄPPTX„Éï„Ç°„Ç§„É´„ÇíÂá¶ÁêÜ„Åô„Çã', async () => {\n      // PPTX„Éë„Éº„Çµ„Éº„ÅÆ„É¢„ÉÉ„ÇØ„Çí‰∏ÄÊôÇÁöÑ„Å´Â§âÊõ¥\n      (PPTXParser.getInstance().parsePPTX as jest.Mock).mockResolvedValueOnce({\n        success: true,\n        slides: [\n          {\n            id: 'empty-slide',\n            title: '',\n            content: '',\n          },\n          {\n            id: 'normal-slide',\n            title: 'Normal Slide',\n            content: 'Some content',\n          },\n        ],\n        metadata: {\n          title: 'Empty Slide Test',\n          author: 'Test User',\n          totalSlides: 2,\n        },\n      });\n\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(data.slides).toHaveLength(2);\n      expect(data.slides[0].title).toBe('');\n      expect(data.slides[0].content).toBe('');\n      expect(data.slides[1].title).toBe('Normal Slide');\n    });\n\n    it('ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄ„Çπ„É©„Ç§„Éâ„ÇíÂá¶ÁêÜ„Åô„Çã', async () => {\n      // PPTX„Éë„Éº„Çµ„Éº„ÅÆ„É¢„ÉÉ„ÇØ„Çí‰∏ÄÊôÇÁöÑ„Å´Â§âÊõ¥\n      (PPTXParser.getInstance().parsePPTX as jest.Mock).mockResolvedValueOnce({\n        success: true,\n        slides: [\n          {\n            id: 'special-chars',\n            title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„à±‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ',\n            content: 'ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ',\n          },\n        ],\n        metadata: {\n          title: 'ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà',\n          author: '„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº',\n          totalSlides: 1,\n        },\n      });\n\n      const mockFile = new File(['dummy content'], 'test.pptx', {\n        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      });\n      const formData = new FormData();\n      formData.append('file', mockFile);\n\n      const mockReq = {\n        formData: jest.fn().mockResolvedValue(formData),\n      } as unknown as NextRequest;\n\n      const response = await POST(mockReq);\n      const data = await response.json();\n\n      expect(data.success).toBe(true);\n      expect(data.slides).toHaveLength(1);\n      expect(data.slides[0].title).toBe('ÁâπÊÆäÊñáÂ≠ó„ÉÜ„Çπ„Éà: ‚ë†„à±‚ô™„ÄÅüéâÁµµÊñáÂ≠ó„ÇÇÔºÅ');\n      expect(data.slides[0].content).toBe('ÊîπË°å\\n„Çø„Éñ\\tÁâπÊÆäÊñáÂ≠ó¬©¬Æ');\n    });\n  });\n\n  describe('GET /api/pptx/parse', () => {\n    it('GET„É™„ÇØ„Ç®„Çπ„Éà„ÅØË®±ÂèØ„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑ', async () => {\n      const response = await GET();\n\n      expect(response.status).toBe(405);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.message).toBe('„É°„ÇΩ„ÉÉ„Éâ„ÅåË®±ÂèØ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n    });\n\n    it('„Éò„É´„Çπ„ÉÅ„Çß„ÉÉ„ÇØ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÅåÊ≠£Â∏∏„Å´ÂøúÁ≠î„Åô„Çã', async () => {\n      // API„Éè„É≥„Éâ„É©„ÇíÂëº„Å≥Âá∫„Åô\n      const response = await GET();\n\n      // „É¨„Çπ„Éù„É≥„Çπ„ÇíÊ§úË®º\n      expect(response.status).toBe(200);\n\n      // „É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÇíÂèñÂæó\n      const data = await response.json();\n\n      // „É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÇíÊ§úË®º\n      expect(data.success).toBe(true);\n      expect(data.message).toBe('PPTX„Éë„Éº„Çµ„ÉºAPI„ÅØÊ≠£Â∏∏„Å´Âãï‰Ωú„Åó„Å¶„ÅÑ„Åæ„Åô');\n    });\n  });\n});\n"],"names":["jest","mock","PPTXParser","getInstance","fn","mockReturnValue","parsePPTX","mockResolvedValue","success","slides","id","title","content","metadata","author","totalSlides","auth","user","email","mkdir","undefined","writeFile","readdir","unlink","rm","v4","mockJsonResponse","data","status","json","Promise","resolve","POST","mockImplementation","req","formData","file","get","error","type","fileId","GET","message","describe","beforeEach","clearAllMocks","it","mockResolvedValueOnce","mockFile","File","FormData","append","mockReq","response","expect","toBe","repeat","Object","defineProperty","value","fs","mockRejectedValueOnce","Error","toHaveBeenCalled","toHaveBeenCalledWith","stringContaining","recursive","toHaveLength","toEqual","toHaveProperty","Array","isArray","forEach","slide"],"mappings":"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"}