1dbb92106f5e4ffb986cfb3131ff539b
"use strict";
// モック
jest.mock('@/lib/db/prisma', ()=>({
        prisma: {
            user: {
                findUnique: jest.fn(()=>({
                        id: 'test-user-123'
                    }))
            },
            activityLog: {
                create: jest.fn()
            }
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _activitylogger = require("@/lib/utils/activity-logger");
// 実際の実装がコンソールログを出力するだけの場合のテスト
describe('ActivityLogger', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        jest.spyOn(console, 'log').mockImplementation(()=>{});
    });
    afterEach(()=>{
        jest.restoreAllMocks();
    });
    describe('logActivity', ()=>{
        const userId = 'test-user-123';
        const validActivityData = {
            userId,
            action: 'file_upload',
            metadata: {
                fileId: 'test-file-456',
                fileName: 'test.pptx'
            }
        };
        it('有効なデータでアクティビティを記録する', async ()=>{
            const consoleSpy = jest.spyOn(console, 'log');
            await (0, _activitylogger.logActivity)(validActivityData);
            // コンソールログが呼ばれたことを確認
            expect(consoleSpy).toHaveBeenCalled();
            expect(consoleSpy).toHaveBeenCalledWith('Activity logged (dummy):', expect.objectContaining({
                userId,
                action: validActivityData.action
            }));
        });
        it('必須パラメータが不足している場合はエラーをスローする', async ()=>{
            // 実際の実装がエラーをスローしない場合はスキップ
            const invalidData = {
                userId: ''
            };
            const consoleSpy = jest.spyOn(console, 'log');
            await (0, _activitylogger.logActivity)(invalidData);
            // コンソールログが呼ばれたことを確認
            expect(consoleSpy).toHaveBeenCalled();
        });
        it('メタデータが正しく記録される', async ()=>{
            const testMetadata = {
                testKey: 'testValue'
            };
            const dataWithMetadata = {
                ...validActivityData,
                metadata: testMetadata
            };
            const consoleSpy = jest.spyOn(console, 'log');
            await (0, _activitylogger.logActivity)(dataWithMetadata);
            // メタデータを含むログが出力されたことを確認
            expect(consoleSpy).toHaveBeenCalledWith('Activity logged (dummy):', expect.objectContaining({
                metadata: testMetadata
            }));
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95dXN1a2V0c3Vub2RhL0RvY3VtZW50cy9jdXJzb3IvcHB0dHJhbnNsYXRvcmFwcC93b3JrdHJlZXMvZmVhdHVyZS10ZXN0LWNvdmVyYWdlLWltcHJvdmVtZW50L3Rlc3RzL3V0aWxzL2FjdGl2aXR5LWxvZ2dlci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvZ0FjdGl2aXR5IH0gZnJvbSAnQC9saWIvdXRpbHMvYWN0aXZpdHktbG9nZ2VyJztcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL2RiL3ByaXNtYSc7XG5cbi8vIOODouODg+OCr1xuamVzdC5tb2NrKCdAL2xpYi9kYi9wcmlzbWEnLCAoKSA9PiAoe1xuICBwcmlzbWE6IHtcbiAgICB1c2VyOiB7XG4gICAgICBmaW5kVW5pcXVlOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgIGlkOiAndGVzdC11c2VyLTEyMycsXG4gICAgICB9KSksXG4gICAgfSxcbiAgICBhY3Rpdml0eUxvZzoge1xuICAgICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgfSxcbiAgfSxcbn0pKTtcblxuLy8g5a6f6Zqb44Gu5a6f6KOF44GM44Kz44Oz44K944O844Or44Ot44Kw44KS5Ye65Yqb44GZ44KL44Gg44GR44Gu5aC05ZCI44Gu44OG44K544OIXG5kZXNjcmliZSgnQWN0aXZpdHlMb2dnZXInLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIGplc3Quc3B5T24oY29uc29sZSwgJ2xvZycpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5yZXN0b3JlQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2xvZ0FjdGl2aXR5JywgKCkgPT4ge1xuICAgIGNvbnN0IHVzZXJJZCA9ICd0ZXN0LXVzZXItMTIzJztcbiAgICBjb25zdCB2YWxpZEFjdGl2aXR5RGF0YSA9IHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIGFjdGlvbjogJ2ZpbGVfdXBsb2FkJyBhcyBhbnksXG4gICAgICBtZXRhZGF0YTogeyBmaWxlSWQ6ICd0ZXN0LWZpbGUtNDU2JywgZmlsZU5hbWU6ICd0ZXN0LnBwdHgnIH0sXG4gICAgfTtcblxuICAgIGl0KCfmnInlirnjgarjg4fjg7zjgr/jgafjgqLjgq/jg4bjgqPjg5Pjg4bjgqPjgpLoqJjpjLLjgZnjgosnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb25zb2xlU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnbG9nJyk7XG5cbiAgICAgIGF3YWl0IGxvZ0FjdGl2aXR5KHZhbGlkQWN0aXZpdHlEYXRhKTtcblxuICAgICAgLy8g44Kz44Oz44K944O844Or44Ot44Kw44GM5ZG844Gw44KM44Gf44GT44Go44KS56K66KqNXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnQWN0aXZpdHkgbG9nZ2VkIChkdW1teSk6JyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBhY3Rpb246IHZhbGlkQWN0aXZpdHlEYXRhLmFjdGlvbixcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ+W/hemgiOODkeODqeODoeODvOOCv+OBjOS4jei2s+OBl+OBpuOBhOOCi+WgtOWQiOOBr+OCqOODqeODvOOCkuOCueODreODvOOBmeOCiycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIOWun+mam+OBruWun+ijheOBjOOCqOODqeODvOOCkuOCueODreODvOOBl+OBquOBhOWgtOWQiOOBr+OCueOCreODg+ODl1xuICAgICAgY29uc3QgaW52YWxpZERhdGEgPSB7IHVzZXJJZDogJycgfSBhcyBhbnk7XG4gICAgICBjb25zdCBjb25zb2xlU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnbG9nJyk7XG5cbiAgICAgIGF3YWl0IGxvZ0FjdGl2aXR5KGludmFsaWREYXRhKTtcblxuICAgICAgLy8g44Kz44Oz44K944O844Or44Ot44Kw44GM5ZG844Gw44KM44Gf44GT44Go44KS56K66KqNXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+ODoeOCv+ODh+ODvOOCv+OBjOato+OBl+OBj+iomOmMsuOBleOCjOOCiycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RNZXRhZGF0YSA9IHsgdGVzdEtleTogJ3Rlc3RWYWx1ZScgfTtcbiAgICAgIGNvbnN0IGRhdGFXaXRoTWV0YWRhdGEgPSB7XG4gICAgICAgIC4uLnZhbGlkQWN0aXZpdHlEYXRhLFxuICAgICAgICBtZXRhZGF0YTogdGVzdE1ldGFkYXRhLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdsb2cnKTtcblxuICAgICAgYXdhaXQgbG9nQWN0aXZpdHkoZGF0YVdpdGhNZXRhZGF0YSk7XG5cbiAgICAgIC8vIOODoeOCv+ODh+ODvOOCv+OCkuWQq+OCgOODreOCsOOBjOWHuuWKm+OBleOCjOOBn+OBk+OBqOOCkueiuuiqjVxuICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnQWN0aXZpdHkgbG9nZ2VkIChkdW1teSk6JyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIG1ldGFkYXRhOiB0ZXN0TWV0YWRhdGEsXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInByaXNtYSIsInVzZXIiLCJmaW5kVW5pcXVlIiwiZm4iLCJpZCIsImFjdGl2aXR5TG9nIiwiY3JlYXRlIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsInNweU9uIiwiY29uc29sZSIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsImFmdGVyRWFjaCIsInJlc3RvcmVBbGxNb2NrcyIsInVzZXJJZCIsInZhbGlkQWN0aXZpdHlEYXRhIiwiYWN0aW9uIiwibWV0YWRhdGEiLCJmaWxlSWQiLCJmaWxlTmFtZSIsIml0IiwiY29uc29sZVNweSIsImxvZ0FjdGl2aXR5IiwiZXhwZWN0IiwidG9IYXZlQmVlbkNhbGxlZCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwib2JqZWN0Q29udGFpbmluZyIsImludmFsaWREYXRhIiwidGVzdE1ldGFkYXRhIiwidGVzdEtleSIsImRhdGFXaXRoTWV0YWRhdGEiXSwibWFwcGluZ3MiOiI7QUFHQSxNQUFNO0FBQ05BLEtBQUtDLElBQUksQ0FBQyxtQkFBbUIsSUFBTyxDQUFBO1FBQ2xDQyxRQUFRO1lBQ05DLE1BQU07Z0JBQ0pDLFlBQVlKLEtBQUtLLEVBQUUsQ0FBQyxJQUFPLENBQUE7d0JBQ3pCQyxJQUFJO29CQUNOLENBQUE7WUFDRjtZQUNBQyxhQUFhO2dCQUNYQyxRQUFRUixLQUFLSyxFQUFFO1lBQ2pCO1FBQ0Y7SUFDRixDQUFBOzs7O2dDQWY0QjtBQWlCNUIsOEJBQThCO0FBQzlCSSxTQUFTLGtCQUFrQjtJQUN6QkMsV0FBVztRQUNUVixLQUFLVyxhQUFhO1FBQ2xCWCxLQUFLWSxLQUFLLENBQUNDLFNBQVMsT0FBT0Msa0JBQWtCLENBQUMsS0FBTztJQUN2RDtJQUVBQyxVQUFVO1FBQ1JmLEtBQUtnQixlQUFlO0lBQ3RCO0lBRUFQLFNBQVMsZUFBZTtRQUN0QixNQUFNUSxTQUFTO1FBQ2YsTUFBTUMsb0JBQW9CO1lBQ3hCRDtZQUNBRSxRQUFRO1lBQ1JDLFVBQVU7Z0JBQUVDLFFBQVE7Z0JBQWlCQyxVQUFVO1lBQVk7UUFDN0Q7UUFFQUMsR0FBRyx1QkFBdUI7WUFDeEIsTUFBTUMsYUFBYXhCLEtBQUtZLEtBQUssQ0FBQ0MsU0FBUztZQUV2QyxNQUFNWSxJQUFBQSwyQkFBVyxFQUFDUDtZQUVsQixvQkFBb0I7WUFDcEJRLE9BQU9GLFlBQVlHLGdCQUFnQjtZQUNuQ0QsT0FBT0YsWUFBWUksb0JBQW9CLENBQ3JDLDRCQUNBRixPQUFPRyxnQkFBZ0IsQ0FBQztnQkFDdEJaO2dCQUNBRSxRQUFRRCxrQkFBa0JDLE1BQU07WUFDbEM7UUFFSjtRQUVBSSxHQUFHLDhCQUE4QjtZQUMvQiwwQkFBMEI7WUFDMUIsTUFBTU8sY0FBYztnQkFBRWIsUUFBUTtZQUFHO1lBQ2pDLE1BQU1PLGFBQWF4QixLQUFLWSxLQUFLLENBQUNDLFNBQVM7WUFFdkMsTUFBTVksSUFBQUEsMkJBQVcsRUFBQ0s7WUFFbEIsb0JBQW9CO1lBQ3BCSixPQUFPRixZQUFZRyxnQkFBZ0I7UUFDckM7UUFFQUosR0FBRyxrQkFBa0I7WUFDbkIsTUFBTVEsZUFBZTtnQkFBRUMsU0FBUztZQUFZO1lBQzVDLE1BQU1DLG1CQUFtQjtnQkFDdkIsR0FBR2YsaUJBQWlCO2dCQUNwQkUsVUFBVVc7WUFDWjtZQUNBLE1BQU1QLGFBQWF4QixLQUFLWSxLQUFLLENBQUNDLFNBQVM7WUFFdkMsTUFBTVksSUFBQUEsMkJBQVcsRUFBQ1E7WUFFbEIsd0JBQXdCO1lBQ3hCUCxPQUFPRixZQUFZSSxvQkFBb0IsQ0FDckMsNEJBQ0FGLE9BQU9HLGdCQUFnQixDQUFDO2dCQUN0QlQsVUFBVVc7WUFDWjtRQUVKO0lBQ0Y7QUFDRiJ9